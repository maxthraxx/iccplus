var e=Object.defineProperty,t=(t,o,i)=>((t,o,i)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[o]=i)(t,"symbol"!=typeof o?o+"":o,i);function o(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}import{p as i,S as n,a as l,o as a,c as r,b as s,d as c,g as d,w as u,r as g,t as m,e as h,u as p,f as v,h as f,i as b,j as w,k as T,l as I,m as y,s as S,n as C,q as x,v as B,x as A,y as O,z as k,A as M,B as F,C as R,D,E as j,F as P,G as $,H as q,I as V,J as L,K as N,L as W,M as E,N as U,O as z,P as G,Q as H,R as _,T as Y,U as Z,V as J,W as X,X as K,Y as Q,Z as ee,_ as te,$ as oe,a0 as ie,a1 as ne,a2 as le,a3 as ae,a4 as re,a5 as se,a6 as ce,a7 as de,a8 as ue,a9 as ge,aa as me,ab as he,ac as pe,ad as ve,ae as fe,af as be,ag as we,ah as Te,ai as Ie,aj as ye,ak as Se,al as Ce,am as xe,an as Be,ao as Ae,ap as Oe,aq as ke,ar as Me,as as Fe,at as Re,au as De,av as je,aw as Pe,ax as $e,ay as qe,az as Ve,aA as Le,aB as Ne,aC as We,aD as Ee,aE as Ue,aF as ze,aG as Ge,aH as He,aI as _e,aJ as Ye,aK as Ze,aL as Je,aM as Xe,aN as Ke,aO as Qe,aP as et,aQ as tt}from"./chunk-vendors.DVV9MEyN.js";
/*!
 * canvas-size
 * v2.0.0
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2024 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */
function ot(e){const t=e.sizes.shift(),o=Math.max(Math.ceil(t[0]),1),i=Math.max(Math.ceil(t[1]),1),n=[o-1,i-1,1,1],l=performance.now(),a="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;let r,s;a?(r=new OffscreenCanvas(1,1),s=new OffscreenCanvas(o,i)):(r=document.createElement("canvas"),r.width=1,r.height=1,s=document.createElement("canvas"),s.width=o,s.height=i);const c=r.getContext("2d"),d=s.getContext("2d");d&&(d.fillRect.apply(d,n),c.drawImage(s,o-1,i-1,1,1,0,0,1,1));const u=c&&0!==c.getImageData(0,0,1,1).data[3],g=parseInt(performance.now()-l);return[r,s].forEach(e=>{e.height=0,e.width=0}),a?(postMessage({width:o,height:i,testTime:g,isTestPass:u}),!u&&e.sizes.length&&setTimeout(()=>{ot(e)},0)):u?e.onSuccess({width:o,height:i,testTime:g}):(e.onError({width:o,height:i,testTime:g}),e.sizes.length&&setTimeout(()=>{ot(e)},0)),u}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const it={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},nt={max:null,min:1,sizes:[],step:1024,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},lt={};function at(e){const t=e.width===e.height,o=1===e.height,i=1===e.width,n=[];if(e.width&&e.height){const l=e.min||nt.min,a=e.step||nt.step;let r=Math.max(e.width,e.height);for(;r>=l;){const e=t||o?r:1,l=t||i?r:1;n.push([e,l]),r-=a}}else e.sizes.forEach(e=>{const l=t||o?e:1,a=t||i?e:1;n.push([l,a])});return n}function rt(e){const t="undefined"!=typeof window,o=t&&"Promise"in window,i=t&&"HTMLCanvasElement"in window,n=t&&"OffscreenCanvas"in window,l=URL.createObjectURL(new Blob([])).slice(-36),a=performance.now(),{onError:r,onSuccess:s,...c}=e,d=()=>parseInt(performance.now()-a);let u=null;if(!i)return!1;if(e.useWorker&&n){const e="\n            var canvasTest = ".concat(ot.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),t=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(t);u=new Worker(o),URL.revokeObjectURL(o),u.onmessage=function(e){const{width:t,height:o,testTime:i,isTestPass:n}=e.data,a={width:t,height:o,testTime:i,totalTime:d()};n?(lt[l].onSuccess(a),delete lt[l]):lt[l].onError(a)}}return o?new Promise(t=>{const o={...e,onError(o){let{width:i,height:n,testTime:l}=o;const a={width:i,height:n,testTime:l,totalTime:d()};let s;if(0===e.sizes.length)s=!0;else{const[[t,o]]=e.sizes.slice(-1);s=i===t&&n===o}r(a),s&&t({...a,success:!1})},onSuccess(e){let{width:o,height:i,testTime:n}=e;const l={width:o,height:i,testTime:n,totalTime:d()};s(l),t({...l,success:!0})}};if(u){const{onError:e,onSuccess:t}=o;lt[l]={onError:e,onSuccess:t},u.postMessage(c)}else ot(o)}):u?(lt[l]={onError:r,onSuccess:s},void u.postMessage(c)):ot(e)}const st={maxArea(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=at({width:e.max,height:e.max,min:e.min,step:e.step,sizes:[...it.area]});return rt({...nt,...e,sizes:t})},maxHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=at({width:1,height:e.max,min:e.min,step:e.step,sizes:[...it.height]});return rt({...nt,...e,sizes:t})},maxWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=at({width:e.max,height:1,min:e.min,step:e.step,sizes:[...it.width]});return rt({...nt,...e,sizes:t})},test(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={...nt,...e};return t.sizes=[...t.sizes],t.width&&t.height&&(t.sizes=[[t.width,t.height]]),rt(t)}},ct="2.2.2",dt={selFilterBlurIsOn:!1,selFilterBlur:0,selFilterBrightIsOn:!1,selFilterBright:100,selFilterContIsOn:!1,selFilterCont:100,selFilterGrayIsOn:!1,selFilterGray:0,selFilterHueIsOn:!1,selFilterHue:0,selFilterInvertIsOn:!1,selFilterInvert:0,selFilterOpacIsOn:!1,selFilterOpac:100,selFilterSaturIsOn:!1,selFilterSatur:1,selFilterSepiaIsOn:!1,selFilterSepia:0,selBgColorIsOn:!0,selOverlayOnImage:!1,selFilterBgColor:"#70FF7EFF",selBorderColorIsOn:!1,selFilterBorderColor:"#000000FF",selCTitleColorIsOn:!1,selFilterCTitleColor:"#000000FF",selCTextColorIsOn:!1,selFilterCTextColor:"#000000FF",selATitleColorIsOn:!1,selFilterATitleColor:"#000000FF",selATextColorIsOn:!1,selFilterATextColor:"#000000FF",selScoreTextColorIsOn:!1,selFilterSTextColor:"#000000FF",reqFilterBlurIsOn:!1,reqFilterBlur:0,reqFilterBrightIsOn:!1,reqFilterBright:100,reqFilterContIsOn:!1,reqFilterCont:100,reqFilterGrayIsOn:!1,reqFilterGray:0,reqFilterHueIsOn:!1,reqFilterHue:0,reqFilterInvertIsOn:!1,reqFilterInvert:0,reqFilterOpacIsOn:!0,reqFilterOpac:50,reqFilterSaturIsOn:!1,reqFilterSatur:1,reqFilterSepiaIsOn:!1,reqFilterSepia:0,reqBgColorIsOn:!1,reqOverlayOnImage:!1,reqFilterBgColor:"#FFFFFFFF",reqBorderColorIsOn:!1,reqFilterBorderColor:"#000000FF",reqCTitleColorIsOn:!1,reqFilterCTitleColor:"#000000FF",reqCTextColorIsOn:!1,reqFilterCTextColor:"#000000FF",reqATitleColorIsOn:!1,reqFilterATitleColor:"#000000FF",reqATextColorIsOn:!1,reqFilterATextColor:"#000000FF",reqScoreTextColorIsOn:!1,reqFilterSTextColor:"#000000FF",reqFilterVisibleIsOn:!1,unselFilterBlurIsOn:!1,unselFilterBlur:0,unselFilterBrightIsOn:!1,unselFilterBright:100,unselFilterContIsOn:!1,unselFilterCont:100,unselFilterGrayIsOn:!1,unselFilterGray:0,unselFilterHueIsOn:!1,unselFilterHue:0,unselFilterInvertIsOn:!1,unselFilterInvert:0,unselFilterOpacIsOn:!1,unselFilterOpac:100,unselFilterSaturIsOn:!1,unselFilterSatur:1,unselFilterSepiaIsOn:!1,unselFilterSepia:0},ut={customRowTitle:!1,rowTitle:"Times New Roman",customRowText:!1,rowText:"Times New Roman",customObjectTitle:!1,objectTitle:"Times New Roman",customObjectText:!1,objectText:"Times New Roman",customAddonTitle:!1,addonTitle:"Times New Roman",customAddonText:!1,addonText:"Times New Roman",customScoreText:!1,scoreText:"Times New Roman",rowTitleTextSize:200,rowTextTextSize:100,objectTitleTextSize:200,objectTextTextSize:100,addonTitleTextSize:200,addonTextTextSize:100,scoreTextSize:75,rowTitleColor:"#000000",rowTextColor:"#000000",objectTitleColor:"#000000",objectTextColor:"#000000",addonTitleColor:"#000000",addonTextColor:"#000000",scoreTextColor:"#000000",rowTitleAlign:"center",rowTextAlign:"center",objectTitleAlign:"center",objectTextAlign:"center",addonTitleAlign:"center",addonTextAlign:"center",scoreTextAlign:"center"},gt={objectImgBorderStyle:"solid",objectImgBorderWidth:2,objectImageWidth:100,objectImageMarginTop:0,objectImageMarginBottom:0,objectImgBorderRadiusTopLeft:0,objectImgBorderRadiusTopRight:0,objectImgBorderRadiusBottomRight:0,objectImgBorderRadiusBottomLeft:0,objectImgBorderRadiusIsPixels:!0,objectImgBorderIsOn:!1,objectImgOverflowIsOn:!1,objectImgBorderColor:"red",objectImgObjectFillStyle:"",objectImgObjectFillIsOn:!1,objectImageBoxWidth:50},mt={rowImgBorderStyle:"solid",rowImgBorderWidth:2,rowImageWidth:100,rowImageMarginTop:0,rowImageMarginBottom:0,rowImgBorderRadiusTopLeft:0,rowImgBorderRadiusTopRight:0,rowImgBorderRadiusBottomRight:0,rowImgBorderRadiusBottomLeft:0,rowImgBorderRadiusIsPixels:!0,rowImgBorderIsOn:!1,rowImgOverflowIsOn:!1,rowImgBorderColor:"red",rowImageBoxWidth:50},ht={useAddonImage:!1,addonImgBorderStyle:"solid",addonImgBorderWidth:2,addonImageWidth:100,addonImageMarginTop:0,addonImageMarginBottom:0,addonImgBorderRadiusTopLeft:0,addonImgBorderRadiusTopRight:0,addonImgBorderRadiusBottomRight:0,addonImgBorderRadiusBottomLeft:0,addonImgBorderRadiusIsPixels:!0,addonImgBorderIsOn:!1,addonImgOverflowIsOn:!1,addonImgBorderColor:"red",addonImgObjectFillStyle:"",addonImgObjectFillIsOn:!1,addonImageBoxWidth:50},pt={bgColorIsOn:!1,backgroundColor:"#FFFFFFFF",rowBgColorIsOn:!1,rowBgColor:"#FFFFFFFF",objectBgColorIsOn:!1,objectBgColor:"#FFFFFFFF",isBackgroundRepeat:!1,isBackgroundFitIn:!1,backgroundImage:"",isRowBackgroundRepeat:!1,isRowBackgroundFitIn:!1,rowBackgroundImage:"",isObjectBackgroundRepeat:!1,isObjectBackgroundFitIn:!1,objectBackgroundImage:""},vt={objectHeight:!0,objectDesignIsAdvanced:!1,objectMargin:10,objectTextPadding:10,objectBorderStyle:"solid",objectBorderWidth:2,objectBorderIsOn:!1,objectDropShadowH:0,objectDropShadowV:0,objectDropShadowBlur:0,objectDropShadowSpread:0,objectDropShadowIsOn:!1,objectUseBoxShadowIsOn:!1,objectBorderRadiusTopLeft:0,objectBorderRadiusTopRight:0,objectBorderRadiusBottomRight:0,objectBorderRadiusBottomLeft:0,objectBorderRadiusIsPixels:!0,objectOverflowIsOn:!0,objectDropShadowColor:"grey",objectGradientIsOn:!1,objectGradient:"",objectGradientOnSelect:"",objectGradientOnReq:"",objectBorderColor:"red",objectBorderImage:"",objectBorderImageRepeat:"stretch",objectBorderImageWidth:5,objectBorderImageSliceTop:5,objectBorderImageSliceBottom:5,objectBorderImageSliceLeft:5,objectBorderImageSliceRight:5,removeSpaceAddonIsOn:!1,titlePaddingIsOn:!1},ft={rowDesignIsAdvanced:!1,rowMargin:10,rowBodyMarginSides:1,rowBodyMarginTop:25,rowBodyMarginBottom:25,rowTextPaddingY:5,rowTextPaddingX:10,rowOverflowIsOn:!0,rowDropShadowH:0,rowDropShadowV:0,rowDropShadowBlur:0,rowDropShadowSpread:0,rowDropShadowColor:"grey",rowButtonXPadding:0,rowButtonYPadding:0,rowDropShadowIsOn:!1,rowUseBoxShadowIsOn:!1,rowBorderRadiusTopLeft:0,rowBorderRadiusTopRight:0,rowBorderRadiusBottomRight:0,rowBorderRadiusBottomLeft:0,rowBorderRadiusIsPixels:!0,rowBorderStyle:"solid",rowBorderWidth:2,rowBorderIsOn:!1,rowBorderColor:"red",rowGradientIsOn:!1,rowGradient:"",rowBorderImage:"",rowBorderImageRepeat:"stretch",rowBorderImageWidth:5,rowBorderImageSliceTop:5,rowBorderImageSliceBottom:5,rowBorderImageSliceLeft:5,rowBorderImageSliceRight:5},bt={useAddonDesign:!1,addonDesignIsAdvanced:!1,addonMargin:10,addonTextPadding:10,addonBorderStyle:"solid",addonBorderWidth:2,addonBorderIsOn:!1,addonDropShadowH:0,addonDropShadowV:0,addonDropShadowBlur:0,addonDropShadowSpread:0,addonDropShadowIsOn:!1,addonUseBoxShadowIsOn:!1,addonBorderRadiusTopLeft:0,addonBorderRadiusTopRight:0,addonBorderRadiusBottomRight:0,addonBorderRadiusBottomLeft:0,addonBorderRadiusIsPixels:!0,addonOverflowIsOn:!0,addonDropShadowColor:"grey",addonGradientIsOn:!1,addonGradient:"",addonGradientOnSelect:"",addonGradientOnReq:"",addonBorderColor:"red",addonBorderImage:"",addonBorderImageRepeat:"stretch",addonBorderImageWidth:5,addonBorderImageSliceTop:5,addonBorderImageSliceBottom:5,addonBorderImageSliceLeft:5,addonBorderImageSliceRight:5,useAddonBackgroundImage:!1,addonBackgroundImage:"",isAddonBackgroundFitIn:!1,isAddonBackgroundRepeat:!1,addonBgColorIsOn:!1,addonBgColor:"#FFFFFFFF",addonTitlePaddingIsOn:!1},wt={customMultiTextFont:!1,multiChoiceCounterPosition:0,multiChoiceCounterSize:170,multiChoiceTextFont:"Times New Roman",multiChoiceTextSize:100},Tt={barTextPadding:17,barTextMargin:0,customBarTextFont:!1,barTextFont:"Times New Roman",barPadding:0,barMargin:0,barTextSize:15,barTextColor:"#000000",barPointPos:"#FF0000FF",barPointNeg:"#FF0000FF",barIconColor:"#0000008A",barBackgroundColor:"#FFFFFFFF"},It={useBackpackDesign:!1,backpackBgColor:"#FFFFFF",isBackpackBgRepeat:!1,isBackpackBgFitIn:!1,backpackBgImage:"",backPackWidth:1200},app=i(

/*! Delete and replace this part with your project if you're pasting it in, leave it here if you have placed your project.json file under index.html. */
{version:ct,isEditModeOnAll:!0,isStyleOpen:!1,isPointsOpen:!1,isChoicesOpen:!1,isDesignOpen:!1,isFadingOut:!1,isPointerCursor:!1,importedChoicesIsOpen:!0,curBgmTime:0,curBgmLength:0,curVolume:100,isSeeking:!1,isMute:!1,lastFadeTime:0,showMusicPlayer:!1,fadeTransitionColor:"#000000FF",fadeTransitionTime:.25,fadeTransitionIsOn:!1,hideBackpackBtn:0,btnBackpackIsOn:0,showAllAddons:0,tmpRow:[],tmpChoice:[],tmpRequired:[],tmpScore:[],tmpAddon:[],tmpGroup:[],rowIdLength:4,objectIdLength:4,words:[],wordChangeComplete:!1,groups:[],rowDesignGroups:[],objectDesignGroups:[],objectsPerRow:"col-6",globalRequirements:[],googleFonts:[],customFonts:[],compressImageAuto:!1,hideScoresUpdated:!1,hideChoiceDT:!1,hideImages:!1,preloadImages:!1,preloadExternalImages:!1,useVW:!1,addPrefix:!0,activated:[],rows:[],pointTypes:[],variables:[],mdObjects:[],printThis:!1,autoSaveIsOn:!1,autoSaveInterval:10,buildAutoSaveIsOn:!1,buildAutoSaveInterval:10,tooltipDelay:1e3,checkDeleteRow:!0,checkDeleteObject:!1,defaultRowTitle:"Row",defaultRowText:"This is a row, and inside of it, you can place choices. On both rows and choices Requirements can be placed, which will block a row from being viewed, or make the player unable to select a choice, depending on either Point-types or the Ids of other choices. Point-types can be made in Features then Manage Points. Hovering over buttons will explain what they do. The Design of the project can be changed in 'Modify Design' at the side navigation bar, and private styling for each row can be turned on in the rows Settings. Default text like this can be turned off in Features -> Manage Defaults.",defaultChoiceTitle:"Choice",defaultChoiceText:"This is a Choice, and inside of it, you can place images and text. Scores can be added to it, and have Point-types attached. Addons can be added underneath the image and text. In the Functions at the bottom of the choice, there is an array of different things that can be done. Default text like this can be turned off in Features then Manage Defaults.",defaultBeforePoint:"Cost:",defaultAfterPoint:"points",defaultBeforeReq:"Required:",defaultAfterReq:"choice",defaultAddonTitle:"Addon",defaultAddonText:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.",enableShortcut:!0,orderOrReqText:"0",defaultOrReq:"of",orderSelReqText:"0",defaultSelReq:"choice from",backpack:[{index:0,id:"default_backpack_row",isBackpack:!0,title:"Result",debugTitle:"",titleText:"",objectWidth:"col-md-3",image:"",template:1,isButtonRow:!1,buttonType:!0,buttonId:"",buttonText:"Click",buttonRandom:!1,buttonRandomNumber:1,isResultRow:!0,resultGroupId:"",isInfoRow:!0,defaultAspectWidth:1,defaultAspectHeight:1,allowedChoices:0,currentChoices:0,requireds:[],isEditModeOn:!1,isRequirementOpen:!1,objects:[],rowDesignGroups:[]}],styling:{...dt,...ut,...gt,...mt,...ht,...pt,...vt,...ft,...bt,...wt,...Tt,...It}}
/*! End */

),yt={version:ct,isEditModeOnAll:!0,isStyleOpen:!1,isPointsOpen:!1,isChoicesOpen:!1,isDesignOpen:!1,isFadingOut:!1,isPointerCursor:!1,importedChoicesIsOpen:!0,curBgmTime:0,curBgmLength:0,curVolume:100,isSeeking:!1,isMute:!1,lastFadeTime:0,showMusicPlayer:!1,fadeTransitionColor:"#000000FF",fadeTransitionTime:.25,fadeTransitionIsOn:!1,hideBackpackBtn:0,btnBackpackIsOn:0,showAllAddons:0,tmpRow:[],tmpChoice:[],tmpRequired:[],tmpScore:[],tmpAddon:[],tmpGroup:[],rowIdLength:4,objectIdLength:4,words:[],wordChangeComplete:!1,groups:[],rowDesignGroups:[],objectDesignGroups:[],objectsPerRow:"col-6",globalRequirements:[],googleFonts:[],customFonts:[],compressImageAuto:!1,hideScoresUpdated:!1,hideChoiceDT:!1,hideImages:!1,preloadImages:!1,preloadExternalImages:!1,useVW:!1,addPrefix:!0,activated:[],rows:[],pointTypes:[],variables:[],mdObjects:[],printThis:!1,autoSaveIsOn:!1,autoSaveInterval:10,buildAutoSaveIsOn:!1,buildAutoSaveInterval:10,tooltipDelay:1e3,checkDeleteRow:!0,checkDeleteObject:!1,defaultRowTitle:"Row",defaultRowText:"This is a row, and inside of it, you can place choices. On both rows and choices Requirements can be placed, which will block a row from being viewed, or make the player unable to select a choice, depending on either Point-types or the Ids of other choices. Point-types can be made in Features then Manage Points. Hovering over buttons will explain what they do. The Design of the project can be changed in 'Modify Design' at the side navigation bar, and private styling for each row can be turned on in the rows Settings. Default text like this can be turned off in Features -> Manage Defaults.",defaultChoiceTitle:"Choice",defaultChoiceText:"This is a Choice, and inside of it, you can place images and text. Scores can be added to it, and have Point-types attached. Addons can be added underneath the image and text. In the Functions at the bottom of the choice, there is an array of different things that can be done. Default text like this can be turned off in Features then Manage Defaults.",defaultBeforePoint:"Cost:",defaultAfterPoint:"points",defaultBeforeReq:"Required:",defaultAfterReq:"choice",defaultAddonTitle:"Addon",defaultAddonText:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.",enableShortcut:!0,orderOrReqText:"0",defaultOrReq:"of",orderSelReqText:"0",defaultSelReq:"choice from",backpack:[{index:0,id:"default_backpack_row",isBackpack:!0,title:"Result",debugTitle:"",titleText:"",objectWidth:"col-md-3",image:"",template:1,isButtonRow:!1,buttonType:!0,buttonId:"",buttonText:"Click",buttonRandom:!1,buttonRandomNumber:1,isResultRow:!0,resultGroupId:"",isInfoRow:!0,defaultAspectWidth:1,defaultAspectHeight:1,allowedChoices:0,currentChoices:0,requireds:[],isEditModeOn:!1,isRequirementOpen:!1,objects:[],rowDesignGroups:[]}],styling:{...dt,...ut,...gt,...mt,...ht,...pt,...vt,...ft,...bt,...wt,...Tt,...It}},St=i(new n),Ct=i(new n),xt=i(new n),Bt=i(new n),At=i(new n),Ot=i(new n),kt=i(new n),Mt=i(new n),Ft=i(new n),Rt=i(new n),Dt=i(new n),jt=i(new l),Pt=i([]),$t=i({value:"light"}),qt={ALLOWED_TAGS:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr","font","iframe","img"],ADD_ATTR:["href","target","style"]},Vt=u(null),Lt=i({isBgmInit:!1,bgmIsPlaying:!1,bgmPlayInterval:0,bgmTitleInterval:0,bgmFadeInterval:0,bgmFadeTimer:0,bgmTitle:"No Audio Title",curBgmTime:0,curBgmLength:0,isSeeking:!1,lastFadeTime:0,isFadingOut:!1,bgmObjectId:""}),Nt=i({currentDialog:"none"}),Wt=i({labelText:"",timeoutMs:4e3,isOpen:!1}),Et=i({allowDeselect:!1,isSingleFile:!1}),Ut=i({stored:!1,name:"Auto Save",time:"",app:""}),zt=i(Array.from({length:99},(e,t)=>({stored:!1,name:"Slot ".concat(t+1),time:"",app:""}))),Gt=i(Array.from({length:99},(e,t)=>({stored:!1,name:"Slot ".concat(t+1),time:"",app:""})));i({backgroundColor:"",backgroundImage:"",barBgColor:""});const Ht=new Set,_t={value:!1},Yt=g(window.innerWidth,e=>{const t=()=>e(window.innerWidth);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)});let Zt=null;function Jt(){return new Promise((e,t)=>{const o=indexedDB.open("cyoaPlusDB");o.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("cyoaStore")||t.createObjectStore("cyoaStore"),t.objectStoreNames.contains("buildStore")||t.createObjectStore("buildStore")},o.onsuccess=t=>{const o=t.target.result;e(o)},o.onerror=t})}function Xt(){return new Promise((e,t)=>{if(Zt)return e(Zt);const o=indexedDB.open("cyoaDB");let i=!1,n=[],l=[],a=[];o.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("buildStore")||t.createObjectStore("buildStore",{keyPath:"title"}),i=!0},o.onsuccess=o=>{const r=o.target.result;if(1===r.version)if(i)Jt().then(t=>{Zt=t,e(Zt)}).catch(t).finally(()=>{r.close()});else if(r.objectStoreNames.contains("buildStore")){const o=r.transaction(["buildStore"],"readonly").objectStore("buildStore").getAll();o.onsuccess=()=>{const i=o.result;for(let e=0;e<i.length;e++){const t=o.result[e];Gt[e].stored=!0,Gt[e].name=t.title,Gt[e].time="Unknown",Gt[e].app=Array.isArray(t.value)?t.value.join(","):t.value}Jt().then(t=>{Zt=t,e(Zt)}).catch(t).finally(()=>{r.close()})},o.onerror=o=>{console.error(o),Jt().then(t=>{Zt=t,e(Zt)}).catch(t).finally(()=>{r.close()})}}else Jt().then(t=>{Zt=t,e(Zt)}).catch(t).finally(()=>{r.close()});else{const o=[new Promise((e,t)=>{if(r.objectStoreNames.contains("cyoaStore")){const o=r.transaction("cyoaStore","readonly").objectStore("cyoaStore").openCursor();o.onsuccess=t=>{const o=t.target.result;o?(n.push({key:o.key,value:o.value}),o.continue()):e()},o.onerror=t}else e()}),new Promise((e,t)=>{if(r.objectStoreNames.contains("buildStore")){const o=r.transaction("buildStore","readonly").objectStore("buildStore").openCursor();o.onsuccess=t=>{const o=t.target.result;o?(l.push({key:o.key,value:o.value}),o.continue()):e()},o.onerror=t}else e()})];Promise.all(o).then(()=>(r.close(),new Promise((e,t)=>{const o=indexedDB.deleteDatabase("cyoaDB");o.onsuccess=()=>{const o=indexedDB.open("cyoaDB",1);o.onupgradeneeded=e=>{e.target.result.createObjectStore("buildStore",{keyPath:"title"});const t=e.target.transaction;if(t){const e=t.objectStore("buildStore");let o=0;for(let t=0;t<l.length;t++){const i=l[t];void 0!==i.value.title?(e.put(i.value),Gt[o].stored=!0,Gt[o].name=i.title,Gt[o].time="Unknown",Gt[o].app=Array.isArray(i.value)?i.value.join(","):i.value,o+=1):a.push(i)}}},o.onsuccess=t=>{t.target.result.close(),e()},o.onerror=e=>{console.error(e,"L872"),t(e)}},o.onerror=e=>{console.error(e,"L877"),t(e)}}))).catch(e=>{console.error(e),r.close()}).finally(()=>{const o=indexedDB.open("cyoaPlusDB");o.onupgradeneeded=e=>{const t=e.target.result;!t.objectStoreNames.contains("cyoaStore")&&n.length>0&&t.createObjectStore("cyoaStore"),t.objectStoreNames.contains("buildStore")||t.createObjectStore("buildStore");const o=e.target.transaction;if(o){if(n.length>0){const e=o.objectStore("cyoaStore");for(let t=0;t<n.length;t++){const o=n[t];e.put(o.value,o.key)}}if(a.length>0){const e=o.objectStore("buildStore");for(let t=0;t<a.length;t++){const o=a[t];e.put(o.value,o.key)}}}},o.onsuccess=t=>{const o=t.target.result;Zt=o,e(Zt)},o.onerror=e=>{t(e)}})}},o.onerror=e=>{t(e)}})}let Kt=null;function Qt(e,t){return new Promise((o,i)=>{const n=setTimeout(()=>o(),e);t&&t.addEventListener("abort",()=>{clearTimeout(n),i(new DOMException("Aborted","AbortError"))})})}async function eo(){const e=new AbortController;Kt=e;const t="".concat(location.pathname.replace(/\/index\.html$/,"/"),"autoSave");for(;app.buildAutoSaveIsOn;){try{await Qt(1e3*app.buildAutoSaveInterval*60,e.signal)}catch(o){break}if(!app.buildAutoSaveIsOn)break;const i=(await Xt()).transaction("buildStore","readwrite").objectStore("buildStore"),n=navigator.language,l=new Date,a=new Intl.DateTimeFormat(n,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(l),r={stored:!0,name:"Auto Save",time:a,app:to()};try{await new Promise((e,o)=>{const n=i.put(r,t);n.onsuccess=()=>e(),n.onerror=()=>o(n.error)}),Ut.stored=!0,Ut.time=a,Ut.app=r.app,Wt.labelText="Auto-save completed successfully.",Wt.isOpen=!0}catch(o){console.error(o)}}}function to(){let e=[];return Array.from(St.entries()).forEach(([t,o])=>{let i=At.get(t);if(void 0!==i){const n=i.choice;let l=t;0===o.multiple?(n.isActivateRandom&&n.activatedRandom&&(l+="/RND#".concat(n.activatedRandom.join("/AND#").replace(/\/ON#/g,"/RON#"))),n.textfieldIsOn&&n.customTextfieldIsOn&&void 0!==n.wordChangeSelect&&(l+="/WORD#".concat(n.wordChangeSelect.replace(/,/g,"/CHAR#"))),n.isImageUpload&&n.image!==n.defaultImage&&(l+="/IMG#".concat(n.image.replace(/,/g,"/CHAR#"))),e.push(l)):(l+="/ON#".concat(o.multiple),n.isActivateRandom&&n.activatedRandomMul&&(l+="/RND#".concat(n.activatedRandomMul.flat(2).join("/AND#").replace(/\/ON#/g,"/RON#"))),e.push(l))}}),e.join(",")}function oo(){const e=new Date,t=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),i=String(e.getDate()).padStart(2,"0"),n=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0"),a=String(e.getSeconds()).padStart(2,"0");return"".concat(t,"-").concat(o,"-").concat(i,"_").concat(n,"-").concat(l,"-").concat(a)}function io(e){if(e.customTextIsOn)return void 0!==e.customText?e.customText:"";switch(e.type){case"id":{let t=e.reqId.split("/ON#"),o=At.get(t[0]);if(void 0!==o){let i=o.choice;return"".concat(e.beforeText," ").concat(t.length>1?"".concat(t[1]," "):""," ").concat(i.title," ").concat(e.afterText)}break}case"points":{let t=xt.get(e.reqId);if(void 0!==t)return"".concat(e.beforeText," ").concat(e.reqPoints," ").concat(t.name," ").concat(e.afterText);break}case"or":{let t=[];for(let o=0;o<e.orRequired.length;o++){let i=e.orRequired[o].req;if(void 0!==i){let e=i.split("/ON#"),o=At.get(e[0]),n="";if(void 0!==o){let i=o.choice;n=e.length>1?"".concat(e[1]," "):"",t.push("".concat(n).concat(i.title))}}}return"1"===app.orderOrReqText?"".concat(e.beforeText," ").concat(t.join(", ")," ").concat(void 0!==e.orNum?"".concat(app.defaultOrReq," ").concat(e.orNum):"".concat(app.defaultOrReq," 1")," ").concat(e.afterText):"".concat(e.beforeText," ").concat(void 0!==e.orNum?"".concat(e.orNum," ").concat(app.defaultOrReq):"1 ".concat(app.defaultOrReq)," ").concat(t.join(", ")," ").concat(e.afterText)}case"selFromGroups":if(void 0!==e.selGroups){let t=[];for(let o=0;o<e.selGroups.length;o++){let i=e.selGroups[o],n=Ot.get(i);void 0!==n&&t.push(n.name)}return"1"===app.orderSelReqText?"".concat(e.beforeText," ").concat(t.join(", ")," ").concat(app.defaultOrReq," ").concat(e.selNum," ").concat(e.afterText):"".concat(e.beforeText," ").concat(e.selNum," ").concat(app.defaultOrReq," ").concat(t.join(", ")," ").concat(e.afterText)}case"selFromRows":if(void 0!==e.selRows){let t=[];for(let o=0;o<e.selRows.length;o++){let i=e.selRows[o],n=Bt.get(i);void 0!==n&&t.push(n.title)}return"1"===app.orderSelReqText?"".concat(e.beforeText," ").concat(t.join(", ")," ").concat(app.defaultOrReq," ").concat(e.selNum," ").concat(e.afterText):"".concat(e.beforeText," ").concat(e.selNum," ").concat(app.defaultOrReq," ").concat(t.join(", ")," ").concat(e.afterText)}case"selFromWhole":return"1"===app.orderSelReqText?"".concat(e.beforeText," ").concat(app.defaultOrReq," ").concat(e.selNum," ").concat(e.afterText):"".concat(e.beforeText," ").concat(e.selNum," ").concat(app.defaultOrReq," ").concat(e.afterText)}return"".concat(e.beforeText," ").concat(e.afterText)}function no(e){return Bt.has(e)||At.has(e)||Mt.has(e)||xt.has(e)||Rt.has(e)||Dt.has(e)||Ot.has(e)||Ft.has(e)}function lo(e,t){let o=app.addPrefix?"row-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return no(o)?e>2?lo(0,++t):lo(++e,t):o}function ao(e,t){let o=app.addPrefix?"word-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return no(o)?e>2?ao(0,++t):ao(++e,t):o}function ro(e,t){let o=app.addPrefix?"choice-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return no(o)?e>2?ro(0,++t):ro(++e,t):o}function so(e,t,o){let i=app.addPrefix?"design-":"",n="abcdefghijklmnopqrstuvwxyz0123456789";for(var l=0;l<t;l++)i+=n.charAt(Math.floor(36*Math.random()));return no(i)?e>2?so(0,++t):so(++e,t):i}function co(e,t){let o=app.addPrefix?"group-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return no(o)?e>2?co(0,++t):co(++e,t):o}function uo(e,t){let o=app.addPrefix?"point-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return no(o)?e>2?uo(0,++t):uo(++e,t):o}function go(e,t){let o=app.addPrefix?"variable-":"",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return no(o)?e>2?go(0,++t):go(++e,t):o}function mo(e,t){let o="s-",i="abcdefghijklmnopqrstuvwxyz0123456789";for(var n=0;n<t;n++)o+=i.charAt(Math.floor(36*Math.random()));return jt.has(o)?e>2?mo(0,++t):mo(++e,t):o}let ho,po=[];function vo(){return function(){if(po.length!==app.words.length)return!0;for(let e=0;e<po.length;e++){if(po[e].id!==app.words[e].id)return!0;if(po[e].replaceText!==app.words[e].replaceText)return!0}return!1}()&&(po=JSON.parse(JSON.stringify(app.words)),ho=new RegExp(app.words.map(e=>e.id).sort((e,t)=>t.length-e.length).map(e=>e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")).join("|"),"g")),ho}function fo(e){let t=e;return app.words&&(t=t.replace(vo(),e=>{const t=xt.get(e);if(void 0!==t){return(t.startingSum%1==0?t.startingSum:parseFloat(t.startingSum.toFixed(void 0!==t.decimalPlaces?t.decimalPlaces:2))).toString()}{const t=At.get(e);if(void 0!==t){const e=t.choice;if(e.isSelectableMultiple&&e.isMultipleUseVariable)return e.multipleUseVariable.toString()}else{const t=Mt.get(e);if(void 0!==t)return t.replaceText}}return e})),t}function bo(e,t,o){if(void 0!==o){if(void 0!==o.styling&&o.isPrivateStyling&&o[e])return o.styling;if(void 0!==app.objectDesignGroups&&o.objectDesignGroups)for(let t=0;t<o.objectDesignGroups.length;t++){let i=Dt.get(o.objectDesignGroups[t]);if(void 0!==i&&i[e]){let e=i.activatedId,t=kt.get(e);if(""===e||To(i.activatedId))return i.styling;if(void 0!==app.globalRequirements&&void 0!==t&&yo(t.requireds))return i.styling}}}if(void 0!==t){if(void 0!==t.styling&&t.isPrivateStyling&&t[e])return t.styling;if(void 0!==app.rowDesignGroups&&t.rowDesignGroups)for(let o=0;o<t.rowDesignGroups.length;o++){let i=Rt.get(t.rowDesignGroups[o]);if(void 0!==i&&i[e]){let e=i.activatedId,t=kt.get(e);if(""===e||To(i.activatedId))return i.styling;if(void 0!==app.globalRequirements&&void 0!==t&&yo(t.requireds))return i.styling}}}return app.styling}function wo(e,t){if(t.has(e)){return wo("".concat(e,"_dup"),t)}return e}function To(e,t=St){var o;const[i,n="0"]=e.split("/ON#"),l=parseInt(n);if(l>0){return((null==(o=t.get(i))?void 0:o.multiple)||0)>=l}return t.has(i)}function Io(e,t=St){if(e.required)switch(e.type){case"id":return To(e.reqId,t);case"points":const o=xt.get(e.reqId);if(void 0!==o){if(void 0===e.operator)return o.startingSum>e.reqPoints;switch(e.operator){case"1":return o.startingSum>e.reqPoints;case"2":return o.startingSum>=e.reqPoints;case"3":return o.startingSum==e.reqPoints;case"4":return o.startingSum<=e.reqPoints;case"5":return o.startingSum<e.reqPoints}}return!1;case"or":let i=void 0===e.orNum?1:e.orNum,n=0;for(let g=0;g<e.orRequired.length;g++){let o=e.orRequired[g].req;void 0!==o&&To(o,t)&&n++}return n>=i;case"pointCompare":const l=xt.get(e.reqId),a=xt.get(e.reqId1);if(void 0!==l&&void 0!==a){let t=a.startingSum;if(e.more)for(let o=0;o<e.more.length;o++){let i=0,n=e.more[o].id,l=e.more[o].points;if(void 0!==n){let e=xt.get(n);void 0!==e&&(i=e.startingSum)}else void 0!==l&&(i=l);switch(e.more[o].operator){case"1":t+=i;break;case"2":t-=i;break;case"3":t*=i;break;case"4":t/=i;break;case"5":t%=i}}switch(e.operator){case"1":return l.startingSum>t;case"2":return l.startingSum>=t;case"3":return l.startingSum==t;case"4":return l.startingSum<=t;case"5":return l.startingSum<t;default:return!1}}return!1;case"selFromGroups":if(e.selGroups){let t=0,o=void 0===e.selFromOperators?"1":e.selFromOperators,i=void 0===e.selNum?1:e.selNum;for(let n=0;n<e.selGroups.length;n++){const o=Ot.get(e.selGroups[n]);if(void 0!==o){const e=o.elements;for(let o=0;o<e.length;o++)St.has(e[o])&&t++}}switch(o){case"1":return!(i>t||0===i&&t>0);case"2":return i===t;case"3":return!(i<t||0===i&&t>0);default:return!1}}case"selFromRows":if(e.selRows){let t=0,o=void 0===e.selFromOperators?"1":e.selFromOperators,i=void 0===e.selNum?1:e.selNum;for(let n=0;n<e.selRows.length;n++){const o=Bt.get(e.selRows[n]);void 0!==o&&(t+=o.currentChoices)}switch(o){case"1":return!(i>t||0===i&&t>0);case"2":return i===t;case"3":return!(i<t||0===i&&t>0);default:return!1}}case"selFromWhole":let r=0,s=void 0===e.selFromOperators?"1":e.selFromOperators,c=void 0===e.selNum?1:e.selNum;for(let e=0;e<app.rows.length;e++)r+=app.rows[e].currentChoices;switch(s){case"1":return!(c>r||0===c&&r>0);case"2":return c===r;case"3":return!(c<r||0===c&&r>0);default:return!1}case"gid":const d=kt.get(e.reqId);return void 0!==d&&void 0!==app.globalRequirements&&yo(d.requireds,t);case"word":const u=Mt.get(e.reqId);if(void 0!==u){let t=0;for(let o=0;o<e.orRequired.length;o++){let i=e.orRequired[o].req;void 0!==i&&u.replaceText===i&&t++}return t>=1}return!1}else switch(e.type){case"id":return!To(e.reqId,t);case"or":let o=void 0===e.orNum?1:e.orNum,i=0;for(let l=0;l<e.orRequired.length;l++){let o=e.orRequired[l].req;(""===o||void 0!==o&&To(o,t))&&i++}return i<e.orRequired.length-o+1;case"gid":const n=kt.get(e.reqId);return void 0!==n&&void 0!==app.globalRequirements&&!yo(n.requireds,t)}return!1}function yo(e,t=St){let o=!0;if(void 0!==e)for(let i=0;i<e.length;i++){const n=e[i];let l=!0;if(void 0!==n.requireds)for(let e=0;e<n.requireds.length;e++)l=l&&Io(n.requireds[e],t);l&&(o=o&&Io(e[i],t))}return o}function So(e,t,o,i){function n(){let n=0,l=0,a=0;if(o&&(i.loadVideoById(t),e.bgmNoLoop?i.setLoop(!1):(i.loadPlaylist(t),i.setLoop(!0))),e.bgmFadeIn&&void 0!==e.bgmFadeInSec&&e.bgmFadeInSec>0){const t=e.bgmFadeInSec/20;Lt.lastFadeTime=e.bgmFadeInSec,i.setVolume(0),i.playVideo(),0!==Lt.bgmFadeInterval&&(window.clearInterval(Lt.bgmFadeInterval),Lt.bgmFadeInterval=0),0!==Lt.bgmPlayInterval&&(window.clearInterval(Lt.bgmPlayInterval),Lt.bgmPlayInterval=0),Lt.isFadingOut&&(Lt.isFadingOut=!1),Lt.bgmFadeInterval=window.setInterval(()=>{1===i.getPlayerState()&&(n<app.curVolume?(n+=5,i.setVolume(n),Lt.lastFadeTime=Lt.lastFadeTime-t):(i.setVolume(app.curVolume),window.clearInterval(Lt.bgmFadeInterval),Lt.bgmFadeInterval=0,Lt.lastFadeTime=0))},t)}else Lt.isFadingOut&&(Lt.isFadingOut=!1,window.clearInterval(Lt.bgmFadeInterval),Lt.bgmFadeInterval=0),i.playVideo(),i.setVolume(app.curVolume);Lt.bgmObjectId=e.id,app.showMusicPlayer&&(0!==Lt.bgmTitleInterval&&(window.clearInterval(Lt.bgmTitleInterval),Lt.bgmTitleInterval=0),Lt.bgmTitleInterval=window.setInterval(()=>{if(void 0!==i.playerInfo.videoData){let e=i.playerInfo.videoData;e.video_id===t&&void 0!==e.title&&""!==e.title&&(Lt.bgmTitle=e.title,Lt.curBgmLength=i.getDuration(),window.clearInterval(Lt.bgmTitleInterval),Lt.bgmTitleInterval=0)}},1e3),0!==Lt.bgmPlayInterval&&(window.clearInterval(Lt.bgmPlayInterval),Lt.bgmPlayInterval=0),Lt.bgmPlayInterval=window.setInterval(()=>{if(void 0!==i.playerInfo.videoData&&!Lt.isSeeking&&1===i.getPlayerState()){const e=Math.floor(i.getCurrentTime());e!==Lt.curBgmTime?l!==e?Lt.curBgmTime=e:(a++,a>Lt.curBgmLength&&(a=1),Lt.curBgmTime=a):(l=e,a=e+1,Lt.curBgmTime=a)}},1e3))}if(Lt.isFadingOut){const e=Lt.lastFadeTime;0!==Lt.bgmFadeTimer&&(window.clearTimeout(Lt.bgmFadeTimer),Lt.bgmFadeTimer=0),Lt.bgmFadeTimer=window.setTimeout(()=>{n()},e)}else n()}function Co(e,t){const o=app.curVolume/5;if(e.bgmFadeOut&&void 0!==e.bgmFadeOutSec&&e.bgmFadeOutSec>0&&o>0){const i=e.bgmFadeOutSec/o;let n=app.curVolume;Lt.lastFadeTime=e.bgmFadeOutSec,Lt.isFadingOut=!0,0!==Lt.bgmFadeInterval&&(window.clearInterval(Lt.bgmFadeInterval),Lt.bgmFadeInterval=0),Lt.bgmFadeInterval=window.setInterval(()=>{void 0!==t.setVolume&&(n>0?(n-=5,t.setVolume(n),Lt.lastFadeTime-=i):Lt.isFadingOut&&(t.pauseVideo(),t.setVolume(app.curVolume),window.clearInterval(Lt.bgmFadeInterval),Lt.bgmFadeInterval=0,Lt.lastFadeTime=0,Lt.isFadingOut=!1,0!==Lt.bgmTitleInterval&&(window.clearInterval(Lt.bgmTitleInterval),Lt.bgmTitleInterval=0),0!==Lt.bgmPlayInterval&&(window.clearInterval(Lt.bgmPlayInterval),Lt.bgmPlayInterval=0),Lt.bgmTitle="No Audio Title",Lt.curBgmTime=0,Lt.curBgmLength=0))},i)}else t.pauseVideo(),0!==Lt.bgmTitleInterval&&(window.clearInterval(Lt.bgmTitleInterval),Lt.bgmTitleInterval=0),0!==Lt.bgmPlayInterval&&(window.clearInterval(Lt.bgmPlayInterval),Lt.bgmPlayInterval=0),Lt.bgmTitle="No Audio Title",Lt.curBgmTime=0,Lt.curBgmLength=0}function xo(e,t,o){const i=d(Vt);if(i&&void 0!==i.playerInfo.videoData){const o=Lt.bgmIsPlaying,n=i.playerInfo.videoData.video_id,l=i.getPlayerState();n===t?Lt.bgmObjectId===e.id?o?(2===l||i.stopVideo(),So(e,t,!1,i)):Co(e,i):o?(i.stopVideo(),So(e,t,!1,i)):Co(e,i):o&&So(e,t,!0,i)}else o<10?window.setTimeout(()=>{xo(e,t,++o)},200):console.log("Failed to play bgm")}async function Bo(e){const t=new((await new Promise(e=>{if(window.YT&&window.YT.Player)e(window.YT);else{const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api",document.head.appendChild(t),window.onYouTubeIframeAPIReady=()=>e(window.YT)}})).Player)("bgm-player",{width:0,height:0,events:{onReady:()=>{Vt.set(t),xo(e,e.bgmId||"",0),app.isMute&&!t.isMuted()&&t.mute()}}})}function Ao(e,t,o=!1){if(void 0!==e){if(t){const t=["addonBorderRadiusTopLeft","addonBorderRadiusTopRight","addonBorderRadiusBottomLeft","addonBorderRadiusBottomRight","addonImgBorderRadiusTopLeft","addonImgBorderRadiusTopRight","addonImgBorderRadiusBottomLeft","addonImgBorderRadiusBottomRight","objectBorderRadiusTopLeft","objectBorderRadiusTopRight","objectBorderRadiusBottomLeft","objectBorderRadiusBottomRight","objectImgBorderRadiusTopLeft","objectImgBorderRadiusTopRight","objectImgBorderRadiusBottomLeft","objectImgBorderRadiusBottomRight","rowBorderRadiusTopLeft","rowBorderRadiusTopRight","rowBorderRadiusBottomLeft","rowBorderRadiusBottomRight","rowImgBorderRadiusTopLeft","rowImgBorderRadiusTopRight","rowImgBorderRadiusBottomLeft","rowImgBorderRadiusBottomRight"];for(let o=0;o<t.length;o++){const i=t[o];void 0!==e[i]&&(e[i]=10*e[i])}}const i=["selFilterBgColor","selFilterBorderColor","selFilterCTitleColor","selFilterCTextColor","selFilterATitleColor","selFilterATextColor","selFilterSTextColor","reqFilterBgColor","reqFilterBorderColor","reqFilterCTitleColor","reqFilterCTextColor","reqFilterATitleColor","reqFilterATextColor","reqFilterSTextColor","rowTitleColor","rowTextColor","objectTitleColor","objectTextColor","addonTitleColor","addonTextColor","scoreTextColor","objectImgBorderColor","rowImgBorderColor","addonImgBorderColor","backgroundColor","rowBgColor","objectBgColor","objectDropShadowColor","objectBorderColor","rowDropShadowColor","rowBorderColor","addonDropShadowColor","addonBorderColor","addonBgColor","barTextColor","barIconColor","barBackgroundColor","backpackBgColor","barPointNeg","barPointPos"];for(let t=0;t<i.length;t++){const o=i[t];"object"==typeof e[o]&&(e[o]=e[o].hexa)}o&&(void 0===e.customMultiTextFont&&(e.customMultiTextFont=!1),void 0===e.multiChoiceCounterPosition&&(e.multiChoiceCounterPosition=0),void 0===e.multiChoiceCounterSize&&(e.multiChoiceCounterSize=170),void 0===e.multiChoiceTextFont&&(e.multiChoiceTextFont="Times New Roman"),void 0===e.multiChoiceTextSize&&(e.multiChoiceTextSize=100))}}function Oo(e,t,o){switch(t){case"1":return e-o;case"2":return e+o;case"3":return e*o;case"4":return e/o;default:return e}}function ko(e){delete e.tmpDiscount,delete e.discountTextA,delete e.discountTextB,delete e.dupTextA,delete e.dupTextB,delete e.discountedFrom,delete e.discountIsOn,delete e.discountScore,delete e.discountScoreCal,delete e.notStackableDiscount}function Mo(e,t){var o,i,n,l,a,r;const s=xt.get(t.id);if(void 0!==s&&void 0!==e.discountOperator&&void 0!==e.discountValue){let c=s.allowFloat?t.value:Math.floor(t.value),d=t.discountIsOn&&void 0!==t.discountScore?t.discountScore:t.value;d=s.allowFloat?d:Math.floor(d);let u=0,g=0,m=[],h=!1,p=0;if(e.stackableDiscount){if(t.notStackableDiscount){if(void 0!==t.tmpDiscount){for(let e=0;e<t.tmpDiscount.length;e++)t.tmpDiscount[e].isStackable&&(m=t.tmpDiscount[e].discountedFrom,c=t.tmpDiscount[e].discountedValue,p=e);t.tmpDiscount.splice(p,1)}}else if(void 0!==t.discountedFrom){let n=t.discountedFrom.indexOf(e.id);if(t.discountedFrom.splice(n,1),void 0!==t.discountedFrom&&t.discountedFrom.length>0){u=c;for(let e=0;e<t.discountedFrom.length;e++){const o=At.get(t.discountedFrom[e]);if(void 0!==o){const e=o.choice;void 0!==e.discountOperator&&void 0!==e.discountValue&&(u=Oo(u,e.discountOperator,e.discountValue),u=s.allowFloat?u:Math.floor(u),g=u,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(u=Math.max(u,e.discountLowLimit)))}}if(e.discountShow){let n=void 0!==e.discountAfterText&&void 0!==t.discountTextA?t.discountTextA.indexOf(e.discountAfterText):-1,l=void 0!==e.discountBeforeText&&void 0!==t.discountTextB?t.discountTextB.indexOf(e.discountBeforeText):-1;e.discountTextDuplicated?(-1!==n&&void 0!==t.dupTextA&&void 0!==e.discountAfterText&&(t.dupTextA[e.discountAfterText]-=1,0===t.dupTextA[e.discountAfterText]&&(null==(o=t.discountTextA)||o.splice(n,1),delete t.dupTextA[e.discountAfterText])),-1!==l&&void 0!==t.dupTextB&&void 0!==e.discountBeforeText&&(t.dupTextB[e.discountBeforeText]-=1,0===t.dupTextB[e.discountBeforeText]&&(null==(i=t.discountTextB)||i.splice(n,1),delete t.dupTextB[e.discountBeforeText]))):(-1!==n&&void 0!==t.discountTextA&&(t.discountTextA.splice(n,1),t.discountAfterText=t.discountTextA.join("")),-1!==l&&void 0!==t.discountTextB&&(t.discountTextB.splice(l,1),t.discountBeforeText=t.discountTextB.join("")))}t.discountScore=u,t.discountScoreCal=g}else{if(void 0!==t.tmpDiscount)for(let e=0;e<t.tmpDiscount.length;e++)t.tmpDiscount[e].isStackable||u>t.tmpDiscount[e].discountedValue&&(m=t.tmpDiscount[e].discountedFrom,g=t.tmpDiscount[e].calcValue,u=t.tmpDiscount[e].discountedValue,p=e,h=!0);h&&void 0!==t.tmpDiscount?0===m.length?t.tmpDiscount.splice(p,1):(t.discountedFrom=m,t.tmpDiscount[p].showDiscount&&(t.discountBeforeText=t.tmpDiscount[p].beforeText,t.discountAfterText=t.tmpDiscount[p].afterText),t.tmpDiscount.splice(p,1),t.notStackableDiscount=!0):ko(t)}}}else if(t.notStackableDiscount)if(void 0!==t.discountedFrom&&t.discountedFrom.length>0&&void 0!==t.tmpDiscount){if(-1!==t.discountedFrom.indexOf(e.id)){if(t.tmpDiscount.length>0){c=t.tmpDiscount[0].discountedValue,h=!0;for(let e=1;e<t.tmpDiscount.length;e++)c>t.tmpDiscount[e].discountedValue&&(c=t.tmpDiscount[e].discountedValue,p=e)}h?(t.discountScore=c,t.discountScoreCal=t.tmpDiscount[p].calcValue,t.discountedFrom=t.tmpDiscount[p].discountedFrom,t.notStackableDiscount=!t.tmpDiscount[p].isStackable,t.discountShow=t.tmpDiscount[p].showDiscount,t.tmpDiscount[p].isStackable&&t.tmpDiscount[p].showDiscount?(t.discountBeforeText=null==(n=t.discountTextB)?void 0:n.join(""),t.discountAfterText=null==(l=t.discountTextA)?void 0:l.join("")):t.tmpDiscount[p].showDiscount?(t.discountBeforeText=t.tmpDiscount[p].beforeText,t.discountAfterText=t.tmpDiscount[p].afterText):(t.discountBeforeText="",t.discountAfterText=""),t.tmpDiscount.splice(p,1)):ko(t)}else for(let o=0;o<t.tmpDiscount.length;o++)if(-1!==t.tmpDiscount[o].discountedFrom.indexOf(e.id)){t.tmpDiscount.splice(o,1);break}}else ko(t);else if(void 0!==t.tmpDiscount){if(t.tmpDiscount=t.tmpDiscount.filter(t=>-1!==t.discountedFrom.indexOf(e.id)),t.tmpDiscount.length>0){c=t.tmpDiscount[0].discountedValue,h=!0;for(let e=1;e<t.tmpDiscount.length;e++)c>t.tmpDiscount[e].discountedValue&&(c=t.tmpDiscount[e].discountedValue,p=e)}h?(t.discountScore=c,t.discountScoreCal=t.tmpDiscount[p].calcValue,t.discountedFrom=t.tmpDiscount[p].discountedFrom,t.notStackableDiscount=!t.tmpDiscount[p].isStackable,t.notStackableDiscount?t.tmpDiscount[p].showDiscount?(t.discountBeforeText=t.tmpDiscount[p].beforeText,t.discountAfterText=t.tmpDiscount[p].afterText):(t.discountBeforeText="",t.discountAfterText=""):(t.discountBeforeText=null==(a=t.discountTextB)?void 0:a.join(""),t.discountAfterText=null==(r=t.discountTextA)?void 0:r.join("")),t.tmpDiscount.splice(p,1)):ko(t)}else ko(t);let v=void 0!==t.discountScore?t.discountScore:t.value;v=s.allowFloat?v:Math.floor(v),v!==d?(t.tmpDisScore=d-v,t.isChangeDiscount=!0):delete t.isChangeDiscount}}function Fo(e,t){const o=xt.get(t.id);if(void 0!==o&&void 0!==e.discountOperator&&void 0!==e.discountValue){let i,n=o.allowFloat?t.value:Math.floor(t.value),l=t.discountIsOn&&void 0!==t.discountScore?t.discountScore:n,a=0,r=0,s=[],c=!1,d=0;if(void 0===t.discountedFrom&&(t.discountedFrom=[]),e.stackableDiscount)if(t.notStackableDiscount){if(void 0!==t.tmpDiscount){for(let o=0;o<t.tmpDiscount.length;o++)t.tmpDiscount[o].isStackable&&(s=t.tmpDiscount[o].discountedFrom,s.push(e.id),n=t.tmpDiscount[o].discountedValue,c=!0,d=o);a=Oo(n,e.discountOperator,e.discountValue),a=o.allowFloat?a:Math.floor(a),r=a,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(a=Math.max(a,e.discountLowLimit)),void 0!==t.discountScore&&t.discountScore>a?(t.tmpDisScore=t.discountScore-a,t.isChangeDiscount=!0,i={isStackable:!1,discountedFrom:t.discountedFrom,calcValue:void 0!==t.discountScoreCal?t.discountScoreCal:t.discountScore,discountedValue:t.discountScore,showDiscount:!1},t.discountShow&&(i.showDiscount=!0,i.beforeText=e.discountBeforeText,i.afterText=e.discountAfterText),t.discountScore=a,t.discountScoreCal=r,e.discountShow&&(t.discountShow=!0,Ro(e,t)),void 0!==t.discountTextA&&(t.discountAfterText=t.discountTextA.join("")),void 0!==t.discountTextB&&(t.discountBeforeText=t.discountTextB.join("")),t.discountedFrom.push(...s),c&&t.tmpDiscount.splice(d,1),t.tmpDiscount.push(i),t.notStackableDiscount=!1):(t.isChangeDiscount=!1,s.push(e.id),e.discountShow&&Ro(e,t),c?(t.tmpDiscount[d].discountedFrom=s,t.tmpDiscount[d].calcValue=r,t.tmpDiscount[d].discountedValue=a):(i={isStackable:e.stackableDiscount||!1,discountedFrom:s,calcValue:r,discountedValue:a,showDiscount:e.discountShow||!1},t.tmpDiscount.push(i)))}}else n=t.discountIsOn&&void 0!==t.discountScoreCal?t.discountScoreCal:t.value,n=o.allowFloat?n:Math.floor(n),l=t.discountIsOn&&void 0!==t.discountScore?t.discountScore:t.value,l=o.allowFloat?l:Math.floor(l),a=Oo(n,e.discountOperator,e.discountValue),a=o.allowFloat?a:Math.floor(a),r=a,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(a=Math.max(a,e.discountLowLimit)),Array.isArray(t.discountedFrom)||(t.discountedFrom=[]),t.discountScore=a,t.discountScoreCal=r,t.discountedFrom.push(e.id),t.discountScore!==l?(t.tmpDisScore=l-t.discountScore,t.isChangeDiscount=!0):t.isChangeDiscount=!1,t.discountIsOn||(t.discountIsOn=!0),e.discountShow&&(t.discountShow=!0,Ro(e,t)),void 0!==t.discountTextA&&(t.discountAfterText=t.discountTextA.join("")),void 0!==t.discountTextB&&(t.discountBeforeText=t.discountTextB.join(""));else void 0===t.tmpDiscount&&(t.tmpDiscount=[]),a=Oo(n,e.discountOperator,e.discountValue),a=o.allowFloat?a:Math.floor(a),r=a,e.discountLowLimitIsOn&&void 0!==e.discountLowLimit&&(a=Math.max(a,e.discountLowLimit)),t.discountIsOn?void 0!==t.discountScore&&(t.discountScore>a?(i={isStackable:!t.notStackableDiscount,discountedFrom:t.discountedFrom,calcValue:void 0!==t.discountScoreCal?t.discountScoreCal:t.discountScore,discountedValue:t.discountScore,showDiscount:t.discountShow||!1},t.discountShow&&(i.showDiscount=!0,i.beforeText=t.discountBeforeText,i.afterText=t.discountAfterText),t.discountScore=a,t.discountScoreCal=r,t.discountShow=e.discountShow,t.discountBeforeText=e.discountBeforeText,t.discountAfterText=e.discountAfterText,t.discountedFrom=[e.id],t.notStackableDiscount=!0):(i={isStackable:void 0!==e.stackableDiscount&&e.stackableDiscount,discountedFrom:[e.id],calcValue:r,discountedValue:a,showDiscount:void 0!==e.discountShow&&e.discountShow},e.discountShow&&(i.showDiscount=!0,i.beforeText=e.discountBeforeText,i.afterText=e.discountAfterText)),t.tmpDiscount.push(i)):(t.discountScore=a,t.discountScoreCal=r,e.discountShow&&(t.discountShow=e.discountShow,t.discountBeforeText=e.discountBeforeText,t.discountAfterText=e.discountAfterText),Array.isArray(t.discountedFrom)||(t.discountedFrom=[]),t.discountIsOn=!0,t.discountedFrom.push(e.id),t.notStackableDiscount=!0),void 0!==t.discountScore&&t.discountScore!==l?(t.tmpDisScore=l-t.discountScore,t.isChangeDiscount=!0):t.isChangeDiscount=!1}}function Ro(e,t){void 0===t.discountTextA&&(t.discountTextA=[]),void 0===t.discountTextB&&(t.discountTextB=[]),void 0===t.dupTextA&&(t.dupTextA={}),void 0===t.dupTextB&&(t.dupTextB={}),e.discountTextDuplicated?(void 0!==e.discountAfterText&&(-1!==t.discountTextA.indexOf(e.discountAfterText)?t.dupTextA[e.discountAfterText]=(t.dupTextA[e.discountAfterText]||0)+1:(t.dupTextA[e.discountAfterText]=1,t.discountTextA.push(e.discountAfterText))),void 0!==e.discountBeforeText&&(-1!==t.discountTextB.indexOf(e.discountBeforeText)?t.dupTextB[e.discountBeforeText]=(t.dupTextB[e.discountBeforeText]||0)+1:(t.dupTextB[e.discountBeforeText]=1,t.discountTextB.push(e.discountBeforeText)))):(void 0!==e.discountAfterText&&t.discountTextA.push(e.discountAfterText),void 0!==e.discountBeforeText&&t.discountTextB.push(e.discountBeforeText))}function Do(e,t){let o=!0,i=new Map;for(let n=0;n<e.scores.length;n++){let l=e.scores[n],a=l.discountIsOn&&void 0!==l.discountScore?l.discountScore:l.value;if(l.multiplyByTimes&&(a*=Math.abs(e.multipleUseVariable)+1),yo(l.requireds)&&!l.isActive){let e=xt.get(l.id);if(void 0!==e&&e.belowZeroNotAllowed){let n=i.get(l.id);void 0!==n?(o=o&&(t?n-a>=0:n+a>=0),i.set(l.id,n-l.value)):(o=o&&(t?e.startingSum-a>=0:e.startingSum+a>=0),i.set(l.id,e.startingSum-a))}}}return o}function jo(){var e,t,o,i,n,l,a,r;const s=new Set;function c(e){if(e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.activatedRandom){if(e.isSelectableMultiple){for(let o=0;o<e.multipleUseVariable;o++)if(void 0!==e.activatedRandomMul)for(var t=0;t<e.activatedRandomMul[t].length;t++){const i=e.activatedRandomMul[o][t].split("/ON#"),n=At.get(i[0]);if(void 0!==n){const t=n.choice;if(St.has(t.id))e.isAllowDeselect||(s.add(t.id),i.length>1&&t.isSelectableMultiple&&(void 0===t.tempMultipleValue?t.tempMultipleValue=parseInt(i[1]):t.tempMultipleValue+=parseInt(i[1])),c(t));else{const e=Ct.get(t.id);void 0!==e?i.length>1&&(e.multiple+=parseInt(i[1])):Ct.set(t.id,{multiple:i.length>1?parseInt(i[1]):0,isAllowDeselect:t.isAllowDeselect||!1})}}}}else if(void 0!==e.activatedRandom)for(let o=0;o<e.activatedRandom.length;o++){const t=e.activatedRandom[o].split("/ON#"),i=At.get(t[0]);if(void 0!==i){const o=i.choice;if(St.has(o.id))e.isAllowDeselect||(s.add(o.id),t.length>1&&o.isSelectableMultiple&&(void 0===o.tempMultipleValue?o.tempMultipleValue=parseInt(t[1]):o.tempMultipleValue+=parseInt(t[1])),c(o));else{const e=Ct.get(o.id);void 0!==e?t.length>1&&(e.multiple+=parseInt(t[1])):Ct.set(o.id,{multiple:t.length>1?parseInt(t[1]):0,isAllowDeselect:o.isAllowDeselect||!1})}}}}else{const t=e.activateThisChoice.split(",");for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=At.get(i[0]);if(void 0!==n){const t=n.choice;if(St.has(t.id))e.isAllowDeselect||(s.add(t.id),i.length>1&&t.isSelectableMultiple&&(void 0===t.tempMultipleValue?t.tempMultipleValue=parseInt(i[1]):t.tempMultipleValue+=parseInt(i[1])),c(t));else{const e=Ct.get(t.id);void 0!==e?i.length>1&&(e.multiple+=parseInt(i[1])):Ct.set(t.id,{multiple:i.length>1?parseInt(i[1]):0,isAllowDeselect:t.isAllowDeselect||!1})}}}}}Ct.clear(),Array.from(St.entries()).forEach(([e])=>{const t=At.get(e);if(void 0!==t){const e=t.choice;e.notDeselectedByClean&&(s.add(e.id),c(e))}else St.delete(e)});let u=[...St.keys()],g=Array.from(At.entries()).filter(([e,t])=>!0===t.choice.isActive).map(([e])=>e),m=Array.from(new Set([...u,...g]));for(let h=m.length-1;h>=0;h--){const e=At.get(m[h]);if(void 0!==e){const t=e.choice;if(!s.has(t.id)){if(delete t.multiplyPointtypeIsOnCheck,delete t.startingSumAtMultiply,delete t.multiplyPointtypeIsOnCheck,delete t.startingSumAtDivide,delete t.activatedRandom,delete t.activatedRandomMul,delete t.numDiscountChoices,t.addToAllowChoice&&void 0!==t.idOfAllowChoice&&void 0!==t.numbAddToAllowChoice)for(let e=0;e<t.idOfAllowChoice.length;e++){const o=Bt.get(t.idOfAllowChoice[e]);void 0!==o&&(o.allowedChoices-=t.numbAddToAllowChoice)}if(t.isChangeVariables&&void 0!==t.changedVariables)for(let e=0;e<t.changedVariables.length;e++){const o=Ft.get(t.changedVariables[e]);void 0!==o&&("1"===t.changeType?o.isTrue=!0:"2"===t.changeType?o.isTrue=!1:"3"===t.changeType&&(o.isTrue=!o.isTrue))}if(t.textfieldIsOn&&void 0!==t.idOfTheTextfieldWord&&void 0!==t.wordChangeSelect){const e=Mt.get(t.idOfTheTextfieldWord);void 0!==e&&(e.replaceText=void 0===t.wordChangeDeselect?"":t.wordChangeDeselect)}if(t.isImageUpload&&void 0!==t.defaultImage&&(t.image=t.defaultImage),t.setBgmIsOn&&Vt&&t.bgmId){const e=d(Vt);if(e&&void 0!==e.playerInfo.videoData){const o=e.playerInfo.videoData.video_id;t.bgmId===o&&(e.stopVideo(),Lt.bgmIsPlaying=!1,0!==Lt.bgmFadeInterval&&(window.clearInterval(Lt.bgmFadeInterval),Lt.bgmFadeInterval=0),0!==Lt.bgmTitleInterval&&(window.clearInterval(Lt.bgmTitleInterval),Lt.bgmTitleInterval=0),0!==Lt.bgmPlayInterval&&(window.clearInterval(Lt.bgmPlayInterval),Lt.bgmPlayInterval=0),Lt.lastFadeTime=0,Lt.isFadingOut=!1,Lt.bgmTitle="No Audio Title",Lt.curBgmTime=0,Lt.curBgmLength=0)}}if(t.muteBgm&&Vt){const e=d(Vt);e&&"function"==typeof e.unMute&&(app.isMute=!1,e.unMute())}if(t.isContentHidden&&void 0!==t.hiddenContentsRow&&void 0!==t.hiddenContentsType)for(let e=0;e<t.hiddenContentsRow.length;e++){const o=Bt.get(t.hiddenContentsRow[e]);if(void 0!==o)for(let e=0;e<t.hiddenContentsType.length;e++)switch(t.hiddenContentsType[e]){case"1":delete o.objectTitleRemoved;break;case"2":delete o.objectImageRemoved;break;case"3":delete o.objectTextRemoved;break;case"4":delete o.objectScoreRemoved;break;case"5":delete o.objectRequirementRemoved;break;case"6":delete o.addonTitleRemoved;break;case"7":delete o.addonImageRemoved;break;case"8":delete o.addonTextRemoved}}t.multipleUseVariable=0,t.isActive=!1,St.delete(t.id)}}else St.delete(m[h])}for(let d=0;d<app.pointTypes.length;d++){const e=app.pointTypes[d];e.startingSum=e.initValue}for(let d=0;d<app.rows.length;d++){const e=app.rows[d];e.isEditModeOn=!1,e.currentChoices=0,e.index=d;for(let t=0;t<e.objects.length;t++){const o=e.objects[t];o.index=t,void 0!==o.defaultTemplate&&(o.template=o.defaultTemplate),void 0!==o.defaultWidth&&(o.width=o.defaultWidth),o.isActive||(delete o.forcedActivated,delete o.activatedFrom),delete o.templateStack,delete o.widthStack;for(let e=0;e<o.scores.length;e++){const t=o.scores[e];o.isSelectableMultiple?(delete t.isActiveMul,delete t.isActiveMulMinus):delete t.isActive,ko(t),delete t.appliedDiscount}}}for(let d=0;d<app.backpack.length;d++){const e=app.backpack[d];e.isEditModeOn=!1,e.currentChoices=0,e.index=d;for(let t=0;t<e.objects.length;t++){const o=e.objects[t];o.index=t,void 0!==o.defaultTemplate&&(o.template=o.defaultTemplate),void 0!==o.defaultWidth&&(o.width=o.defaultWidth),o.isActive||(delete o.forcedActivated,delete o.activatedFrom),delete o.templateStack,delete o.widthStack;for(let e=0;e<o.scores.length;e++){const t=o.scores[e];o.isSelectableMultiple?(delete t.isActiveMul,delete t.isActiveMulMinus):delete t.isActive,ko(t),delete t.appliedDiscount}}}if(void 0!==app.defaultBgColor&&(app.styling.backgroundColor=app.defaultBgColor,delete app.defaultBgColor),void 0!==app.defaultBgImage&&(app.styling.backgroundImage=app.defaultBgImage,delete app.defaultBgImage),void 0!==app.defaultBarBgColor&&(app.styling.barBackgroundColor=app.defaultBarBgColor,delete app.defaultBarBgColor),void 0!==app.defaultBarIconColor&&(app.styling.barIconColor=app.defaultBarIconColor,delete app.defaultBarIconColor),void 0!==app.defaultBarTextColor&&(app.styling.barTextColor=app.defaultBarTextColor,delete app.defaultBarTextColor),delete app.bgColorStack,delete app.bgImageStack,delete app.barBgColorStack,delete app.barIconColorStack,delete app.barTextColorStack,app.btnBackpackIsOn=0,app.showAllAddons=0,app.isMute=!1,app.curVolume=100,Vt){const e=d(Vt);e&&"function"==typeof e.unMute&&e.unMute()}Pt.splice(0),m=[...St.keys()];for(let d=0;d<m.length;d++){const n=At.get(m[d]);if(void 0!==n){const l=n.choice;if(yo(l.requireds)&&Do(l,!0)){if(l.discountOther&&void 0!==l.discountOperator&&void 0!==l.discountValue)if(l.isDisChoices){if(void 0!==l.discountChoices)for(let o=0;o<l.discountChoices.length;o++){const i=At.get(l.discountChoices[o]);if(void 0!==i)for(let o=0;o<i.choice.scores.length;o++){const n=i.choice.scores[o];n.isNotDiscountable||0!==(null==(e=l.discountPointTypes)?void 0:e.length)&&-1===(null==(t=l.discountPointTypes)?void 0:t.indexOf(n.id))||Fo(l,n)}}}else if(void 0!==l.discountGroups)for(let e=0;e<l.discountGroups.length;e++){const t=Ot.get(l.discountGroups[e]);if(void 0!==t)for(let e=0;e<t.elements.length;e++){const n=At.get(t.elements[e]);if(void 0!==n)for(let e=0;e<n.choice.scores.length;e++){const t=n.choice.scores[e];t.isNotDiscountable||0!==(null==(o=l.discountPointTypes)?void 0:o.length)&&-1===(null==(i=l.discountPointTypes)?void 0:i.indexOf(t.id))||Fo(l,t)}}}if(l.addToAllowChoice&&void 0!==l.idOfAllowChoice&&void 0!==l.numbAddToAllowChoice)for(let e=0;e<l.idOfAllowChoice.length;e++){const t=Bt.get(l.idOfAllowChoice[e]);void 0!==t&&(t.allowedChoices+=l.numbAddToAllowChoice)}}}}for(let h=0;h<m.length;h++){const e=At.get(m[h]);if(void 0!==e){const t=e.choice,o=e.row;if(yo(t.requireds)&&Do(t,!0)){for(let e=0;e<t.scores.length;e++){const o=t.scores[e],i=xt.get(o.id);if(void 0!==i)if(t.isSelectableMultiple&&t.isMultipleUseVariableultiple)for(let e=0;e<t.multipleUseVariable;e++)yo(o.requireds)&&(void 0===o.isActiveMul&&(o.isActiveMul=[]),o.isActiveMul[e]||(o.multiplyByTimes?i.startingSum-=o.discountIsOn&&void 0!==o.discountScore?o.discountScore*(e+1):o.value*(e+1):i.startingSum-=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value,o.isActiveMul[e]=!0));else t.isSelectableMultiple||yo(o.requireds)&&!o.isActive&&(i.startingSum-=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value,o.isActive=!0)}if(t.multiplyPointtypeIsOn&&void 0!==t.pointTypeToMultiply&&void 0!==t.multiplyWithThis){let e=0;t.multiplyPointtypeIsOnCheck=!0,"object"!=typeof t.startingSumAtMultiply&&(t.startingSumAtMultiply=[]);for(let o=0;o<t.pointTypeToMultiply.length;o++){let i=xt.get(t.pointTypeToMultiply[o]);if(void 0!==i)if(t.multiplyPointtypeIsId&&"string"==typeof t.multiplyWithThis){let n=xt.get(t.multiplyWithThis);void 0!==n?(t.startingSumAtMultiply[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum*=n.startingSum):e++}else"number"==typeof t.multiplyWithThis&&(t.startingSumAtMultiply[o]={value:i.startingSum,calcVal:t.multiplyWithThis},i.startingSum*=t.multiplyWithThis);else e++}e===t.pointTypeToMultiply.length&&delete t.multiplyPointtypeIsOnCheck,t.multiplyPointtypeIsOnCheck&&Pt.push(t)}if(t.dividePointtypeIsOn&&void 0!==t.pointTypeToDivide&&void 0!==t.divideWithThis){let e=0;t.dividePointtypeIsOnCheck=!0,"object"!=typeof t.startingSumAtDivide&&(t.startingSumAtDivide=[]);for(let o=0;o<t.pointTypeToDivide.length;o++){let i=xt.get(t.pointTypeToDivide[o]);if(void 0!==i)if(t.dividePointtypeIsId&&"string"==typeof t.divideWithThis){let n=xt.get(t.divideWithThis);void 0!==n?0===n.startingSum?e++:(t.startingSumAtDivide[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum/=n.startingSum):e++}else"number"==typeof t.divideWithThis&&(0===t.dividedWithThis?e++:(t.startingSumAtDivide[o]={value:i.startingSum,calcVal:t.divideWithThis},i.startingSum/=t.divideWithThis));else e++}e===t.pointTypeToDivide.length&&delete t.dividePointtypeIsOnCheck,!t.multiplyPointtypeIsOnCheck&&t.dividePointtypeIsOnCheck&&Pt.push(t)}if(t.changeBackground&&(t.changeBgImage?void 0!==t.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage||""),app.bgImageStack.push({id:t.id,data:t.bgImage}),app.styling.backgroundImage=t.bgImage):void 0!==t.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor||""),app.bgColorStack.push({id:t.id,data:t.changedBgColorCode}),app.styling.backgroundColor=t.changedBgColorCode)),t.changePointBar&&(t.changeBarBgColorIsOn&&void 0!==t.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor||"#FFFFFFFF"),app.barBgColorStack.push({id:t.id,data:t.changedBarBgColor}),app.styling.barBackgroundColor=t.changedBarBgColor),t.changeBarIconColorIsOn&&void 0!==t.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor||"#0000008A"),app.barIconColorStack.push({id:t.id,data:t.changedBarIconColor}),app.styling.barIconColor=t.changedBarIconColor),t.changeBarTextColorIsOn&&void 0!==t.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor||"#000000"),app.barTextColorStack.push({id:t.id,data:t.changedBarTextColor}),app.styling.barTextColor=t.changedBarTextColor)),t.changeTemplates&&t.changeTemplatesList&&t.changeToThisTemplate){const e=t.changeTemplatesList.split(",");for(let o=0;o<e.length;o++){const i=e[o],n=At.get(i);if(void 0!==n){const e=n.choice;if(bi(e,t.id,t.changeToThisTemplate),t.changeAddonTemplate)for(let o=0;o<e.addons.length;o++){bi(e.addons[o],t.id,t.changeToThisTemplate)}continue}const l=Bt.get(i);if(void 0!==l){bi(l,t.id,t.changeToThisTemplate);continue}const a=Ot.get(i[0]);if(void 0!==a){const e=a.rowElements;for(let i=0;i<e.length;i++){const o=Bt.get(e[i]);void 0!==o&&bi(o,t.id,t.changeToThisTemplate)}const o=a.elements;for(let i=0;i<o.length;i++){const e=At.get(o[i]);if(void 0!==e){bi(e.choice,t.id,t.changeToThisTemplate)}}continue}}}if(t.changeWidth&&t.changeWidthList&&t.changeToThisWidth){const e=t.changeWidthList.split(",");for(let o=0;o<e.length;o++){const i=e[o],n=At.get(i);if(void 0!==n){Ti(n.choice,t.id,t.changeToThisWidth);continue}const l=Bt.get(i);if(void 0!==l){Ti(l,t.id,t.changeToThisWidth);continue}const a=Ot.get(i[0]);if(void 0!==a){const e=a.rowElements;for(let i=0;i<e.length;i++){const o=Bt.get(e[i]);void 0!==o&&Ti(o,t.id,t.changeToThisWidth)}const o=a.elements;for(let i=0;i<o.length;i++){const e=At.get(o[i]);if(void 0!==e){Ti(e.choice,t.id,t.changeToThisWidth)}}continue}}}if(t.muteBgm&&Vt){const e=d(Vt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}t.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),t.showAllAddons&&(app.showAllAddons+=1),o.currentChoices+=1}else{if(t.discountOther&&void 0!==t.discountOperator&&void 0!==t.discountValue)if(t.isDisChoices){if(void 0!==t.discountChoices)for(let e=0;e<t.discountChoices.length;e++){const o=At.get(t.discountChoices[e]);if(void 0!==o)for(let e=0;e<o.choice.scores.length;e++){const i=o.choice.scores[e];i.isNotDiscountable||0!==(null==(n=t.discountPointTypes)?void 0:n.length)&&-1===(null==(l=t.discountPointTypes)?void 0:l.indexOf(i.id))||Mo(t,i)}}}else if(void 0!==t.discountGroups)for(let e=0;e<t.discountGroups.length;e++){const o=Ot.get(t.discountGroups[e]);if(void 0!==o)for(let e=0;e<o.elements.length;e++){const i=At.get(o.elements[e]);if(void 0!==i)for(let e=0;e<i.choice.scores.length;e++){const o=i.choice.scores[e];o.isNotDiscountable||0!==(null==(a=t.discountPointTypes)?void 0:a.length)&&-1===(null==(r=t.discountPointTypes)?void 0:r.indexOf(o.id))||Mo(t,o)}}}if(t.addToAllowChoice&&void 0!==t.idOfAllowChoice&&void 0!==t.numbAddToAllowChoice)for(let e=0;e<t.idOfAllowChoice.length;e++){const o=Bt.get(t.idOfAllowChoice[e]);void 0!==o&&(o.allowedChoices-=t.numbAddToAllowChoice)}St.delete(t.id),t.forcedActivated&&Ct.set(t.id,{multiple:t.multipleUseVariable})}}else St.delete(m[h])}}function Po(e,t,o,i=new Set){Array.from(St.entries()).forEach(([l])=>{const a=At.get(l);if(void 0!==a){const l=a.row,r=a.choice,s=new n;let c=!1,d=!1;e.useDiscountCount&&void 0===e.numDiscountChoices&&(e.numDiscountChoices=0);for(let o=0;o<r.scores.length;o++){const a=r.scores[o];if(!a.isNotRecalculatable){const o=xt.get(a.id);if(void 0!==o){if(e.discountOther&&a.isChangeDiscount&&void 0!==a.tmpDisScore){const t=r.multipleUseVariable;if(!e.useDiscountCount||e.useDiscountCount&&e.discountCount&&e.discountCount>e.numDiscountChoices){if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){for(let e=t-1;e>=0;e--)r.isActive&&(o.startingSum+=a.tmpDisScore);r.isActive&&(s.set(a.id,a.tmpDisScore),delete a.isChangeDiscount,delete a.tmpDisScore)}else r.isSelectableMultiple||(o.startingSum+=a.tmpDisScore,s.set(a.id,a.tmpDisScore),delete a.isChangeDiscount,delete a.tmpDisScore);r.isActive&&(a.appliedDiscount=!0,c=!0)}}if(!i.has(a.idx)){const c=e.scores.length>0,u=e.scores.length||1;for(let g=0;g<u;g++){const u=c?e.scores[g]:null,m=u&&t.get(u.id)||0,h=u?xt.get(u.id):null;if((!c||c&&h)&&r.isActive){const t=yo(a.requireds),c=new n(JSON.parse(JSON.stringify([...St])));c.delete(e.id),l.currentChoices-=1,h&&(h.startingSum+=m);const u=yo(a.requireds,c);if(l.currentChoices+=1,h&&(h.startingSum-=m),u!==t){let e=a.discountIsOn&&void 0!==a.discountScore?a.discountScore:a.value;if(u)if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){for(let t=r.multipleUseVariable-1;t>=0;t--)void 0!==a.isActiveMul&&a.isActiveMul[t]&&(o.startingSum+=e,s.set(a.id,e),a.isActiveMul[t]=!1)}else r.isSelectableMultiple||a.isActive&&(o.startingSum+=e,s.set(a.id,e),delete a.isActive);else if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){const t=r.multipleUseVariable;void 0===a.isActiveMul&&(a.isActiveMul=[]);for(let i=t-1;i>=0;i--)a.isActiveMul[i]||(o.startingSum-=e,s.set(a.id,e),a.isActiveMul[i]=!0)}else r.isSelectableMultiple||a.isActive||(o.startingSum-=e,s.set(a.id,e),a.isActive=!0);d=!0,i.add(a.idx)}}}}}}}c&&void 0!==e.numDiscountChoices&&(e.numDiscountChoices+=1),d&&Po(r,s,++o,i)}})}function $o(e,t){var o,i,l,a,r,s;let c=e.split("/IMG#");const u=c.length>1?c[1]:"";c=c[0].split("/WORD#");const g=c.length>1?c[1].replace(/\/CHAR#/g,","):"";c=c[0].split("/RND#");const m=c.length>1?c[1].split("/AND#"):"",h=c[0],p=At.get(h);if(void 0!==p){const e=p.row,c=p.choice;for(let t=0;t<c.scores.length;t++){const e=c.scores[t],o=xt.get(e.id);void 0!==o&&e.isRandom&&!e.setValue&&void 0!==e.maxValue&&void 0!==e.minValue&&(e.value=Math.floor(Math.random()*(e.maxValue-e.minValue+1))+e.minValue,e.value=o.allowFloat?e.value:Math.floor(e.value),e.setValue=!0)}const h=new n;if(c.isActive=!0,St.set(c.id,{multiple:0}),e.currentChoices+=1,c.discountOther&&void 0!==c.discountOperator&&void 0!==c.discountValue)if(c.isDisChoices){const e=new Set;if(void 0!==c.discountRows)for(let t=0;t<c.discountRows.length;t++){const n=Bt.get(c.discountRows[t]);if(void 0!==n)for(let t=0;t<n.objects.length;t++){const l=n.objects[t];for(let e=0;e<l.scores.length;e++){const t=l.scores[e];t.isNotDiscountable||0!==(null==(o=c.discountPointTypes)?void 0:o.length)&&-1===(null==(i=c.discountPointTypes)?void 0:i.indexOf(t.id))||Fo(c,t)}e.add(l.id)}}if(void 0!==c.discountChoices)for(let t=0;t<c.discountChoices.length;t++)if(!e.has(c.discountChoices[t])){const e=At.get(c.discountChoices[t]);if(void 0!==e){const t=e.choice;for(let e=0;e<t.scores.length;e++){const o=t.scores[e];o.isNotDiscountable||0!==(null==(l=c.discountPointTypes)?void 0:l.length)&&-1===(null==(a=c.discountPointTypes)?void 0:a.indexOf(o.id))||Fo(c,o)}}}}else if(void 0!==c.discountGroups)for(let t=0;t<c.discountGroups.length;t++){const e=Ot.get(c.discountGroups[t]);if(void 0!==e)for(let t=0;t<e.elements.length;t++){const o=At.get(e.elements[t]);if(void 0!==o)for(let e=0;e<o.choice.scores.length;e++){const t=o.choice.scores[e];t.isNotDiscountable||0!==(null==(r=c.discountPointTypes)?void 0:r.length)&&-1===(null==(s=c.discountPointTypes)?void 0:s.indexOf(t.id))||Fo(c,t)}}}let v=new Set;for(let t=0;t<c.scores.length;t++){const e=c.scores[t];if(yo(e.requireds)&&!e.isActive){const t=xt.get(e.id);if(void 0!==t){let o=e.value;if(e.discountIsOn&&void 0!==e.discountScore&&e.discountedFrom&&e.discountedFrom.length>0){const t=At.get(e.discountedFrom[0]);if(void 0!==t){const i=t.choice;if(i.useDiscountCount&&void 0!==i.discountCount){if(void 0===i.numDiscountChoices&&(i.numDiscountChoices=0),i.discountCount>i.numDiscountChoices)v.add(i),o=e.discountScore,e.appliedDiscount=!0;else if(void 0!==e.tmpDiscount)for(let t=0;t<e.tmpDiscount.length;t++)o>e.tmpDiscount[t].discountedValue&&(o=e.tmpDiscount[t].discountedValue)}else o=e.discountScore,e.appliedDiscount=!0}}o=t.allowFloat?o:Math.floor(o),t.startingSum-=o,e.isActive=!0;let i=h.get(e.id);void 0!==i?h.set(e.id,o+i):h.set(e.id,o)}}}if(v.size>0&&v.forEach(e=>{void 0!==e.numDiscountChoices&&(e.numDiscountChoices+=1)}),c.duplicateRow&&void 0!==c.duplicateRowId&&void 0!==c.duplicateRowPlace&&No(c),c.activateOtherChoice&&void 0!==c.activateThisChoice){const e=new Set(t.map(e=>e.split("/ON#")[0]));if(c.isActivateRandom&&void 0!==c.numActivateRandom)if(""===m){let t=c.activateThisChoice.split(",").filter(t=>e.has(t.split("/ON#")[0]));const o=c.numActivateRandom>t.length?t.length:c.numActivateRandom;let i=new Set;for(let e=0;e<t.length;e++){const o=At.get(t[e]);if(void 0!==o){if(!yo(o.choice.requireds)){const o=t[e];t.splice(e,1),t.push(o)}}}for(let e=t.length-1;e>=0;e--)i.add(t[e]);t=[...i].reverse(),c.activatedRandom=t.slice(0,o);for(let e=0;e<o;e++){const t=c.activatedRandom[e].split("/ON#"),o=At.get(t[0]);if(void 0!==o){const e=o.choice;if(!c.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable){const o=parseInt(t[1]);for(let t=0;t<Math.abs(o);t++)o>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:o<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--}e.forcedActivated=!0}}}}else{let t=m.filter(t=>e.has(t.split("/RON#")[0]));c.activatedRandom=t;for(let e=0;e<t.length;e++){const t=c.activatedRandom[e].split("/RON#"),o=At.get(t[0]);if(void 0!==o){const e=o.choice;if(!c.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable){const o=parseInt(t[1]);for(let t=0;t<Math.abs(o);t++)o>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:o<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--}e.forcedActivated=!0}}}}else{const t=c.activateThisChoice.split(",").filter(t=>e.has(t.split("/ON#")[0]));for(let e=0;e<t.length;e++){const o=t[e].split("/ON#"),i=o.length>1?parseInt(o[1]):0,n=At.get(o[0]);if(void 0!==n){const e=n.choice;if(!c.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable)if(c.isSelectableMultiple&&c.isMultipleUseVariable)for(let t=0;t<Math.abs(c.multipleUseVariable);t++)for(let o=0;o<Math.abs(i);o++)i>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:i<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;else for(let t=0;t<Math.abs(i);t++)i>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:i<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;e.forcedActivated=!0}}else{const e=Ot.get(o[0]);if(void 0!==e){const t=e.elements;for(let e=0;e<t.length;e++){const o=At.get(t[e]);if(void 0!==o){const e=o.choice;if(!c.isAllowDeselect){if(e.isSelectableMultiple&&e.isMultipleUseVariable)if(c.isSelectableMultiple&&c.isMultipleUseVariable)for(let t=0;t<Math.abs(c.multipleUseVariable);t++)for(let o=0;o<Math.abs(i);o++)i>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:i<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;else for(let t=0;t<Math.abs(i);t++)i>0&&void 0!==e.numMultipleTimesMinus?e.numMultipleTimesMinus++:i<0&&void 0!==e.numMultipleTimesPluss&&e.numMultipleTimesPluss--;e.forcedActivated=!0}}}}}}}}if(c.multiplyPointtypeIsOn&&void 0!==c.pointTypeToMultiply&&void 0!==c.multiplyWithThis){let e=0;c.multiplyPointtypeIsOnCheck=!0,"object"!=typeof c.startingSumAtMultiply&&(c.startingSumAtMultiply=[]);for(let t=0;t<c.pointTypeToMultiply.length;t++){let o=xt.get(c.pointTypeToMultiply[t]);if(void 0!==o)if(c.multiplyPointtypeIsId&&"string"==typeof c.multiplyWithThis){let i=xt.get(c.multiplyWithThis);void 0!==i?(c.startingSumAtMultiply[t]={value:o.startingSum,calcVal:i.startingSum},o.startingSum*=i.startingSum,o.startingSum=o.allowFloat?o.startingSum:Math.floor(o.startingSum)):e++}else"number"==typeof c.multiplyWithThis&&(c.startingSumAtMultiply[t]={value:o.startingSum,calcVal:c.multiplyWithThis},o.startingSum*=c.multiplyWithThis,o.startingSum=o.allowFloat?o.startingSum:Math.floor(o.startingSum));else e++}e===c.pointTypeToMultiply.length&&delete c.multiplyPointtypeIsOnCheck,c.multiplyPointtypeIsOnCheck&&Pt.push(c)}if(c.dividePointtypeIsOn&&void 0!==c.pointTypeToDivide&&void 0!==c.divideWithThis){let e=0;c.dividePointtypeIsOnCheck=!0,"object"!=typeof c.startingSumAtDivide&&(c.startingSumAtDivide=[]);for(let t=0;t<c.pointTypeToDivide.length;t++){let o=xt.get(c.pointTypeToDivide[t]);if(void 0!==o)if(c.dividePointtypeIsId&&"string"==typeof c.divideWithThis){let i=xt.get(c.divideWithThis);void 0!==i?0===i.startingSum?e++:(c.startingSumAtDivide[t]={value:o.startingSum,calcVal:i.startingSum},o.startingSum/=i.startingSum,o.startingSum=o.allowFloat?o.startingSum:Math.floor(o.startingSum)):e++}else"number"==typeof c.divideWithThis&&(0===c.dividedWithThis?e++:(c.startingSumAtDivide[t]={value:o.startingSum,calcVal:c.divideWithThis},o.startingSum/=c.divideWithThis,o.startingSum=o.allowFloat?o.startingSum:Math.floor(o.startingSum)));else e++}e===c.pointTypeToDivide.length&&delete c.dividePointtypeIsOnCheck,!c.multiplyPointtypeIsOnCheck&&c.dividePointtypeIsOnCheck&&Pt.push(c)}if(c.isChangeVariables&&void 0!==c.changedVariables)for(let t=0;t<c.changedVariables.length;t++){const e=Ft.get(c.changedVariables[t]);void 0!==e&&("1"===c.changeType?e.isTrue=!0:"2"===c.changeType?e.isTrue=!1:"3"===c.changeType&&(e.isTrue=!e.isTrue))}if(c.addToAllowChoice&&void 0!==c.idOfAllowChoice&&void 0!==c.numbAddToAllowChoice)for(let t=0;t<c.idOfAllowChoice.length;t++){const e=Bt.get(c.idOfAllowChoice[t]);void 0!==e&&(e.allowedChoices+=c.numbAddToAllowChoice)}if(c.textfieldIsOn&&void 0!==c.idOfTheTextfieldWord&&void 0!==c.wordChangeSelect){const e=Mt.get(c.idOfTheTextfieldWord);void 0!==e&&(c.customTextfieldIsOn?e.replaceText=g:e.replaceText=c.wordChangeSelect)}if(c.isImageUpload&&(c.defaultImage=c.image,c.image=u),c.backpackBtnRequirement&&(void 0===app.btnBackpackIsOn&&(app.btnBackpackIsOn=0),app.btnBackpackIsOn+=1),c.showAllAddons&&(void 0===app.showAllAddons&&(app.showAllAddons=0),app.showAllAddons+=1),c.changeBackground&&(c.changeBgImage?void 0!==c.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage||""),app.bgImageStack.push({id:c.id,data:c.bgImage}),app.styling.backgroundImage=c.bgImage):void 0!==c.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor||""),app.bgColorStack.push({id:c.id,data:c.changedBgColorCode}),app.styling.backgroundColor=c.changedBgColorCode)),c.changePointBar&&(c.changeBarBgColorIsOn&&void 0!==c.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor||"#FFFFFFFF"),app.barBgColorStack.push({id:c.id,data:c.changedBarBgColor}),app.styling.barBackgroundColor=c.changedBarBgColor),c.changeBarIconColorIsOn&&void 0!==c.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor||"#0000008A"),app.barIconColorStack.push({id:c.id,data:c.changedBarIconColor}),app.styling.barIconColor=c.changedBarIconColor),c.changeBarTextColorIsOn&&void 0!==c.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor||"#000000"),app.barTextColorStack.push({id:c.id,data:c.changedBarTextColor}),app.styling.barTextColor=c.changedBarTextColor)),c.changeTemplates&&c.changeTemplatesList&&c.changeToThisTemplate){const e=c.changeTemplatesList.split(",");for(let t=0;t<e.length;t++){const o=e[t],i=At.get(o);if(void 0!==i){const e=i.choice;if(bi(e,c.id,c.changeToThisTemplate),c.changeAddonTemplate)for(let t=0;t<e.addons.length;t++){bi(e.addons[t],c.id,c.changeToThisTemplate)}continue}const n=Bt.get(o);if(void 0!==n){bi(n,c.id,c.changeToThisTemplate);continue}const l=Ot.get(o[0]);if(void 0!==l){const e=l.rowElements;for(let o=0;o<e.length;o++){const t=Bt.get(e[o]);void 0!==t&&bi(t,c.id,c.changeToThisTemplate)}const t=l.elements;for(let o=0;o<t.length;o++){const e=At.get(t[o]);if(void 0!==e){bi(e.choice,c.id,c.changeToThisTemplate)}}continue}}}if(c.changeWidth&&c.changeWidthList&&c.changeToThisWidth){const e=c.changeWidthList.split(",");for(let t=0;t<e.length;t++){const o=e[t],i=At.get(o);if(void 0!==i){Ti(i.choice,c.id,c.changeToThisWidth);continue}const n=Bt.get(o);if(void 0!==n){Ti(n,c.id,c.changeToThisWidth);continue}const l=Ot.get(o[0]);if(void 0!==l){const e=l.rowElements;for(let o=0;o<e.length;o++){const t=Bt.get(e[o]);void 0!==t&&Ti(t,c.id,c.changeToThisWidth)}const t=l.elements;for(let o=0;o<t.length;o++){const e=At.get(t[o]);if(void 0!==e){Ti(e.choice,c.id,c.changeToThisWidth)}}continue}}}if(c.setBgmIsOn&&c.bgmId&&(Lt.bgmIsPlaying=!0,Lt.isBgmInit?xo(c,c.bgmId,0):(Bo(c),Lt.isBgmInit=!0)),c.muteBgm&&Vt){const e=d(Vt);e&&"function"==typeof e.mute&&(app.isMute=!0,e.mute())}if(c.isContentHidden&&void 0!==c.hiddenContentsRow&&void 0!==c.hiddenContentsType)for(let t=0;t<c.hiddenContentsRow.length;t++){const e=Bt.get(c.hiddenContentsRow[t]);if(void 0!==e){e.textIsRemoved||(e.textIsRemoved=!0);for(let t=0;t<c.hiddenContentsType.length;t++)switch(c.hiddenContentsType[t]){case"1":e.objectTitleRemoved=!0;break;case"2":e.objectImageRemoved=!0;break;case"3":e.objectTextRemoved=!0;break;case"4":e.objectScoreRemoved=!0;break;case"5":e.objectRequirementRemoved=!0;break;case"6":e.addonTitleRemoved=!0;break;case"7":e.addonImageRemoved=!0;break;case"8":e.addonTextRemoved=!0}}}Po(c,h,0)}}function qo(e,t){var o,i,l,a,r,s;const c=e.length>1?e[1].split("/AND#"):"",u=e[0].split("/ON#"),g=At.get(u[0]);if(void 0!==g){const e=g.choice,u=g.row;for(let t=0;t<e.scores.length;t++){const o=e.scores[t],i=xt.get(o.id);void 0!==i&&o.isRandom&&!o.setValue&&void 0!==o.maxValue&&void 0!==o.minValue&&(o.value=Math.floor(Math.random()*(o.maxValue-o.minValue+1))+o.minValue,o.value=i.allowFloat?o.value:Math.floor(o.value),o.setValue=!0)}const m=new n,h=e.isActive,p=e.multipleUseVariable>=0,v=Math.abs(e.multipleUseVariable);if(e.isActive||(e.isActive=!0,u.currentChoices+=1),e.multipleUseVariable++,St.set(e.id,{multiple:e.multipleUseVariable}),p&&e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue)if(e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let n=0;n<e.discountRows.length;n++){const l=Bt.get(e.discountRows[n]);if(void 0!==l)for(let n=0;n<l.objects.length;n++){const a=l.objects[n];for(let t=0;t<a.scores.length;t++){const n=a.scores[t];n.isNotDiscountable||0!==(null==(o=e.discountPointTypes)?void 0:o.length)&&-1===(null==(i=e.discountPointTypes)?void 0:i.indexOf(n.id))||Fo(e,n)}t.add(a.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const t=At.get(e.discountChoices[o]);if(void 0!==t){const o=t.choice;for(let t=0;t<o.scores.length;t++){const i=o.scores[t];i.isNotDiscountable||0!==(null==(l=e.discountPointTypes)?void 0:l.length)&&-1===(null==(a=e.discountPointTypes)?void 0:a.indexOf(i.id))||Fo(e,i)}}}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Ot.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=At.get(o.elements[t]);if(void 0!==i)for(let t=0;t<i.choice.scores.length;t++){const o=i.choice.scores[t];o.isNotDiscountable||0!==(null==(r=e.discountPointTypes)?void 0:r.length)&&-1===(null==(s=e.discountPointTypes)?void 0:s.indexOf(o.id))||Fo(e,o)}}}let f=new Set;for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(void 0===o.isActiveMul&&(o.isActiveMul=[]),yo(o.requireds)&&!o.isActiveMul[v]){const e=xt.get(o.id);if(void 0!==e){let t=o.value;if(o.discountIsOn&&void 0!==o.discountScore&&o.discountedFrom&&o.discountedFrom.length>0){const e=At.get(o.discountedFrom[0]);if(void 0!==e){const i=e.choice;if(i.useDiscountCount&&void 0!==i.discountCount){if(void 0===i.numDiscountChoices&&(i.numDiscountChoices=0),i.discountCount>i.numDiscountChoices)f.add(i),t=o.discountScore,o.appliedDiscount=!0;else if(void 0!==o.tmpDiscount)for(let e=0;e<o.tmpDiscount.length;e++)t>o.tmpDiscount[e].discountedValue&&(t=o.tmpDiscount[e].discountedValue)}else t=o.discountScore,o.appliedDiscount=!0}}t=e.allowFloat?t:Math.floor(t),o.multiplyByTimes&&(t*=v+1),e.startingSum-=t,o.isActiveMul[v]=!0;let i=m.get(o.id);void 0!==i?m.set(o.id,t+i):m.set(o.id,t)}}}if(f.size>0&&f.forEach(e=>{void 0!==e.numDiscountChoices&&(e.numDiscountChoices+=1)}),p&&(e.duplicateRow&&void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace&&No(e),e.activateOtherChoice&&void 0!==e.activateThisChoice)){const o=new Set(t.map(e=>e.split("/ON#")[0]));if(e.isActivateRandom&&void 0!==e.numActivateRandom)if(void 0===e.activatedRandomMul&&(e.activatedRandomMul=[]),""===c){if(1===e.multipleUseVariable){let t=e.activateThisChoice.split(",").filter(e=>o.has(e.split("/ON#")[0]));e.numActivateRandom>t.length?t.length:e.numActivateRandom;let i=new Set;for(let e=0;e<t.length;e++){const o=At.get(t[e]);if(void 0!==o){if(!yo(o.choice.requireds)){const o=t[e];t.splice(e,1),t.push(o)}}}for(let e=t.length-1;e>=0;e--)i.add(t[e]);t=[...i].reverse();let n=0,l=[];for(let o=0;o<e.numActivateRandom;o++){l[o]=t.length/(e.numActivateRandom*(o+1))<1?t.length%(e.numActivateRandom*(o+1)):e.numActivateRandom,e.activatedRandomMul.push(t.slice(n,l[o]+n));for(let t=0;t<l[o]-n;t++){const i=e.activatedRandomMul[o][t].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.choice;if(!e.isAllowDeselect){if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}}n+=l[o]}}}else{const t=(e.multipleUseVariable-1)*e.numActivateRandom,i=c.splice(t,t+e.numActivateRandom);e.activatedRandomMul.push(i);for(let n=0;n<e.activatedRandomMul[e.multipleUseVariable-1].length;n++){const t=e.activatedRandomMul[e.multipleUseVariable-1][n].split("/RON#"),i=t.length>1?parseInt(t[1]):0,l=At.get(t[0]);if(void 0!==l){const t=l.choice;if(!e.isAllowDeselect&&o.has(t.id)){if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let e=0;e<Math.abs(i);e++)i>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:i<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}}}else{const t=e.activateThisChoice.split(",").filter(e=>o.has(e.split("/ON#")[0]));for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.choice;if(!e.isAllowDeselect){if(t.isSelectableMultiple&&t.isMultipleUseVariable)if(e.isSelectableMultiple&&e.isMultipleUseVariable)for(let o=0;o<Math.abs(e.multipleUseVariable);o++)for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;else for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.elements;for(let t=0;t<o.length;t++){const i=At.get(o[t]);if(void 0!==i){const t=i.choice;if(!e.isAllowDeselect){if(t.isSelectableMultiple&&t.isMultipleUseVariable)if(e.isSelectableMultiple&&e.isMultipleUseVariable)for(let o=0;o<Math.abs(e.multipleUseVariable);o++)for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;else for(let e=0;e<Math.abs(n);e++)n>0&&void 0!==t.numMultipleTimesMinus?t.numMultipleTimesMinus++:n<0&&void 0!==t.numMultipleTimesPluss&&t.numMultipleTimesPluss--;t.forcedActivated=!0}}}}}}}}if(e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const o=Bt.get(e.idOfAllowChoice[t]);void 0!==o&&(o.allowedChoices+=e.numbAddToAllowChoice)}if(!h){if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Ft.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!0:"2"===e.changeType?o.isTrue=!1:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),e.showAllAddons&&(app.showAllAddons+=1),e.changeBackground&&(e.changeBgImage?void 0!==e.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=app.styling.backgroundImage||""),app.bgImageStack.push({id:e.id,data:e.bgImage}),app.styling.backgroundImage=e.bgImage):void 0!==e.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=app.styling.backgroundColor||""),app.bgColorStack.push({id:e.id,data:e.changedBgColorCode}),app.styling.backgroundColor=e.changedBgColorCode)),e.changePointBar&&(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=app.styling.barBackgroundColor||"#FFFFFFFF"),app.barBgColorStack.push({id:e.id,data:e.changedBarBgColor}),app.styling.barBackgroundColor=e.changedBarBgColor),e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=app.styling.barIconColor||"#0000008A"),app.barIconColorStack.push({id:e.id,data:e.changedBarIconColor}),app.styling.barIconColor=e.changedBarIconColor),e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=app.styling.barTextColor||"#000000"),app.barTextColorStack.push({id:e.id,data:e.changedBarTextColor}),app.styling.barTextColor=e.changedBarTextColor)),e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;if(bi(t,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){bi(t.addons[o],e.id,e.changeToThisTemplate)}continue}const l=Bt.get(i);if(void 0!==l){bi(l,e.id,e.changeToThisTemplate);continue}const a=Ot.get(i[0]);if(void 0!==a){const t=a.rowElements;for(let i=0;i<t.length;i++){const o=Bt.get(t[i]);void 0!==o&&bi(o,e.id,e.changeToThisTemplate)}const o=a.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){bi(t.choice,e.id,e.changeToThisTemplate)}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){Ti(n.choice,e.id,e.changeToThisWidth);continue}const l=Bt.get(i);if(void 0!==l){Ti(l,e.id,e.changeToThisWidth);continue}const a=Ot.get(i[0]);if(void 0!==a){const t=a.rowElements;for(let i=0;i<t.length;i++){const o=Bt.get(t[i]);void 0!==o&&Ti(o,e.id,e.changeToThisWidth)}const o=a.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){Ti(t.choice,e.id,e.changeToThisWidth)}}continue}}}if(e.setBgmIsOn&&e.bgmId&&(Lt.bgmIsPlaying=!0,Lt.isBgmInit?xo(e,e.bgmId,0):(Bo(e),Lt.isBgmInit=!0)),e.muteBgm&&Vt){const e=d(Vt);e&&"function"==typeof e.mute&&(app.isMute=!0,e.mute())}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Bt.get(e.hiddenContentsRow[t]);if(void 0!==o){o.textIsRemoved||(o.textIsRemoved=!0);for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!0;break;case"2":o.objectImageRemoved=!0;break;case"3":o.objectTextRemoved=!0;break;case"4":o.objectScoreRemoved=!0;break;case"5":o.objectRequirementRemoved=!0;break;case"6":o.addonTitleRemoved=!0;break;case"7":o.addonImageRemoved=!0;break;case"8":o.addonTextRemoved=!0}}}}Po(e,m,0)}}function Vo(e,t){const o=new n,i=Math.abs(e.multipleUseVariable-1);for(let n=0;n<e.scores.length;n++){const t=e.scores[n];if(void 0===t.isActiveMulMinus&&(t.isActiveMulMinus=[]),yo(t.requireds)&&!t.isActiveMulMinus[i]){const e=xt.get(t.id);if(void 0!==e){let n=t.discountIsOn&&void 0!==t.discountScore?t.discountScore:t.value;n=e.allowFloat?n:Math.floor(n),t.multiplyByTimes&&(n*=Math.abs(i)),e.startingSum+=n;let l=o.get(t.id);void 0!==l?o.set(t.id,-n+l):o.set(t.id,-n),t.isActiveMulMinus[i]=!0}}}if(e.multipleUseVariable-=1,0===e.multipleUseVariable?(e.isActive=!1,t.currentChoices-=1,St.delete(e.id)):(-1===e.multipleUseVariable&&(e.isActive=!0,t.currentChoices+=1),St.set(e.id,{multiple:e.multipleUseVariable})),e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let n=0;n<e.idOfAllowChoice.length;n++){const t=Bt.get(e.idOfAllowChoice[n]);void 0!==t&&(t.allowedChoices-=e.numbAddToAllowChoice)}Po(e,o,0)}function Lo(e){jo();const t=e.split(",");for(let o=0;o<t.length;o++){const e=t[o].split(/\/(IMG|WORD|RND)#/)[0].split("/ON#"),i=e.length>1?parseInt(e[1]):0,n=At.get(e[0]);if(void 0!==n){const e=n.choice;if(e.isSelectableMultiple&&e.isMultipleUseVariable)for(let l=0;l<Math.abs(i);l++){const l=t[o].split("/RND#");i>0?qo(l,t):Vo(e,n.row)}else $o(t[o],t)}}}function No(e,t){if(void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace){const t=e.duplicateRowId;let o=0;Array.from(Bt.entries()).forEach(([e])=>{e.split("/D#")[0]===t.split("/D#")[0]&&o++});const i=Bt.get(e.duplicateRowId),n=Bt.get(e.duplicateRowPlace),l="/D#".concat(o);if(void 0!==i&&void 0!==n){const t=JSON.parse(JSON.stringify(i));if(t.id="".concat(t.id.split("/D#")[0]).concat(l),n.isBackpack){app.backpack.splice(n.index+1,0,t),Bt.set(t.id,app.backpack[n.index+1]);for(let e=n.index+1;e<app.backpack.length;e++)app.backpack[e].index=e}else{app.rows.splice(n.index+1,0,t),Bt.set(t.id,app.rows[n.index+1]);for(let e=n.index+1;e<app.rows.length;e++)app.rows[e].index=e}for(let o=0;o<t.objects.length;o++){const i=t.objects[o];i.id="".concat(i.id.split("/D#")[0]).concat(l),i.isActive=!1,delete i.forcedActivated;for(let e=0;e<i.scores.length;e++){const t=i.scores[e];t.idx=mo(0,5),jt.add(t.idx),delete t.isActive,delete t.setValue,delete t.discountIsOn,delete t.discountShow,delete t.discountBeforeText,delete t.discountAfterText,delete t.discountScore,delete t.discountScoreCal,delete t.isChangeDiscount,delete t.tmpDisScore,delete t.tmpDiscount,delete t.discountedFrom,delete t.dupTextA,delete t.dupTextB,delete t.discountTextA,delete t.discountTextB,delete t.notStackableDiscount}for(let e=0;e<i.addons.length;e++){i.addons[e].parentId=i.id}if(!e.dRowAddSufReq){for(let e=0;e<i.requireds.length;e++){const t=i.requireds[e];if("id"===t.type){const e=t.reqId.split("/ON#"),o="".concat(e[0].split("/D#")[0]).concat(l);e.length>1?t.reqId="".concat(o,"/ON#").concat(e[1]):t.reqId=o}else if("or"===t.type)for(let e=0;e<t.orRequired.length;e++){const o=t.orRequired[e];if(void 0!==o.req){const e=o.req.split("/ON#"),t="".concat(e[0].split("/D#")[0]).concat(l);e.length>1?o.req="".concat(t,"/ON#").concat(e[1]):o.req=t}}if(void 0!==t.requireds)for(let o=0;o<t.requireds.length;o++){const t=i.requireds[e];if("id"===t.type){const e=t.reqId.split("/ON#"),o="".concat(e[0].split("/D#")[0]).concat(l);e.length>1?t.reqId="".concat(o,"/ON#").concat(e[1]):t.reqId=o}else if("or"===t.type)for(let e=0;e<t.orRequired.length;e++){const o=t.orRequired[e];if(void 0!==o.req){const e=o.req.split("/ON#"),t="".concat(e[0].split("/D#")[0]).concat(l);e.length>1?o.req="".concat(t,"/ON#").concat(e[1]):o.req=t}}}}for(let e=0;e<i.scores.length;e++){const t=i.scores[e];if(void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("id"===o.type){const e=o.reqId.split("/ON#"),t="".concat(e[0].split("/D#")[0]).concat(l);e.length>1?o.reqId="".concat(t,"/ON#").concat(e[1]):o.reqId=t}else if("or"===o.type)for(let e=0;e<o.orRequired.length;e++){const t=o.orRequired[e];if(void 0!==t.req){const e=t.req.split("/ON#"),o="".concat(e[0].split("/D#")[0]).concat(l);e.length>1?t.req="".concat(o,"/ON#").concat(e[1]):t.req=o}}}}for(let e=0;e<i.addons.length;e++){const t=i.addons[e];if(void 0!==t.requireds)for(let e=0;e<t.requireds.length;e++){const o=t.requireds[e];if("id"===o.type){const e=o.reqId.split("/ON#"),t="".concat(e[0].split("/D#")[0]).concat(l);e.length>1?o.reqId="".concat(t,"/ON#").concat(e[1]):o.reqId=t}else if("or"===o.type)for(let e=0;e<o.orRequired.length;e++){const t=o.orRequired[e];if(void 0!==t.req){const e=t.req.split("/ON#"),o="".concat(e[0].split("/D#")[0]).concat(l);e.length>1?t.req="".concat(o,"/ON#").concat(e[1]):t.req=o}}}}}if(!e.dRowAddSufFunc){if(i.activateOtherChoice&&void 0!==i.activateThisChoice){const e=i.activateThisChoice.split(",");let t="";for(let o=0;o<e.length;o++){const i=e[o].split("/ON#"),n="".concat(i[0].split("/D#")[0]).concat(l);i.length>1?t+="".concat(n,"/ON#").concat(i[1],","):t+="".concat(n,",")}i.activateThisChoice=t}if(i.deactivateOtherChoice&&void 0!==i.deactivateThisChoice){const e=i.deactivateThisChoice.split(",");let t="";for(let o=0;o<e.length;o++){const i=e[o].split("/ON#"),n="".concat(i[0].split("/D#")[0]).concat(l);i.length>1?t+="".concat(n,"/ON#").concat(i[1],","):t+="".concat(n,",")}i.deactivateThisChoice=t}if(i.duplicateRow&&void 0!==i.duplicateRowId&&void 0!==i.duplicateRowPlace){const e=i.duplicateRowId,t=i.duplicateRowPlace;i.duplicateRowId="".concat(e.split("/D")[0]).concat(l),i.duplicateRowPlace="".concat(t.split("/D")[0]).concat(l)}}if(i.backpackBtnRequirement&&(void 0!==app.hideBackpackBtn?app.hideBackpackBtn+=1:delete i.backpackBtnRequirement),n.isBackpack?At.set(i.id,{choice:app.backpack[n.index+1].objects[o],row:app.backpack[n.index+1]}):At.set(i.id,{choice:app.rows[n.index+1].objects[o],row:app.rows[n.index+1]}),i.groups)for(let e=0;e<i.groups.length;e++){let t=Ot.get(i.groups[e]);if(void 0!==t){-1===t.elements.indexOf(i.id)&&t.elements.push(i.id)}}if(i.objectDesignGroups)for(let e=0;e<i.objectDesignGroups.length;e++){let t=Dt.get(i.objectDesignGroups[e]);if(void 0!==t){-1===t.elements.indexOf(i.id)&&t.elements.push(i.id)}}}}}}function Wo(e){return/^data:[a-zA-Z]+\/[a-zA-Z]+;base64,/.test(e)}function Eo(e){const t=e.match(/^data:(image\/[a-zA-Z0-9.+-]+);base64,/);if(!t)return!1;return"image/avif"===t[1].toLowerCase()}const Uo=a({selFilterBlur:r.number().optional(),selFilterBright:r.number().optional(),selFilterCont:r.number().optional(),selFilterGray:r.number().optional(),selFilterHue:r.number().optional(),selFilterInvert:r.number().optional(),selFilterOpac:r.number().optional(),selFilterSatur:r.number().optional(),selFilterSepia:r.number().optional(),reqFilterBlur:r.number().optional(),reqFilterBright:r.number().optional(),reqFilterCont:r.number().optional(),reqFilterGray:r.number().optional(),reqFilterHue:r.number().optional(),reqFilterInvert:r.number().optional(),reqFilterOpac:r.number().optional(),reqFilterSatur:r.number().optional(),reqFilterSepia:r.number().optional(),unselFilterBlur:r.number().optional(),unselFilterBright:r.number().optional(),unselFilterCont:r.number().optional(),unselFilterGray:r.number().optional(),unselFilterHue:r.number().optional(),unselFilterInvert:r.number().optional(),unselFilterOpac:r.number().optional(),unselFilterSatur:r.number().optional(),unselFilterSepia:r.number().optional()}).passthrough(),zo=a({rowTitleTextSize:r.number().optional(),rowTextTextSize:r.number().optional(),objectTitleTextSize:r.number().optional(),objectTextTextSize:r.number().optional(),addonTitleTextSize:r.number().optional(),addonTextTextSize:r.number().optional(),scoreTextSize:r.number().optional()}).passthrough(),Go=a({objectImgBorderWidth:r.number().optional(),objectImageWidth:r.number().optional(),objectImageMarginTop:r.number().optional(),objectImageMarginBottom:r.number().optional(),objectImgBorderRadiusTopLeft:r.number().optional(),objectImgBorderRadiusTopRight:r.number().optional(),objectImgBorderRadiusBottomRight:r.number().optional(),objectImgBorderRadiusBottomLeft:r.number().optional(),objectImageBoxWidth:r.number().optional()}).passthrough(),Ho=a({rowImgBorderWidth:r.number().optional(),rowImageWidth:r.number().optional(),rowImageMarginTop:r.number().optional(),rowImageMarginBottom:r.number().optional(),rowImgBorderRadiusTopLeft:r.number().optional(),rowImgBorderRadiusTopRight:r.number().optional(),rowImgBorderRadiusBottomRight:r.number().optional(),rowImgBorderRadiusBottomLeft:r.number().optional(),rowImageBoxWidth:r.number().optional()}).passthrough(),_o=a({addonImgBorderWidth:r.number().optional(),addonImageWidth:r.number().optional(),addonImageMarginTop:r.number().optional(),addonImageMarginBottom:r.number().optional(),addonImgBorderRadiusTopLeft:r.number().optional(),addonImgBorderRadiusTopRight:r.number().optional(),addonImgBorderRadiusBottomRight:r.number().optional(),addonImgBorderRadiusBottomLeft:r.number().optional(),addonImageBoxWidth:r.number().optional()}).passthrough(),Yo=a({objectMargin:r.number().optional(),objectTextPadding:r.number().optional(),objectBorderWidth:r.number().optional(),objectDropShadowH:r.number().optional(),objectDropShadowV:r.number().optional(),objectDropShadowBlur:r.number().optional(),objectDropShadowSpread:r.number().optional(),objectBorderRadiusTopLeft:r.number().optional(),objectBorderRadiusTopRight:r.number().optional(),objectBorderRadiusBottomRight:r.number().optional(),objectBorderRadiusBottomLeft:r.number().optional(),objectBorderImageWidth:r.number().optional(),objectBorderImageSliceTop:r.number().optional(),objectBorderImageSliceBottom:r.number().optional(),objectBorderImageSliceLeft:r.number().optional(),objectBorderImageSliceRight:r.number().optional()}).passthrough(),Zo=a({rowMargin:r.number().optional(),rowBodyMarginSides:r.number().optional(),rowBodyMarginTop:r.number().optional(),rowBodyMarginBottom:r.number().optional(),rowTextPaddingY:r.number().optional(),rowTextPaddingX:r.number().optional(),rowDropShadowH:r.number().optional(),rowDropShadowV:r.number().optional(),rowDropShadowBlur:r.number().optional(),rowDropShadowSpread:r.number().optional(),rowButtonXPadding:r.number().optional(),rowButtonYPadding:r.number().optional(),rowBorderRadiusTopLeft:r.number().optional(),rowBorderRadiusTopRight:r.number().optional(),rowBorderRadiusBottomRight:r.number().optional(),rowBorderRadiusBottomLeft:r.number().optional(),rowBorderWidth:r.number().optional(),rowBorderImageWidth:r.number().optional(),rowBorderImageSliceTop:r.number().optional(),rowBorderImageSliceBottom:r.number().optional(),rowBorderImageSliceLeft:r.number().optional(),rowBorderImageSliceRight:r.number().optional()}).passthrough(),Jo=a({addonMargin:r.number().optional(),addonTextPadding:r.number().optional(),addonBorderWidth:r.number().optional(),addonDropShadowH:r.number().optional(),addonDropShadowV:r.number().optional(),addonDropShadowBlur:r.number().optional(),addonDropShadowSpread:r.number().optional(),addonBorderRadiusTopLeft:r.number().optional(),addonBorderRadiusTopRight:r.number().optional(),addonBorderRadiusBottomRight:r.number().optional(),addonBorderRadiusBottomLeft:r.number().optional(),addonBorderImageWidth:r.number().optional(),addonBorderImageSliceTop:r.number().optional(),addonBorderImageSliceBottom:r.number().optional(),addonBorderImageSliceLeft:r.number().optional(),addonBorderImageSliceRight:r.number().optional()}).passthrough(),Xo=a({multiChoiceCounterPosition:r.number().optional(),multiChoiceCounterSize:r.number().optional(),multiChoiceTextSize:r.number().optional()}).passthrough(),Ko=a({barTextPadding:r.number().optional(),barTextMargin:r.number().optional(),barPadding:r.number().optional(),barMargin:r.number().optional(),barTextSize:r.number().optional()}).passthrough(),Qo=a({backPackWidth:r.number().optional()}).passthrough(),ei=s(e=>""===e?{}:e,Uo.merge(zo).merge(Go).merge(Ho).merge(_o).merge(Yo).merge(Zo).merge(Jo).merge(Xo).merge(Ko).merge(Qo).passthrough()),ti=a({template:r.number().optional()}).passthrough(),oi=a({value:r.number().optional(),minValue:r.number().optional(),maxValue:r.number().optional(),discountScore:r.number().optional(),discountScoreCal:r.number().optional(),tmpDisScore:r.number().optional()}).passthrough(),ii=a({index:r.number().optional(),template:r.number().optional(),multipleUseVariable:r.number().optional(),initMultipleTimesMinus:r.number().optional(),selectedThisManyTimesProp:r.number().optional(),defaultAspectWidth:r.number().optional(),defaultAspectHeight:r.number().optional(),addons:c(ti).optional(),scores:c(oi).optional(),styling:ei.optional(),numMultipleTimesMinus:r.number().optional(),numMultipleTimesPluss:r.number().optional(),numActivateRandom:r.number().optional(),discountLowLimit:r.number().optional(),discountValue:r.number().optional(),numbAddToAllowChoice:r.number().optional(),bgmFadeInSec:r.number().optional(),bgmFadeOutSec:r.number().optional(),fadeTransitionTime:r.number().optional(),divideWithThis:r.number().optional(),activatedFrom:r.number().optional()}).passthrough(),ni=a({index:r.number().optional(),template:r.number().optional(),buttonRandomNumber:r.number().optional(),defaultAspectWidth:r.number().optional(),defaultAspectHeight:r.number().optional(),allowedChoices:r.number().optional(),currentChoices:r.number().optional(),objects:c(ii).optional(),styling:ei.optional(),objectImgObjectFillHeight:r.number().optional(),randomMin:r.number().optional(),randomMax:r.number().optional()}).passthrough(),li=a({startingSum:r.number().optional(),initValue:r.number().optional(),iconWidth:r.number().optional(),iconHeight:r.number().optional(),negativeIconWidth:r.number().optional(),negativeIconHeight:r.number().optional()}).passthrough(),ai=a({styling:ei.optional()}).passthrough(),ri=a({styling:ei.optional()}).passthrough(),si=a({curVolume:r.number().optional(),fadeTransitionTime:r.number().optional(),hideBackpackBtn:r.number().optional(),btnBackpackIsOn:r.number().optional(),rowIdLength:r.number().optional(),objectIdLength:r.number().optional(),rowDesignGroups:c(ai).optional(),objectDesignGroups:c(ri).optional(),rows:c(ni).optional(),pointTypes:c(li).optional(),backpack:c(ni).optional(),styling:ei.optional()}).passthrough(),ci=["autoSaveInterval","bgmFadeInterval","bgmFadeTimer","bgmIsPlaying","bgmObjectId","bgmPlayInterval","bgmTitle","bgmTitleInterval","cancelForcedActivated","comp","compG","compODG","compR","compRDG","curBgmTime","curBgmLength","isSeeking","isFadingOut","lastFadeTime","objectMap","pointTypeMap","wordMap"];function di(e){if(Array.isArray(e))return e.map(di).filter(e=>null!==e&&!("object"==typeof e&&0===Object.keys(e).length));if(e&&"object"==typeof e){const t={},o=Object.keys(e);for(let i=0;i<o.length;i++){const n=o[i],l=di(e[n]);null!==l&&(t[n]=l)}return Object.keys(t).length>0?t:null}return e}function ui(e){e.isPrivateStyling&&e.privateFilterIsOn&&void 0!==e.styling&&(void 0===e.styling.unselFilterBlurIsOn&&(e.styling.unselFilterBlurIsOn=!1),void 0===e.styling.unselFilterBlur&&(e.styling.unselFilterBlur=0),void 0===e.styling.unselFilterBrightIsOn&&(e.styling.unselFilterBrightIsOn=!1),void 0===e.styling.unselFilterBright&&(e.styling.unselFilterBright=100),void 0===e.styling.unselFilterCont&&(e.styling.unselFilterCont=100),void 0===e.styling.unselFilterGrayIsOn&&(e.styling.unselFilterGrayIsOn=!1),void 0===e.styling.unselFilterGray&&(e.styling.unselFilterGray=0),void 0===e.styling.unselFilterHueIsOn&&(e.styling.unselFilterHueIsOn=!1),void 0===e.styling.unselFilterHue&&(e.styling.unselFilterHue=0),void 0===e.styling.unselFilterInvertIsOn&&(e.styling.unselFilterInvertIsOn=!1),void 0===e.styling.unselFilterInvert&&(e.styling.unselFilterInvert=0),void 0===e.styling.unselFilterOpacIsOn&&(e.styling.unselFilterOpacIsOn=!1),void 0===e.styling.unselFilterOpac&&(e.styling.unselFilterOpac=100),void 0===e.styling.unselFilterSaturIsOn&&(e.styling.unselFilterSaturIsOn=!1),void 0===e.styling.unselFilterSatur&&(e.styling.unselFilterSatur=0),void 0===e.styling.unselFilterSepiaIsOn&&(e.styling.unselFilterSepiaIsOn=!1),void 0===e.styling.unselFilterSepia&&(e.styling.unselFilterSepia=0))}function gi(e,t){e.isPrivateStyling&&void 0===e.privateFilterIsOn&&void 0!==e.styling&&Object.keys(dt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateFilterIsOn=!0:e.privateFilterIsOn=!1}),e.isPrivateStyling&&void 0===e.privateTextIsOn&&void 0!==e.styling&&Object.keys(ut).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateTextIsOn=!0:e.privateTextIsOn=!1}),e.isPrivateStyling&&void 0===e.privateObjectImageIsOn&&void 0!==e.styling&&Object.keys(gt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateObjectImageIsOn=!0:e.privateObjectImageIsOn=!1}),e.isPrivateStyling&&void 0===e.privateObjectIsOn&&void 0!==e.styling&&Object.keys(vt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateObjectIsOn=!0:e.privateObjectIsOn=!1}),e.isPrivateStyling&&void 0===e.privateAddonImageIsOn&&void 0!==e.styling&&Object.keys(ht).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateAddonImageIsOn=!0:e.privateAddonImageIsOn=!1}),e.isPrivateStyling&&void 0===e.privateAddonIsOn&&void 0!==e.styling&&Object.keys(bt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateAddonIsOn=!0:e.privateAddonIsOn=!1}),e.isPrivateStyling&&void 0===e.privateBackgroundIsOn&&void 0!==e.styling&&Object.keys(pt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateBackgroundIsOn=!0:e.privateBackgroundIsOn=!1}),t&&(e.isPrivateStyling&&void 0===e.privateRowImageIsOn&&void 0!==e.styling&&Object.keys(mt).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateRowImageIsOn=!0:e.privateRowImageIsOn=!1}),e.isPrivateStyling&&void 0===e.privateRowIsOn&&void 0!==e.styling&&Object.keys(ft).forEach(t=>{e.styling.hasOwnProperty(t)?e.privateRowIsOn=!0:e.privateRowIsOn=!1})),ui(e),e.isPrivateStyling||void 0===e.styling||(void 0!==e.styling.objectImgObjectFillHeight&&(e.objectImgObjectFillHeight=e.styling.objectImgObjectFillHeight),delete e.styling)}function mi(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const o=t[n];if(-1!==ci.indexOf(o))delete e[o];else if(Array.isArray(e[o])){if("rows"===o||"backpack"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];if(i.index=t,"backpack"===o&&(i.isBackpack=!0),gi(i,!0),void 0!==i.styling&&Ao(i.styling,void 0===e.version||"2.0.0-beta"===e.version),void 0!==i.rowDesignGroups)for(let e=0;e<i.rowDesignGroups.length;e++)"object"==typeof i.rowDesignGroups[e]&&(i.rowDesignGroups[e]=i.rowDesignGroups[e].id);if(i.image,Wo(i.image)?_t.value||(_t.value=Eo(i.image)):Ht.add(i.image),void 0!==i.groups)for(let e=i.groups.length-1;e>=0;e--)Ot.has(i.groups[e])||i.groups.splice(e,1);if(void 0!==i.objects)for(let t=0;t<i.objects.length;t++){const o=i.objects[t];if(o.index=t,gi(o,!1),void 0!==o.styling&&Ao(o.styling,void 0===e.version||"2.0.0-beta"===e.version),o.multiplyPointtypeIsOn&&("string"==typeof o.pointTypeToMultiply&&(o.pointTypeToMultiply=[o.pointTypeToMultiply]),"number"==typeof o.startingSumAtMultiply&&(o.startingSumAtMultiply=[o.startingSumAtMultiply])),o.dividePointtypeIsOn&&("string"==typeof o.pointTypeToDivide&&(o.pointTypeToDivide=[o.pointTypeToDivide]),"number"==typeof o.startingSumAtDivide&&(o.startingSumAtDivide=[o.startingSumAtDivide])),o.fadeTransitionIsOn&&void 0!==o.fadeTransitionTime&&(o.fadeInTransitionTime=o.fadeTransitionTime,o.fadeOutTransitionTime=o.fadeTransitionTime,delete o.fadeTransitionTime),o.addToAllowChoice&&"string"==typeof o.idOfAllowChoice&&(o.idOfAllowChoice=[o.idOfAllowChoice]),void 0!==o.groups)for(let e=0;e<o.groups.length;e++)"object"==typeof o.groups[e]&&(o.groups[e]=o.groups[e].id);if(void 0!==o.objectDesignGroups)for(let e=0;e<o.objectDesignGroups.length;e++)"object"==typeof o.objectDesignGroups[e]&&(o.objectDesignGroups[e]=o.objectDesignGroups[e].id);o.image,Wo(o.image)?_t.value||(_t.value=Eo(o.image)):Ht.add(o.image);for(let e=0;e<o.addons.length;e++){const t=o.addons[e];void 0!==t.template&&0!==t.template||(t.template=1),t.parentId=o.id,t.image,Wo(t.image)?_t.value||(_t.value=Eo(t.image)):Ht.add(t.image)}}}else if("objectDesignGroups"===o||"rowDesignGroups"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];void 0===i.activatedId&&(i.activatedId=""),void 0===i.elements&&(i.elements=[]),void 0===i.backpackElements&&(i.backpackElements=[]);for(let e=0;e<i.elements.length;e++)"object"==typeof i.elements[e]&&(i.elements[e]=i.elements[e].id);for(let e=0;e<i.backpackElements.length;e++)"object"==typeof i.backpackElements[e]&&(i.backpackElements[e]=i.backpackElements[e].id);ui(i),Ao(i.styling,void 0===e.version||"2.0.0-beta"===e.version)}else if("pointTypes"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];void 0===i.initValue&&(i.initValue=i.startingSum),"object"==typeof i.positiveColor&&void 0!==i.positiveColor.hexa&&(i.positiveColor=i.positiveColor.hexa),"object"==typeof i.negativeColor&&void 0!==i.negativeColor.hexa&&(i.negativeColor=i.negativeColor.hexa),"object"==typeof i.privateColor&&void 0!==i.privateColor.hexa&&(i.privateColor=i.privateColor.hexa),"object"==typeof i.privateNegativeColor&&void 0!==i.privateNegativeColor.hexa&&(i.privateNegativeColor=i.privateNegativeColor.hexa)}else if("groups"===o)for(let t=0;t<e[o].length;t++){const i=e[o][t];void 0===i.elements&&(i.elements=[]),void 0===i.rowElements&&(i.rowElements=[]);for(let e=0;e<i.elements.length;e++)"object"==typeof i.elements[e]&&(i.elements[e]=i.elements[e].id);for(let e=0;e<i.rowElements.length;e++)"object"==typeof i.rowElements[e]&&(i.rowElements[e]=i.rowElements[e].id)}}else"object"==typeof e[o]&&"styling"===o&&Ao(e[o],void 0===e.version||"2.0.0-beta"===e.version,!0)}St.clear(),xt.clear(),Bt.clear(),At.clear(),Ot.clear(),kt.clear(),Mt.clear(),Ft.clear(),Rt.clear(),Dt.clear(),Pt.splice(0);const o=Object.keys(yt);for(let n=0;n<o.length;n++){const e=o[n];yt.hasOwnProperty(e)?app[e]=yt[e]:delete app[e]}const i=Object.keys(e);for(let n=0;n<i.length;n++){const t=i[n];app[t]=e[t]}for(let n=0;n<app.googleFonts.length;n++){const e=app.googleFonts[n].replace(/ /g,"+"),t="https://fonts.googleapis.com/css2?family=".concat(e,"&display=swap"),o=document.createElement("link");o.id=e,o.rel="stylesheet",o.href=t,o.crossOrigin="anonymous",document.head.appendChild(o)}for(let n=0;n<app.customFonts.length;n++){const e=app.customFonts[n],t=document.createElement("link");t.id=e,t.rel="stylesheet",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}for(let n=0;n<app.pointTypes.length;n++){const e=app.pointTypes[n];void 0!==e.id&&""!==e.id||(e.id=uo(0,4)),e.id=wo(e.id,xt),void 0===e.initValue&&(e.initValue=e.startingSum),void 0===e.isNotShownObjects&&""!==e.activatedId&&(e.isNotShownObjects=!0),void 0===e.isNotShownPointBar&&""!==e.activatedId&&(e.isNotShownPointBar=!0),xt.set(e.id,e)}for(let n=0;n<app.rows.length;n++){const e=app.rows[n];void 0!==e.id&&""!==e.id||(e.id=lo(0,4)),e.id=wo(e.id,Bt),Bt.set(e.id,e);for(let t=0;t<e.objects.length;t++){const o=e.objects[t];void 0!==o.id&&""!==o.id||(o.id=ro(0,4)),o.id=wo(o.id,At),At.set(o.id,{choice:o,row:e});for(let e=0;e<o.scores.length;e++){const t=o.scores[e];void 0!==t.idx&&""!==t.idx||(t.idx=mo(0,5)),t.idx=wo(t.idx,jt),jt.add(t.idx)}}}for(let n=0;n<app.backpack.length;n++){const e=app.backpack[n];void 0!==e.id&&""!==e.id||(e.id=lo(0,4)),e.id=wo(e.id,Bt),Bt.set(e.id,e);for(let t=0;t<e.objects.length;t++){const o=e.objects[t];void 0!==o.id&&""!==o.id||(o.id=ro(0,4)),o.id=wo(o.id,At),At.set(o.id,{choice:o,row:e});for(let e=0;e<o.scores.length;e++){const t=o.scores[e];void 0!==t.idx&&""!==t.idx||(t.idx=mo(0,5)),t.idx=wo(t.idx,jt),jt.add(t.idx)}}}for(let n=0;n<app.groups.length;n++){const e=app.groups[n];void 0!==e.id&&""!==e.id||(e.id=co(0,4)),e.id=wo(e.id,Ot),Ot.set(e.id,app.groups[n]);for(let t=e.elements.length-1;t>=0;t--)At.has(e.elements[t])||e.elements.splice(t,1);for(let t=e.rowElements.length-1;t>=0;t--)Bt.has(e.rowElements[t])||e.rowElements.splice(t,1)}for(let n=0;n<app.words.length;n++){const e=app.words[n];void 0!==e.id&&""!==e.id||(e.id=ao(0,4)),e.id=wo(e.id,Mt),Mt.set(e.id,app.words[n])}for(let n=0;n<app.variables.length;n++){const e=app.variables[n];void 0!==e.id&&""!==e.id||(e.id=go(0,4)),e.id=wo(e.id,Ft),Ft.set(e.id,app.variables[n])}if(void 0!==app.rowDesignGroups)for(let n=0;n<app.rowDesignGroups.length;n++){const e=app.rowDesignGroups[n];void 0!==e.id&&""!==e.id||(e.id=so(0,4)),e.id=wo(e.id,Rt),Rt.set(e.id,e)}if(void 0!==app.objectDesignGroups)for(let n=0;n<app.objectDesignGroups.length;n++){const e=app.objectDesignGroups[n];void 0!==e.id&&""!==e.id||(e.id=so(0,4)),e.id=wo(e.id,Dt),Dt.set(app.objectDesignGroups[n].id,app.objectDesignGroups[n])}if(void 0!==app.globalRequirements)for(let n=0;n<app.globalRequirements.length;n++){const e=app.globalRequirements[n];kt.set(e.id,e)}app.activated.length>0&&Lo(app.activated.join(",")),void 0!==app.customCSS&&function(e){let t=document.getElementById("customCSS");t?""===e?(t.remove(),delete app.customCSS):(t.textContent=e,app.customCSS=e):(t=document.createElement("style"),t.id="customCSS",t.textContent=e,app.customCSS=e,document.head.appendChild(t))}(app.customCSS),app.buildAutoSaveIsOn&&(Kt&&Kt.abort(),eo()),"boolean"!=typeof app.isMute&&(app.curVolume=100,app.isMute=!1)}async function hi(e){const t=e.querySelectorAll("img"),o=Array.from(t).map(e=>e.complete?Promise.resolve():new Promise(t=>{e.onload=t,e.onerror=t}));return Promise.all(o).then(()=>{})}function pi(e){e.querySelectorAll("img").forEach(e=>{"lazy"===e.loading&&(e.loading="eager")})}async function vi(e){const t=e.querySelectorAll("*"),o=[];t.forEach(e=>{const t=getComputedStyle(e).borderImageSource.match(/url\(["']?(.*?)["']?\)/);t&&t[1]&&o.push(t[1])});const i=o.map(e=>new Promise(t=>{const o=new Image;o.src=e,o.onload=t,o.onerror=t}));await Promise.all(i)}function fi(e=2){return new Promise(t=>{let o=0;requestAnimationFrame(function i(){if(++o>=e)return t();requestAnimationFrame(i)})})}function bi(e,t,o){void 0===e.templateStack&&(e.templateStack=[],e.defaultTemplate=void 0!==e.template?e.template:1),e.templateStack.push({id:t,data:o}),e.template=o}function wi(e,t){if(void 0!==e.templateStack){const o=e.templateStack.findIndex(e=>e.id===t);-1!==o&&e.templateStack.splice(o,1);const i=e.templateStack.length;i>0?e.template=e.templateStack[i-1].data:(e.template=void 0!==e.defaultTemplate?e.defaultTemplate:1,delete e.templateStack)}}function Ti(e,t,o){void 0===e.widthStack&&(e.widthStack=[],e.defaultWidth=void 0!==e.width?e.width:"col-md-3"),e.widthStack.push({id:t,data:o}),e.width=o}function Ii(e,t){if(void 0!==e.widthStack){const o=e.widthStack.findIndex(e=>e.id===t);-1!==o&&e.widthStack.splice(o,1);const i=e.widthStack.length;i>0?e.width=e.widthStack[i-1].data:(e.width=void 0!==e.defaultWidth?e.defaultWidth:"col-md-3",delete e.widthStack)}}const yi=CSS.supports("color","#00000080");function Si(e){if(void 0===e)return"";if(yi||!/^#([\da-f]{8})$/i.test(e))return e;const t=parseInt(e.slice(1,3),16),o=parseInt(e.slice(3,5),16),i=parseInt(e.slice(5,7),16),n=parseInt(e.slice(7,9),16)/255;return"rgba(".concat(t,", ").concat(o,", ").concat(i,", ").concat(n.toFixed(3),")")}const Ci=i({anchor:null,text:"",isVisible:!0});let xi=0;function Bi(e,t){let o="string"==typeof t?t:t.text;function i(){let i="string"==typeof t?void 0!==app.tooltipDelay?app.tooltipDelay:1e3:t.delay;0!==xi&&(clearTimeout(xi),xi=0),i>0?xi=window.setTimeout(()=>{Ci.anchor=e,Ci.text=o,Ci.isVisible=!0},i):(Ci.anchor=e,Ci.text=o,Ci.isVisible=!0)}function n(){0!==xi&&(clearTimeout(xi),xi=0),Ci.isVisible=!1}return e.addEventListener("mouseenter",i),e.addEventListener("mouseleave",n),e.addEventListener("focusin",i),e.addEventListener("focusout",n),{destroy(){e.removeEventListener("mouseenter",i),e.removeEventListener("mouseleave",n),e.removeEventListener("focusin",i),e.removeEventListener("focusout",n)}}}var Ai=f('<div class="mdc-tooltip" role="tooltip" style="z-index: 9999;"><div class="mdc-tooltip__surface"><!></div></div>');var Oi=f("<div><!></div>");const ki=function(e,t){let o=A(t,"text",3,""),i=A(t,"innerClass",3,"");var n=Oi(),l=B(n);O(l,()=>{var e;return null!=(e=t.children)?e:k}),M(n,(e,t)=>null==Bi?void 0:Bi(e,t),()=>({text:o(),delay:0})),F(()=>R(n,1,D(i()))),T(e,n)};var Mi=f("<input/>");function Fi(e,t){h(t,!0);let o,n=A(t,"use",19,()=>[]),l=A(t,"class",3,""),a=A(t,"type",3,"text"),r=A(t,"placeholder",3," "),s=A(t,"value",15),c=A(t,"files",15,null),d=A(t,"dirty",15,!1),u=A(t,"invalid",15,!1),g=A(t,"updateInvalid",3,!0),m=A(t,"initialInvalid",3,!1),v=A(t,"emptyValueNull",19,()=>null===s()),f=A(t,"emptyValueUndefined",19,()=>void 0===s()),b=A(t,"step",3,"any"),y=V(t,["$$slots","$$events","$$legacy","use","class","type","placeholder","value","files","dirty","invalid","updateInvalid","initialInvalid","emptyValueNull","emptyValueUndefined","step"]),S=i({}),C=i({});function x(e){return""===e?Number.NaN:+e}function B(e){if("file"!==a())if(""===e.currentTarget.value&&v())s(null);else if(""===e.currentTarget.value&&f())s(void 0);else switch(a()){case"number":s(x(e.currentTarget.value)),""!==e.currentTarget.value&&"0"!==e.currentTarget.value||("-"===e.data?(s("-0"),e.target.value="-0"):"deleteContentBackward"===e.inputType||"insertFromPaste"!==e.inputType||isNaN(parseInt(e.data))?(s("0"),e.target.value="0"):(s(parseFloat(e.data)),e.target.value=parseFloat(e.data)));break;case"range":s(x(e.currentTarget.value));break;default:s(e.currentTarget.value)}else c(e.currentTarget.files)}function O(){return o}p(()=>{"file"===a()?delete C.value:C.value=null==s()?"":s()}),L(()=>{g()&&m()&&u(O().matches(":invalid"))});var k=Mi(),F=e=>{var o;"file"!==a()&&B(e),null==(o=t.oninput)||o.call(t,e)},R=e=>{var o;!function(e){"file"!==a()&&"range"!==a()||B(e),d(!0),g()&&u(O().matches(":invalid"))}(e),null==(o=t.onchange)||o.call(t,e)};return N(k,e=>({class:e,type:a(),placeholder:r(),...C,...S,step:b(),...y,oninput:F,onchange:R}),[()=>W({[l()]:!0,"mdc-text-field__input":!0})]),w(k,e=>o=e,()=>o),M(k,(e,t)=>{var o;return null==(o=E)?void 0:o(e,t)},n),T(e,k),I({getAttr:function(e){return e in S?void 0!==S[e]?S[e]:null:O().getAttribute(e)},addAttr:function(e,t){S[e]!==t&&(S[e]=t)},removeAttr:function(e){e in S&&null==S[e]||(S[e]=void 0)},focus:function(){O().focus()},blur:function(){O().blur()},getElement:O})}var Ri=f("<textarea></textarea>");function Di(e,t){h(t,!0);let o,n=A(t,"use",19,()=>[]),l=A(t,"class",3,""),a=A(t,"style",3,""),r=A(t,"value",15,""),s=A(t,"dirty",15,!1),c=A(t,"invalid",15,!1),d=A(t,"updateInvalid",3,!0),u=A(t,"initialInvalid",3,!1),g=A(t,"resizable",3,!0),m=V(t,["$$slots","$$events","$$legacy","use","class","style","value","dirty","invalid","updateInvalid","initialInvalid","resizable"]),p=i({});function v(){return o}L(()=>{d()&&u()&&c(v().matches(":invalid"))});var f=Ri(),b=e=>{var o;s(!0),d()&&c(v().matches(":invalid")),null==(o=t.onchange)||o.call(t,e)};return N(f,e=>({class:e,style:"".concat(g()?"":"resize: none; ").concat(a()),...p,...m,onchange:b}),[()=>W({[l()]:!0,"mdc-text-field__input":!0})]),w(f,e=>o=e,()=>o),M(f,(e,t)=>{var o;return null==(o=E)?void 0:o(e,t)},n),U(()=>z(f,r)),T(e,f),I({getAttr:function(e){return e in p?void 0!==p[e]?p[e]:null:v().getAttribute(e)},addAttr:function(e,t){p[e]!==t&&(p[e]=t)},removeAttr:function(e){e in p&&null==p[e]||(p[e]=void 0)},focus:function(){v().focus()},blur:function(){v().blur()},getElement:v})}var ji=f('<span class="mdc-text-field__ripple"></span>'),Pi=f("<!> <!>",1),$i=f("<span><!> <!></span>"),qi=f("<!> <!> <!>",1),Vi=f("<label><!> <!> <!> <!> <!> <!> <!></label>"),Li=f("<div><!> <!> <!> <!> <!></div>"),Ni=f("<!> <!>",1);function Wi(e,t){h(t,!0);const{applyPassive:o}=Z;let n=()=>{};function l(e){return e===n}let a=A(t,"use",19,()=>[]),r=A(t,"class",3,""),s=A(t,"style",3,""),c=A(t,"ripple",3,!0),d=A(t,"disabled",3,!1),u=A(t,"required",3,!1),g=A(t,"textarea",3,!1),m=A(t,"variant",19,()=>g()?"outlined":"standard"),f=A(t,"noLabel",3,!1),b=A(t,"type",3,"text"),C=A(t,"value",15),U=A(t,"files",15,n),z=A(t,"invalid",15,n),de=A(t,"updateInvalid",19,()=>l(z())),ue=A(t,"initialInvalid",3,!1),ge=A(t,"dirty",15,!1),me=A(t,"validateOnValueChange",19,de),he=A(t,"useNativeValidation",19,de),pe=A(t,"withLeadingIcon",3,n),ve=A(t,"withTrailingIcon",3,n),fe=A(t,"input",7),be=A(t,"floatingLabel",7),we=A(t,"lineRipple",7),Te=A(t,"notchedOutline",7),Ie=A(t,"alwaysFloat",3,!1),ye=V(t,["$$slots","$$events","$$legacy","use","class","style","ripple","disabled","required","textarea","variant","noLabel","label","type","value","files","invalid","updateInvalid","initialInvalid","dirty","prefix","suffix","validateOnValueChange","useNativeValidation","withLeadingIcon","withTrailingIcon","input","floatingLabel","lineRipple","notchedOutline","children","leadingIcon","trailingIcon","internalCounter","line","helper","alwaysFloat"]);const Se=void 0!==C()||void 0===C()&&t.input$emptyValueUndefined||!l(U());l(U())&&U(null),l(z())&&z(!1);let Ce,xe,Be,Ae,Oe,ke,Me=S(i(document.createElement("div"))),Fe=S(void 0),Re=new Y,De=i({}),je=i({}),Pe=S(void 0),$e=S(!1),qe=S(i(ue())),Ve=G("SMUI:addLayoutListener"),Le=new Promise(e=>xe=e);const Ne=te(()=>fe()&&fe().getElement());p(()=>{(ge()||y(qe)||!de())&&y(Fe)&&y(Fe).isValid()!==!z()&&(de()?z(!y(Fe).isValid()):y(Fe).setValid(!z()))}),p(()=>{y(Fe)&&y(Fe).getValidateOnValueChange()!==me()&&y(Fe).setValidateOnValueChange(!l(me())&&me())}),p(()=>{y(Fe)&&y(Fe).setUseNativeValidation(!!l(he())||he())}),p(()=>{y(Fe)&&y(Fe).setDisabled(d())});let We=C();function Ee(e){return e in De?void 0!==De[e]?De[e]:null:_e().classList.contains(e)}function Ue(e){De[e]||(De[e]=!0)}function ze(e){e in De&&!De[e]||(De[e]=!1)}function Ge(e,t){je[e]!=t&&(""===t||null==t?delete je[e]:je[e]=t)}function He(){if(y(Fe)){const e=y(Fe).shouldFloat;y(Fe).notchOutline(e)}}function _e(){return y(Me)}p(()=>{if(y(Fe)&&Se&&We!==C()){We=C();const e="".concat(null==C()?"":C());y(Fe).getValue()!==e&&y(Fe).setValue(e)}}),Ve&&(Ce=Ve(He)),H("SMUI:textfield:leading-icon:mount",e=>{Be=e}),H("SMUI:textfield:leading-icon:unmount",()=>{Be=void 0}),H("SMUI:textfield:trailing-icon:mount",e=>{Ae=e}),H("SMUI:textfield:trailing-icon:unmount",()=>{Ae=void 0}),H("SMUI:textfield:helper-text:id",e=>{x(Pe,e,!0)}),H("SMUI:textfield:helper-text:mount",e=>{Oe=e}),H("SMUI:textfield:helper-text:unmount",()=>{x(Pe,void 0),Oe=void 0}),H("SMUI:textfield:character-counter:mount",e=>{ke=e}),H("SMUI:textfield:character-counter:unmount",()=>{ke=void 0}),L(()=>{var e;if(x(Fe,new _({addClass:Ue,removeClass:ze,hasClass:Ee,registerTextFieldInteractionHandler:(e,t)=>Re.on(_e(),e,t),deregisterTextFieldInteractionHandler:(e,t)=>Re.off(_e(),e,t),registerValidationAttributeChangeHandler:e=>{const t=new MutationObserver(t=>{he()&&e((e=>e.map(e=>e.attributeName).filter(e=>e))(t))}),o={attributes:!0};return fe()&&t.observe(fe().getElement(),o),t},deregisterValidationAttributeChangeHandler:e=>{e.disconnect()},getNativeInput:()=>{var e;return void 0!==(null==(e=fe())?void 0:e.getElement())?fe().getElement():null},setInputAttr:(e,t)=>{var o;null==(o=fe())||o.addAttr(e,t)},removeInputAttr:e=>{var t;null==(t=fe())||t.removeAttr(e)},isFocused:()=>{var e;return document.activeElement===(null==(e=fe())?void 0:e.getElement())},registerInputInteractionHandler:(e,t)=>{var i;const n=null==(i=fe())?void 0:i.getElement();if(n){const i=o();Re.on(n,e,t,"boolean"==typeof i?{capture:i}:i)}},deregisterInputInteractionHandler:(e,t)=>{var o;const i=null==(o=fe())?void 0:o.getElement();i&&Re.off(i,e,t)},floatLabel:e=>be()&&be().float(e||Ie()),getLabelWidth:()=>be()?be().getWidth():0,hasLabel:()=>!!be(),shakeLabel:e=>be()&&be().shake(e),setLabelRequired:e=>be()&&be().setRequired(e),activateLineRipple:()=>we()&&we().activate(),deactivateLineRipple:()=>we()&&we().deactivate(),setLineRippleTransformOrigin:e=>we()&&we().setRippleCenter(e),closeOutline:()=>Te()&&Te().closeNotch(),hasOutline:()=>!!Te(),notchOutline:e=>Te()&&Te().notch(e)},{get helperText(){return Oe},get characterCounter(){return ke},get leadingIcon(){return Be},get trailingIcon(){return Ae}}),!0),Se){if(null==fe())throw new Error("SMUI Textfield must be initialized with either a non-undefined initial value or an Input component.");null==(e=y(Fe))||e.init()}else J().then(()=>{var e;if(null==fe())throw new Error("SMUI Textfield must be initialized with either a non-undefined initial value or an Input component.");null==(e=y(Fe))||e.init()});return xe(),()=>{var e;null==(e=y(Fe))||e.destroy(),Re.clear()}}),v(()=>{Ce&&Ce()});var Ye=Ni(),Ze=q(Ye),Je=e=>{var o=Vi();N(o,(e,t,o)=>({class:e,style:t,for:void 0,...o}),[()=>W({[r()]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":d(),"mdc-text-field--textarea":g(),"mdc-text-field--filled":"filled"===m(),"mdc-text-field--outlined":"outlined"===m(),"smui-text-field--standard":"standard"===m()&&!g(),"mdc-text-field--no-label":f()||null==t.label,"mdc-text-field--label-floating":y($e)||null!=C()&&""!==C(),"mdc-text-field--with-leading-icon":l(pe())?t.leadingIcon:pe(),"mdc-text-field--with-trailing-icon":l(ve())?t.trailingIcon:ve(),"mdc-text-field--with-internal-counter":g()&&t.internalCounter,"mdc-text-field--invalid":z(),...De}),()=>Object.entries(je).map(([e,t])=>"".concat(e,": ").concat(t,";")).concat([s()]).join(" "),()=>Q(ye,["input$","label$","ripple$","outline$","helperLine$"])]);var i=B(o),n=e=>{var o=Pi(),i=q(o),n=e=>{var t=ji();T(e,t)};X(i,e=>{"filled"===m()&&e(n)});var l=K(i,2),a=e=>{const o=te(()=>y($e)||Ie()||null!=C()&&""!==C()&&("number"!=typeof C()||!isNaN(C())));var i=te(()=>ie(ye,"label$"));w(le(e,P({get floatAbove(){return y(o)},get required(){return u()},wrapped:!0},()=>y(i),{children:(e,o)=>{var i=$(),n=q(i),l=e=>{},a=(e,o)=>{var i=e=>{var o=ae();F(()=>re(o,t.label)),T(e,o)},n=e=>{var o=$(),i=q(o);O(i,()=>t.label),T(e,o)};X(e,e=>{"string"==typeof t.label?e(i):e(n,!1)},o)};X(n,e=>{null==t.label?e(l):e(a,!1)}),T(e,i)},$$slots:{default:!0}})),e=>be(e),()=>be())};X(l,e=>{f()||null==t.label||e(a)}),T(e,o)};X(i,e=>{"outlined"!==m()&&e(n)});var p=K(i,2),v=e=>{const o=te(()=>f()||null==t.label);var i=te(()=>ie(ye,"outline$"));w(ne(e,P({get noLabel(){return y(o)}},()=>y(i),{children:(e,o)=>{var i=$(),n=q(i),l=e=>{const o=te(()=>y($e)||Ie()||null!=C()&&""!==C()&&("number"!=typeof C()||!isNaN(C())));var i=te(()=>ie(ye,"label$"));w(le(e,P({get floatAbove(){return y(o)},get required(){return u()},wrapped:!0},()=>y(i),{children:(e,o)=>{var i=$(),n=q(i),l=e=>{},a=(e,o)=>{var i=e=>{var o=ae();F(()=>re(o,t.label)),T(e,o)},n=e=>{var o=$(),i=q(o);O(i,()=>t.label),T(e,o)};X(e,e=>{"string"==typeof t.label?e(i):e(n,!1)},o)};X(n,e=>{null==t.label?e(l):e(a,!1)}),T(e,i)},$$slots:{default:!0}})),e=>be(e),()=>be())};X(n,e=>{f()||null==t.label||e(l)}),T(e,i)},$$slots:{default:!0}})),e=>Te(e),()=>Te())};X(p,e=>{"outlined"===m()&&e(v)});var S=K(p,2);ee(S,{key:"SMUI:textfield:icon:leading",value:!0,children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.leadingIcon)?e:k}),T(e,i)},$$slots:{default:!0}});var A=K(S,2);O(A,()=>{var e;return null!=(e=t.children)?e:k});var L=K(A,2),G=e=>{var o=$i(),i=B(o),n=te(()=>ie(ye,"input$"));w(Di(i,P({get disabled(){return d()},get required(){return u()},get updateInvalid(){return de()},get initialInvalid(){return y(qe)},get"aria-controls"(){return y(Pe)},get"aria-describedby"(){return y(Pe)}},()=>y(n),{onblur:e=>{var o;x($e,!1),x(qe,!0),se(_e(),"blur",e),null==(o=t.input$onblur)||o.call(t,e)},onfocus:e=>{var o;x($e,!0),se(_e(),"focus",e),null==(o=t.input$onfocus)||o.call(t,e)},get value(){return C()},set value(e){C(e)},get dirty(){return ge()},set dirty(e){ge(e)},get invalid(){return z()},set invalid(e){z(e)}})),e=>fe(e),()=>fe());var l=K(i,2);O(l,()=>{var e;return null!=(e=t.internalCounter)?e:k}),F(e=>R(o,1,e),[()=>D(W({"mdc-text-field__resizer":!("input$resizable"in ye)||t.input$resizable}))]),T(e,o)},H=e=>{var o=qi(),i=q(o),n=e=>{var o=$(),i=q(o),n=e=>{!function(e,t){h(t,!0);let o,i=V(t,["$$slots","$$events","$$legacy","children"]);w(j(e,P({_smuiClass:"mdc-text-field__affix mdc-text-field__affix--prefix",tag:"span"},()=>i,{children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.children)?e:k}),T(e,i)},$$slots:{default:!0}})),e=>o=e,()=>o),I({getElement:function(){return o.getElement()}})}(e,{children:(e,o)=>{var i=ae();F(()=>re(i,t.prefix)),T(e,i)},$$slots:{default:!0}})},l=e=>{var o=$(),i=q(o);O(i,()=>{var e;return null!=(e=t.prefix)?e:k}),T(e,o)};X(i,e=>{"string"==typeof t.prefix?e(n):e(l,!1)}),T(e,o)};X(i,e=>{null!=t.prefix&&e(n)});var l=K(i,2),a=te(()=>ie(ye,"input$"));w(Fi(l,P({get type(){return b()},get disabled(){return d()},get required(){return u()},get updateInvalid(){return de()},get initialInvalid(){return y(qe)},get"aria-controls"(){return y(Pe)},get"aria-describedby"(){return y(Pe)}},()=>f()&&null!=t.label&&"string"==typeof t.label?{placeholder:t.label}:{},()=>y(a),{onblur:e=>{var o;x($e,!1),x(qe,!0),se(_e(),"blur",e),null==(o=t.input$onblur)||o.call(t,e)},onfocus:e=>{var o;x($e,!0),se(_e(),"focus",e),null==(o=t.input$onfocus)||o.call(t,e)},get value(){return C()},set value(e){C(e)},get files(){return U()},set files(e){U(e)},get dirty(){return ge()},set dirty(e){ge(e)},get invalid(){return z()},set invalid(e){z(e)}})),e=>fe(e),()=>fe());var r=K(l,2),s=e=>{var o=$(),i=q(o),n=e=>{!function(e,t){h(t,!0);let o,i=V(t,["$$slots","$$events","$$legacy","children"]);w(j(e,P({_smuiClass:"mdc-text-field__affix mdc-text-field__affix--suffix",tag:"span"},()=>i,{children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.children)?e:k}),T(e,i)},$$slots:{default:!0}})),e=>o=e,()=>o),I({getElement:function(){return o.getElement()}})}(e,{children:(e,o)=>{var i=ae();F(()=>re(i,t.suffix)),T(e,i)},$$slots:{default:!0}})},l=e=>{var o=$(),i=q(o);O(i,()=>{var e;return null!=(e=t.suffix)?e:k}),T(e,o)};X(i,e=>{"string"==typeof t.suffix?e(n):e(l,!1)}),T(e,o)};X(r,e=>{null!=t.suffix&&e(s)}),T(e,o)};X(L,e=>{g()&&"string"==typeof C()?e(G):e(H,!1)});var _=K(L,2);ee(_,{key:"SMUI:textfield:icon:leading",value:!1,children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.trailingIcon)?e:k}),T(e,i)},$$slots:{default:!0}});var Y=K(_,2),Z=e=>{var t=te(()=>ie(ye,"ripple$"));w(ce(e,P(()=>y(t))),e=>we(e),()=>we())};X(Y,e=>{"outlined"!==m()&&c()&&e(Z)}),w(o,e=>x(Me,e),()=>y(Me)),M(o,(e,t)=>{var o;return null==(o=oe)?void 0:o(e,t)},()=>({ripple:"filled"===m(),unbounded:!1,addClass:Ue,removeClass:ze,addStyle:Ge,eventTarget:y(Ne),activeTarget:y(Ne),initPromise:Le})),M(o,(e,t)=>{var o;return null==(o=E)?void 0:o(e,t)},a),T(e,o)},Xe=e=>{var o=Li();N(o,(e,t,o)=>({class:e,style:t,...o}),[()=>W({[r()]:!0,"mdc-text-field":!0,"mdc-text-field--disabled":d(),"mdc-text-field--textarea":g(),"mdc-text-field--filled":"filled"===m(),"mdc-text-field--outlined":"outlined"===m(),"smui-text-field--standard":"standard"===m()&&!g(),"mdc-text-field--no-label":f()||null==t.label,"mdc-text-field--with-leading-icon":t.leadingIcon,"mdc-text-field--with-trailing-icon":t.trailingIcon,"mdc-text-field--invalid":z(),...De}),()=>Object.entries(je).map(([e,t])=>"".concat(e,": ").concat(t,";")).concat([s()]).join(" "),()=>Q(ye,["input$","label$","ripple$","outline$","helperLine$"])]);var i=B(o),n=e=>{var o=$(),i=q(o);O(i,()=>{var e;return null!=(e=t.label)?e:k}),T(e,o)};X(i,e=>{"string"!=typeof t.label&&e(n)});var l=K(i,2);ee(l,{key:"SMUI:textfield:icon:leading",value:!0,children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.leadingIcon)?e:k}),T(e,i)},$$slots:{default:!0}});var u=K(l,2);O(u,()=>{var e;return null!=(e=t.children)?e:k});var h=K(u,2);ee(h,{key:"SMUI:textfield:icon:leading",value:!1,children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.trailingIcon)?e:k}),T(e,i)},$$slots:{default:!0}});var p=K(h,2);O(p,()=>{var e;return null!=(e=t.line)?e:k}),w(o,e=>x(Me,e),()=>y(Me)),M(o,(e,t)=>{var o;return null==(o=oe)?void 0:o(e,t)},()=>({ripple:c(),unbounded:!1,addClass:Ue,removeClass:ze,addStyle:Ge})),M(o,(e,t)=>{var o;return null==(o=E)?void 0:o(e,t)},a),T(e,o)};X(Ze,e=>{Se?e(Je):e(Xe,!1)});var Ke=K(Ze,2),Qe=e=>{var o=te(()=>ie(ye,"helperLine$"));!function(e,t){h(t,!0);let o,i=V(t,["$$slots","$$events","$$legacy","children"]);w(j(e,P({_smuiClass:"mdc-text-field-helper-line",tag:"div"},()=>i,{children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.children)?e:k}),T(e,i)},$$slots:{default:!0}})),e=>o=e,()=>o),I({getElement:function(){return o.getElement()}})}(e,P(()=>y(o),{children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.helper)?e:k}),T(e,i)},$$slots:{default:!0}}))};return X(Ke,e=>{t.helper&&e(Qe)}),T(e,Ye),I({focus:function(){var e;null==(e=fe())||e.focus()},blur:function(){var e;null==(e=fe())||e.blur()},layout:He,getElement:_e})}var Ei=f('<div class="col-12"><!></div>'),Ui=f('<div class="row pt-4"><div class="col-12"><!></div> <!></div>'),zi=f('<div class="container-fluid"><div class="row"><div class="col-6"><!></div> <div class="col-6"><!></div></div></div>'),Gi=f("<!> <!> <!>",1);function Hi(e,t){h(t,!0);let o=A(t,"open",7),n=S(i(t.isWord&&t.prevText?t.prevText:""));de(e,{surface$style:"width: 400px; max-width: calc(100vw - 32px);",onSMUIDialogClosed:function(e){t.isWord?t.closeHandler(e,y(n)):t.closeHandler(e),t.onclose()},get open(){return o()},set open(e){o(e)},children:(e,o)=>{var i=Gi(),l=q(i);ue(l,{class:"px-3 pb-0 toolbar toolbar__dialog",children:(e,o)=>{var i=$(),n=q(i);b(n,()=>t.title),T(e,i)},$$slots:{default:!0}});var a=K(l,2);ge(a,{children:(e,o)=>{var i=Ui(),l=B(i),a=B(l);b(a,()=>t.context);var r=K(l,2),s=e=>{var t=Ei();Wi(B(t),{textarea:!0,label:"",variant:"filled",input$rows:5,get value(){return y(n)},set value(e){x(n,e,!0)}}),T(e,t)};X(r,e=>{t.isWord&&e(s)}),T(e,i)},$$slots:{default:!0}});var r=K(a,2);me(r,{children:(e,t)=>{var o=zi(),i=B(o),n=B(i),l=B(n);he(l,{action:"close",children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae("Cancel");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var a=K(n,2),r=B(a);he(r,{action:"accept",children:(e,t)=>{pe(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ae("OK");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}}),T(e,i)},$$slots:{default:!0}}),I()}var _i=f('<div class="row gy-4"><div class="col-sm-6 col-12"><!></div> <div class="col-sm-6 col-12"><!></div> <div class="col-12"><!> <!></div></div>'),Yi=f("<!> <!> <!>",1);var Zi=f('<i class="mdi mdi-play"></i>'),Ji=f('<i class="mdi mdi-clipboard-outline"></i>'),Xi=f('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-10 col-8"><div class="col-12 pt-1"><div> </div> <div> </div></div></div> <div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div></div>'),Ki=f('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-12" style="height: 48px">Empty</div></div>'),Qi=f('<i class="mdi mdi-alpha-a-box-outline"></i>'),en=f('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-11 col-10"><div class="col-12 pt-1"><div> </div> <div> </div></div></div></div>'),tn=f('<i class="mdi mdi-play"></i>'),on=f('<i class="mdi mdi-trash-can"></i>'),nn=f('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-10 col-8"><div class="col-12 pt-1"><div> </div> <div> </div></div></div> <div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div></div>'),ln=f('<i class="mdi mdi-content-save"></i>'),an=f('<div class="row gx-0" style="border-bottom: 1px solid"><div class="col-sm-1 col-2 d-flex align-items-center justify-center"><!></div> <div class="col-sm-11 col-10"><div class="col-12"><!></div></div></div>'),rn=f("<!> <!>",1),sn=f('<i class="mdi mdi-menu-left"></i>'),cn=f('<i class="mdi mdi-menu-right"></i>'),dn=f('<div class="container-fluid pb-2 mb-2" style="border: 1px solid"><!></div> <div class="row gy-2"><div class="col pb-2"><!></div> <div class="col pb-2"><div class="d-row align-items-center justify-end"><!> <span class="list-text px-2"> </span> <!></div></div></div> <div class="row gy-2"><div class="col-12"><!></div></div>',1),un=f("<!> <!> <!>",1),gn=f("<!> <!>",1);function mn(e,t){h(t,!0);let o=A(t,"open",7);const i={action:()=>{},title:"Warning",context:""};let n=S("none"),l=S(1),a=te(()=>9*(y(l)-1)),r=te(()=>Math.min(y(a)+9-1,99)),s=te(()=>Array.from({length:y(r)-y(a)+1},(e,t)=>zt[y(a)+t])),c=te(()=>Array.from({length:y(r)-y(a)+1},(e,t)=>Gt[y(a)+t])),d=S(!1);function u(e){const t="".concat(location.pathname.replace(/\/index\.html$/,"/"),"slot-").concat(e),o=navigator.language,i=new Date,n=new Intl.DateTimeFormat(o,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(i);!async function(e,t,o,i,n){const l=(await Xt()).transaction(i,"readwrite").objectStore(i);try{await new Promise((o,i)=>{const n=l.put(e,t);n.onsuccess=()=>o(),n.onerror=()=>i(n.error)}),n&&(zt[o].stored=!0,zt[o].time=e.time,zt[o].name=e.name,zt[o].app=e.app)}catch(a){console.error(a)}}({stored:!0,name:zt[e].name,time:n,app:to()},t,e,"buildStore",!0)}function g(e){!async function(e,t,o,i){const n=(await Xt()).transaction(o,"readwrite").objectStore(o);try{await new Promise((t,o)=>{const i=n.delete(e);i.onsuccess=()=>t(),i.onerror=()=>o(i.error)}),i&&(zt[t].stored=!1,zt[t].name="Slot ".concat(t+1),zt[t].time="",zt[t].app="")}catch(l){console.error(l)}}("".concat(location.pathname.replace(/\/index\.html$/,"/"),"slot-").concat(e),e,"buildStore",!0)}var m=gn(),p=q(m);de(p,{surface$style:"width: 700px; max-width: calc(100vw - 32px);",get onSMUIDialogClosed(){return t.onclose},id:"dialog",get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=un(),a=q(o);ue(a,{class:"text-left dialog-title",tabindex:0,autofocus:!0,children:(e,t)=>{var o=ae("Save/Load Project");T(e,o)},$$slots:{default:!0}});var r=K(a,2);ge(r,{class:"pt-3",children:(e,t)=>{var o=dn(),a=q(o),r=B(a),m=e=>{var t=$(),o=q(t);we(o,17,()=>y(c),Te,(e,t,o)=>{var l=$(),a=q(l),r=e=>{var l=Xi(),a=B(l),r=B(a);be(r,{onclickcapture:()=>{i.action=()=>{return e=o,void Lo(y(c)[e].app);var e},i.context="Are you sure you want to load this build?<br>Any unsaved changes will be lost.",x(n,"dlgCommon")},children:(e,t)=>{var o=Zi();T(e,o)},$$slots:{default:!0}});var s=K(a,2),d=B(s),u=B(d),g=B(u),m=K(u,2),h=B(m),p=K(s,2),v=B(p);be(v,{onclickcapture:()=>function(e){const t=y(c)[e].app;navigator.clipboard.writeText(t).then(()=>{Wt.labelText="Build code copied to clipboard.",Wt.isOpen=!0}).catch(e=>{Wt.labelText="Failed to copy build code to clipboard.",Wt.isOpen=!0,console.error(e)})}(o),children:(e,t)=>{var o=Ji();T(e,o)},$$slots:{default:!0}}),F(()=>{re(g,y(t).name),re(h,y(t).time)}),T(e,l)},s=e=>{var t=Ki();T(e,t)};X(a,e=>{y(t).stored?e(r):e(s,!1)}),T(e,l)}),T(e,t)},h=e=>{var t=rn(),o=q(t),l=e=>{var t=en(),o=B(t),l=B(o);be(l,{onclickcapture:()=>{i.action=()=>{Lo(Ut.app)},i.context="Are you sure you want to load this build?<br>Any unsaved changes will be lost.",x(n,"dlgCommon")},children:(e,t)=>{var o=Qi();T(e,o)},$$slots:{default:!0}});var a=K(o,2),r=B(a),s=B(r),c=B(s),d=K(s,2),u=B(d);F(()=>{re(c,Ut.name),re(u,Ut.time)}),T(e,t)};X(o,e=>{Ut.stored&&e(l)});var a=K(o,2);we(a,17,()=>y(s),Te,(e,t,o)=>{var l=$(),a=q(l),r=e=>{var l=nn(),a=B(l),r=B(a);be(r,{onclickcapture:()=>{i.action=()=>{Lo(zt[o].app)},i.context="Are you sure you want to load this build?<br>Any unsaved changes will be lost.",x(n,"dlgCommon")},children:(e,t)=>{var o=tn();T(e,o)},$$slots:{default:!0}});var s=K(a,2),c=B(s),d=B(c),u=B(d),m=K(d,2),h=B(m),p=K(s,2),v=B(p);be(v,{onclickcapture:()=>{i.action=()=>g(o),i.context="Are you sure you want to delete this build?<br>This action cannot be undone.",x(n,"dlgCommon")},children:(e,t)=>{var o=on();T(e,o)},$$slots:{default:!0}}),F(()=>{re(u,y(t).name),re(h,y(t).time)}),T(e,l)},s=e=>{var i=an(),n=B(i),l=B(n);be(l,{onclickcapture:()=>u(o),children:(e,t)=>{var o=ln();T(e,o)},$$slots:{default:!0}});var a=K(n,2),r=B(a);Wi(B(r),{onclickcapture:()=>y(t).name="",onblur:()=>{""===y(t).name&&(y(t).name="Slot ".concat(o+1))},input$onkeydown:e=>{"Enter"===e.key&&u(o)},class:"textbox-mini",variant:"standard",get value(){return y(t).name},set value(e){y(t).name=e}}),T(e,i)};X(a,e=>{y(t).stored?e(r):e(s,!1)}),T(e,l)}),T(e,t)};X(r,e=>{y(d)?e(m):e(h,!1)});var p=K(a,2),v=B(p),f=B(v);ve(f,{style:"height: 48px",label:e=>{var t=ae("Load from Legacy Version");T(e,t)},children:(e,t)=>{fe(e,{onSMUISwitchChange:()=>x(l,1),color:"secondary",class:"switch-scale",get checked(){return y(d)},set checked(e){x(d,e,!0)}})},$$slots:{label:!0,default:!0}});var b=K(v,2),w=B(b),I=B(w);be(I,{onclickcapture:()=>y(l)>1?x(l,y(l)-1):x(l,11),children:(e,t)=>{var o=sn();T(e,o)},$$slots:{default:!0}});var S=K(I,2),C=B(S),A=K(S,2);be(A,{onclickcapture:()=>y(l)<11?x(l,y(l)+1):x(l,1),children:(e,t)=>{var o=cn();T(e,o)},$$slots:{default:!0}});var O=K(p,2),k=B(O),M=B(k);he(M,{onclickcapture:()=>x(n,"appBuildForm"),variant:"raised",children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae("Open Build Form");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),F(()=>{var e;return re(C,"Page ".concat(null!=(e=y(l))?e:""))}),T(e,o)},$$slots:{default:!0}});var m=K(r,2);me(m,{children:(e,t)=>{he(e,{action:"close",children:(e,t)=>{pe(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ae("Close");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}});var v=K(p,2),f=e=>{const t=te(()=>"dlgCommon"===y(n));Hi(e,{get open(){return y(t)},onclose:()=>x(n,"none"),get title(){return i.title},get context(){return i.context},closeHandler:e=>{"accept"===e.detail.action&&i.action()}})},b=(e,t)=>{var o=e=>{const t=te(()=>"appBuildForm"===y(n));!function(e,t){h(t,!0);let o=A(t,"open",7),i=S(void 0),n=S(void 0),l=S("");function a(){let e=[],t=Array.from(St.keys());t.sort((e,t)=>{let o=At.get(e),i=At.get(t);return void 0!==o&&void 0!==i?o.row.index!==i.row.index?o.row.index-i.row.index:o.choice.index-i.choice.index:0});for(let o=0;o<t.length;o++){let i=At.get(t[o]);void 0!==i&&e.push(i.choice.title)}return e.join(", ")}de(e,{surface$style:"width: 1920px; max-width: calc(100vw - 32px);",get onSMUIDialogClosed(){return t.onclose},get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=Yi(),r=q(o);ue(r,{class:"px-3 pb-0 toolbar toolbar__dialog",tabindex:0,autofocus:!0,children:(e,t)=>{var o=ae("Build Form");T(e,o)},$$slots:{default:!0}});var s=K(r,2);ge(s,{children:(e,t)=>{var o=_i(),r=B(o),s=B(r);const c=te(a);w(Wi(s,{textarea:!0,get value(){return y(c)},label:"Current Activated Choices Titles",variant:"filled",input$rows:5}),e=>x(i,e,!0),()=>y(i));var d=K(r,2),u=B(d);const g=te(to);w(Wi(u,{textarea:!0,get value(){return y(g)},label:"Current Activated Choices ID's",variant:"filled",input$rows:5}),e=>x(n,e,!0),()=>y(n));var m=K(d,2),h=B(m);Wi(h,{textarea:!0,label:"Area To Import Activated Choices With Lists Of Id's",variant:"filled",input$rows:5,get value(){return y(l)},set value(e){x(l,e,!0)}});var p=K(h,2);he(p,{onclickcapture:()=>Lo(y(l)),variant:"raised",children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae("Import Choices/Clean if empty");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}});var c=K(s,2);me(c,{children:(e,t)=>{he(e,{action:"close",children:(e,t)=>{pe(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ae("Cancel");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}}),I()}(e,{get open(){return y(t)},onclose:()=>x(n,"none")})};X(e,e=>{"appBuildForm"===y(n)&&e(o)},t)};X(v,e=>{"dlgCommon"===y(n)?e(f):e(b,!1)}),T(e,m),I()}var hn=f('<div class="col"><!></div>'),pn=f('<div class="col"><!></div>');function vn(e,t){h(t,!0);let o=te(()=>{let e=kt.get(t.required.reqId);return void 0!==e&&void 0!==app.globalRequirements?e.requireds:[]}),i=te(()=>!!t.required.showRequired&&(!t.required.hideRequired||(t.required.requireds.length>0?yo(t.required.requireds)&&!Io(t.required):!Io(t.required))));var n=$(),l=q(n),a=e=>{var i=$(),n=q(i),l=e=>{var i=$(),n=q(i);we(n,17,()=>y(o),Te,(e,o)=>{var i=$(),n=q(i),l=e=>{var i=hn(),n=B(i);b(n,()=>Ie.sanitize(fo(io(y(o))),qt)),F(()=>ye(i,t.scoreText)),T(e,i)};X(n,e=>{y(o).showRequired&&e(l)}),T(e,i)}),T(e,i)},a=e=>{var o=pn(),i=B(o);b(i,()=>Ie.sanitize(fo(io(t.required)),qt)),F(()=>ye(o,t.scoreText)),T(e,o)};X(n,e=>{"gid"===t.required.type?e(l):e(a,!1)}),T(e,i)};X(l,e=>{y(i)&&e(a)}),T(e,n),I()}var fn=f('<img alt=""/>'),bn=f('<img alt=""/>'),wn=f('<h3 class="m-0"><!></h3>'),Tn=f('<img alt=""/>'),In=f('<img alt=""/>'),yn=f('<p class="mb-0"><!></p>'),Sn=f('<img alt=""/>'),Cn=f('<img alt=""/>'),xn=f('<span class="m-0"><!> <!> <!> <!> <!> <!></span>'),Bn=f('<img alt=""/>'),An=f('<img alt=""/>'),On=f('<h2 class="mb-0"><!></h2>'),kn=f('<p class="mb-0"><!></p>'),Mn=f('<div class="col p-0 text-center"><!></div> <div class="col p-0 text-center"><!> <!> <!></div>',1),Fn=f('<h2 class="mb-0"><!></h2>'),Rn=f('<p class="mb-0"><!></p>'),Dn=f('<img alt=""/>'),jn=f('<img alt=""/>'),Pn=f('<div class="col p-0 text-center"><!> <!> <!></div> <div class="col p-0 text-center"><!></div>',1),$n=f('<div class="row m-0 p-0 w-100"><!></div>'),qn=f('<div class="text-center"><!></div>');function Vn(e,t){h(t,!0);let o=A(t,"windowWidth",3,0),i=A(t,"preloadImages",3,!1),n=te(()=>void 0!==t.choice&&t.choice.isActive),l=te(()=>bo("privateAddonImageIsOn",t.row,t.choice)),a=te(()=>bo("privateAddonIsOn",t.row,t.choice)),r=te(()=>bo("privateFilterIsOn",t.row,t.choice)),s=te(()=>bo("privateObjectImageIsOn",t.row,t.choice)),c=te(()=>bo("privateObjectIsOn",t.row,t.choice)),d=te(()=>bo("privateTextIsOn",t.row,t.choice)),u=te(()=>yo(t.addon.requireds)),g=te(()=>void 0!==y(l).addonImageBoxWidth?y(l).addonImageBoxWidth:50),m=te(()=>{let e=y(a).useAddonDesign,o=(e?y(a).addonBorderRadiusIsPixels:y(c).objectBorderRadiusIsPixels)?"px":"%",i=0,l=0,s=0,d=[];if(e){if(y(a).addonBorderImage&&d.push("border-image: url('".concat(y(a).addonBorderImage,"') ").concat(y(a).addonBorderImageSliceTop," ").concat(y(a).addonBorderImageSliceRight," ").concat(y(a).addonBorderImageSliceBottom," ").concat(y(a).addonBorderImageSliceLeft," / ").concat(y(a).addonBorderImageWidth,"px ").concat(y(a).addonBorderImageRepeat,"; border-style: solid; padding: ").concat(y(a).addonBorderImageWidth,"px;")),y(a).useAddonBackgroundImage&&y(a).addonBackgroundImage&&(d.push("background-image: url('".concat(y(a).addonBackgroundImage,"'); ").concat(y(a).isObjectBackgroundRepeat?"background-repeat: repeat;":y(a).isObjectBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;")),i=d.length),y(a).addonBgColorIsOn&&(d.push("background-color: ".concat(Si(y(a).addonBgColor),";")),l=d.length),d.push("margin: ".concat(y(a).addonMargin,"px;")),d.push("border-radius: ".concat(y(a).addonBorderRadiusTopLeft).concat(o," ").concat(y(a).addonBorderRadiusTopRight).concat(o," ").concat(y(a).addonBorderRadiusBottomRight).concat(o," ").concat(y(a).addonBorderRadiusBottomLeft).concat(o,";")),y(a).addonOverflowIsOn&&d.push("overflow: hidden;"),y(a).addonBorderIsOn||y(n)&&y(r).selBorderColorIsOn||!t.isEnabled&&y(r).reqBorderColorIsOn){let e=y(a).addonBorderColor;!t.isEnabled&&y(r).reqBorderColorIsOn?e=y(r).reqFilterBorderColor:y(n)&&y(r).selBorderColorIsOn&&(e=y(r).selFilterBorderColor),d.push("border: ".concat(y(a).addonBorderWidth,"px ").concat(y(a).addonBorderStyle," ").concat(Si(e),";"))}y(a).addonDropShadowIsOn&&(y(a).addonUseBoxShadowIsOn?d.push("box-shadow: ".concat(y(a).addonDropShadowH,"px ").concat(y(a).addonDropShadowV,"px ").concat(y(a).addonDropShadowBlur,"px ").concat(Si(y(a).addonDropShadowColor),";")):(s=d.length,d.push("filter: drop-shadow(".concat(y(a).addonDropShadowH,"px ").concat(y(a).addonDropShadowV,"px ").concat(y(a).addonDropShadowBlur,"px ").concat(Si(y(a).addonDropShadowColor),")")))),0===s&&(d.push("filter:"),s=d.length),t.isEnabled&&y(u)&&(y(n)?(y(r).selFilterBlurIsOn&&d.push(" blur(".concat(y(r).selFilterBlur,"px)")),y(r).selFilterBrightIsOn&&d.push(" brightness(".concat(y(r).selFilterBright,"%)")),y(r).selFilterContIsOn&&d.push(" contrast(".concat(y(r).selFilterCont,"%)")),y(r).selFilterGrayIsOn&&d.push(" grayscale(".concat(y(r).selFilterGray,"%)")),y(r).selFilterHueIsOn&&d.push(" hue-rotate(".concat(y(r).selFilterHue,"deg)")),y(r).selFilterInvertIsOn&&d.push(" invert(".concat(y(r).selFilterInvert,"%)")),y(r).selFilterOpacIsOn&&d.push(" opacity(".concat(y(r).selFilterOpac,"%)")),y(r).selFilterSaturIsOn&&d.push(" saturate(".concat(y(r).selFilterSatur,")")),y(r).selFilterSepiaIsOn&&d.push(" sepia(".concat(y(r).selFilterGray,"%)"))):(y(r).unselFilterBlurIsOn&&d.push(" blur(".concat(y(r).unselFilterBlur,"px)")),y(r).unselFilterBrightIsOn&&d.push(" brightness(".concat(y(r).unselFilterBright,"%)")),y(r).unselFilterContIsOn&&d.push(" contrast(".concat(y(r).unselFilterCont,"%)")),y(r).unselFilterGrayIsOn&&d.push(" grayscale(".concat(y(r).unselFilterGray,"%)")),y(r).unselFilterHueIsOn&&d.push(" hue-rotate(".concat(y(r).unselFilterHue,"deg)")),y(r).unselFilterInvertIsOn&&d.push(" invert(".concat(y(r).unselFilterInvert,"%)")),y(r).unselFilterOpacIsOn&&d.push(" opacity(".concat(y(r).unselFilterOpac,"%)")),y(r).unselFilterSaturIsOn&&d.push(" saturate(".concat(y(r).unselFilterSatur,")")),y(r).unselFilterSepiaIsOn&&d.push(" sepia(".concat(y(r).unselFilterGray,"%)"))),d.length===s?d.splice(s-1,1):d.push(";")),y(a).addonGradientIsOn&&d.push("background-image: linear-gradient(".concat(y(a).addonGradient,");"))}return(app.showAllAddons>0||t.addon.showAddon)&&t.isEnabled&&!y(u)&&(0===s&&(d.push("filter:"),s=d.length),y(r).reqFilterBlurIsOn&&d.push(" blur(".concat(y(r).reqFilterBlur,"px)")),y(r).reqFilterBrightIsOn&&d.push(" brightness(".concat(y(r).reqFilterBright,"%)")),y(r).reqFilterContIsOn&&d.push(" contrast(".concat(y(r).reqFilterCont,"%)")),y(r).reqFilterGrayIsOn&&d.push(" grayscale(".concat(y(r).reqFilterGray,"%)")),y(r).reqFilterHueIsOn&&d.push(" hue-rotate(".concat(y(r).reqFilterHue,"deg)")),y(r).reqFilterInvertIsOn&&d.push(" invert(".concat(y(r).reqFilterInvert,"%)")),y(r).reqFilterOpacIsOn&&d.push(" opacity(".concat(y(r).reqFilterOpac,"%)")),y(r).reqFilterSaturIsOn&&d.push(" saturate(".concat(y(r).reqFilterSatur,")")),y(r).reqFilterSepiaIsOn&&d.push(" sepia(".concat(y(r).reqFilterGray,"%)")),d.length===s?d.splice(s-1,1):d.push(";"),y(r).reqBgColorIsOn&&(y(r).reqOverlayOnImage||(0!==l&&d.splice(l-1,1),0!==i&&d.splice(i-1,1)),d.push("background-color: ".concat(Si(y(r).reqFilterBgColor),";"))),y(a).addonGradientIsOn&&d.push("background-image: linear-gradient(".concat(y(a).addonGradientOnReq,");"))),d.join(" ")}),p=te(()=>{let e=[];return e.push("font-family: '".concat(y(d).addonTitle,"'; font-size: ").concat(y(d).addonTitleTextSize,"%; text-align: ").concat(y(d).addonTitleAlign,";")),!t.isEnabled&&y(r).reqATitleColorIsOn?e.push("color: ".concat(Si(y(r).reqFilterATitleColor),";")):y(n)&&y(r).selATitleColorIsOn?e.push("color: ".concat(Si(y(r).selFilterATitleColor),";")):e.push("color: ".concat(Si(y(d).addonTitleColor),";")),y(a).useAddonDesign?y(a).titlePaddingIsOn&&e.push("padding: ".concat(y(a).addonTextPadding,"px;")):y(c).titlePaddingIsOn&&e.push("padding: ".concat(y(c).objectTextPadding,"px;")),e.join(" ")}),v=te(()=>{let e=[];return e.push("font-family: '".concat(y(d).addonText,"'; text-align: ").concat(y(d).addonTextAlign,"; font-size: ").concat(y(d).addonTextTextSize,"%; white-space: pre-line;")),!t.isEnabled&&y(r).reqATextColorIsOn?e.push("color: ".concat(Si(y(r).reqFilterATextColor),";")):y(n)&&y(r).selATextColorIsOn?e.push("color: ".concat(Si(y(r).selFilterATextColor),";")):e.push("color: ".concat(Si(y(d).addonTextColor),";")),y(a).useAddonDesign?e.push("padding: ".concat(y(a).addonTextPadding,"px;")):e.push("padding: ".concat(y(c).objectTextPadding,"px;")),e.join(" ")}),f=te(()=>{var e,o,i,n;let a=[],r=y(l).useAddonImage,c=(r?y(l).addonImgBorderRadiusIsPixels:y(s).objectImgBorderRadiusIsPixels)?"px":"%";return r?(a.push("width: ".concat(y(l).addonImageWidth,"%; margin-top: ").concat(y(l).addonImageMarginTop,"%; margin-bottom: ").concat(y(l).addonImageMarginBottom,"%;")),y(l).addonImgObjectFillIsOn&&(null==(e=t.choice)?void 0:e.addonImgObjectFillHeight)&&a.push("object-fit: ".concat(y(l).addonImgObjectFillStyle,"; height: ").concat(null==(o=t.choice)?void 0:o.addonImgObjectFillHeight,"px;")),a.push("border-radius: ".concat(y(l).addonImgBorderRadiusTopLeft).concat(c," ").concat(y(l).addonImgBorderRadiusTopRight).concat(c," ").concat(y(l).addonImgBorderRadiusBottomRight).concat(c," ").concat(y(l).addonImgBorderRadiusBottomLeft).concat(c,";")),y(l).addonImgOverflowIsOn&&a.push("overflow: hidden;"),y(l).addonImgBorderIsOn&&a.push("border: ".concat(y(l).addonImgBorderWidth,"px ").concat(y(l).addonImgBorderStyle," ").concat(Si(y(l).addonImgBorderColor),";"))):(a.push("width: ".concat(y(s).objectImageWidth,"%; margin-top: ").concat(y(s).objectImageMarginTop,"%; margin-bottom: ").concat(y(s).objectImageMarginBottom,"%;")),y(s).objectImgObjectFillIsOn&&(null==(i=t.row)?void 0:i.objectImgObjectFillHeight)&&a.push("object-fit: ".concat(y(s).objectImgObjectFillStyle,"; height: ").concat(null==(n=t.row)?void 0:n.objectImgObjectFillHeight,"px;")),a.push("border-radius: ".concat(y(s).objectImgBorderRadiusTopLeft).concat(c," ").concat(y(s).objectImgBorderRadiusTopRight).concat(c," ").concat(y(s).objectImgBorderRadiusBottomRight).concat(c," ").concat(y(s).objectImgBorderRadiusBottomLeft).concat(c,";")),y(s).objectImgOverflowIsOn&&a.push("overflow: hidden;"),y(s).objectImgBorderIsOn&&a.push("border: ".concat(y(s).objectImgBorderWidth,"px ").concat(y(s).objectImgBorderStyle," ").concat(Si(y(s).objectImgBorderColor),";"))),a.join(" ")}),w=te(()=>"font-family: '".concat(y(d).scoreText,"'; font-size: ").concat(y(d).scoreTextSize,"%; text-align: ").concat(y(d).scoreTextAlign,"; color: ").concat(Si(y(d).scoreTextColor),";"));var S=$(),C=q(S),x=e=>{var n=qn(),l=B(n),a=e=>{var n=xn(),l=B(n),a=e=>{var o=$(),n=q(o),l=e=>{var o=fn();M(o,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.addon.imageSourceTooltip),F(()=>{Se(o,"src",t.addon.image),ye(o,y(f)),Se(o,"loading",i()?"eager":"lazy")}),T(e,o)},a=e=>{var o=bn();F(()=>{Se(o,"src",t.addon.image),ye(o,y(f)),Se(o,"loading",i()?"eager":"lazy")}),T(e,o)};X(n,e=>{t.addon.imageSourceTooltip?e(l):e(a,!1)}),T(e,o)};X(l,e=>{var i;(1===t.addon.template||o()<=960)&&t.addon.image&&!(null==(i=t.row)?void 0:i.addonImageRemoved)&&e(a)});var r=K(l,2),s=e=>{var o=wn(),i=B(o);b(i,()=>Ie.sanitize(fo(t.addon.title),qt)),F(()=>ye(o,y(p))),T(e,o)};X(r,e=>{var o;""===t.addon.title||(null==(o=t.row)?void 0:o.addonTitleRemoved)||e(s)});var c=K(r,2),d=e=>{var o=$(),i=q(o);we(i,17,()=>t.addon.requireds,Te,(e,t)=>{vn(e,{get required(){return y(t)},get scoreText(){return y(w)}})}),T(e,o)};X(c,e=>{var o;(null==(o=t.row)?void 0:o.objectRequirementRemoved)||e(d)});var u=K(c,2),g=e=>{var o=$(),n=q(o),l=e=>{var o=Tn();M(o,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.addon.imageSourceTooltip),F(()=>{Se(o,"src",t.addon.image),ye(o,y(f)),Se(o,"loading",i()?"eager":"lazy")}),T(e,o)},a=e=>{var o=In();F(()=>{Se(o,"src",t.addon.image),ye(o,y(f)),Se(o,"loading",i()?"eager":"lazy")}),T(e,o)};X(n,e=>{t.addon.imageSourceTooltip?e(l):e(a,!1)}),T(e,o)};X(u,e=>{var o;5===t.addon.template&&t.addon.image&&!(null==(o=t.row)?void 0:o.addonImageRemoved)&&e(g)});var m=K(u,2),h=e=>{var o=yn(),i=B(o);b(i,()=>Ie.sanitize(fo(t.addon.text),qt)),F(()=>ye(o,y(v))),T(e,o)};X(m,e=>{var o;""===t.addon.text||(null==(o=t.row)?void 0:o.addonTextRemoved)||e(h)});var I=K(m,2),S=e=>{var o=$(),n=q(o),l=e=>{var o=Sn();M(o,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.addon.imageSourceTooltip),F(()=>{Se(o,"src",t.addon.image),ye(o,y(f)),Se(o,"loading",i()?"eager":"lazy")}),T(e,o)},a=e=>{var o=Cn();F(()=>{Se(o,"src",t.addon.image),ye(o,y(f)),Se(o,"loading",i()?"eager":"lazy")}),T(e,o)};X(n,e=>{t.addon.imageSourceTooltip?e(l):e(a,!1)}),T(e,o)};X(I,e=>{var o;4===t.addon.template&&t.addon.image&&!(null==(o=t.row)?void 0:o.addonImageRemoved)&&e(S)}),T(e,n)},r=e=>{var o=$n(),n=B(o),l=e=>{var o=Mn(),n=q(o),l=B(n),a=e=>{var o=$(),n=q(o),l=e=>{var o=Bn();M(o,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.addon.imageSourceTooltip),F(()=>{Se(o,"src",t.addon.image),ye(o,y(f)),Se(o,"loading",i()?"eager":"lazy")}),T(e,o)},a=e=>{var o=An();F(()=>{Se(o,"src",t.addon.image),ye(o,y(f)),Se(o,"loading",i()?"eager":"lazy")}),T(e,o)};X(n,e=>{t.addon.imageSourceTooltip?e(l):e(a,!1)}),T(e,o)};X(l,e=>{var o;t.addon.image&&!(null==(o=t.row)?void 0:o.addonImageRemoved)&&e(a)});var r=K(n,2),s=B(r),c=e=>{var o=On(),i=B(o);b(i,()=>Ie.sanitize(fo(t.addon.title),qt)),F(()=>ye(o,y(p))),T(e,o)};X(s,e=>{var o;""===t.addon.title||(null==(o=t.row)?void 0:o.addonTitleRemoved)||e(c)});var d=K(s,2),u=e=>{var o=$(),i=q(o);we(i,17,()=>t.addon.requireds,Te,(e,t)=>{vn(e,{get required(){return y(t)},get scoreText(){return y(w)}})}),T(e,o)};X(d,e=>{var o;(null==(o=t.row)?void 0:o.objectRequirementRemoved)||e(u)});var m=K(d,2),h=e=>{var o=kn(),i=B(o);b(i,()=>Ie.sanitize(fo(t.addon.text),qt)),F(()=>ye(o,y(v))),T(e,o)};X(m,e=>{var o;""===t.addon.text||(null==(o=t.row)?void 0:o.addonTextRemoved)||e(h)}),F(()=>{var e;ye(n,"max-width: ".concat(null!=(e=y(g))?e:"","%")),ye(r,"max-width: ".concat(100-y(g),"%"))}),T(e,o)},a=(e,o)=>{var n=e=>{var o=Pn(),n=q(o),l=B(n),a=e=>{var o=Fn(),i=B(o);b(i,()=>Ie.sanitize(fo(t.addon.title),qt)),F(()=>ye(o,y(p))),T(e,o)};X(l,e=>{var o;""===t.addon.title||(null==(o=t.row)?void 0:o.addonTitleRemoved)||e(a)});var r=K(l,2),s=e=>{var o=$(),i=q(o);we(i,17,()=>t.addon.requireds,Te,(e,t)=>{vn(e,{get required(){return y(t)},get scoreText(){return y(w)}})}),T(e,o)};X(r,e=>{var o;(null==(o=t.row)?void 0:o.objectRequirementRemoved)||e(s)});var c=K(r,2),d=e=>{var o=Rn(),i=B(o);b(i,()=>Ie.sanitize(fo(t.addon.text),qt)),F(()=>ye(o,y(v))),T(e,o)};X(c,e=>{var o;""===t.addon.text||(null==(o=t.row)?void 0:o.addonTextRemoved)||e(d)});var u=K(n,2),m=B(u),h=e=>{var o=$(),n=q(o),l=e=>{var o=Dn();M(o,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.addon.imageSourceTooltip),F(()=>{Se(o,"src",t.addon.image),ye(o,y(f)),Se(o,"loading",i()?"eager":"lazy")}),T(e,o)},a=e=>{var o=jn();F(()=>{Se(o,"src",t.addon.image),ye(o,y(f)),Se(o,"loading",i()?"eager":"lazy")}),T(e,o)};X(n,e=>{t.addon.imageSourceTooltip?e(l):e(a,!1)}),T(e,o)};X(m,e=>{var o;t.addon.image&&!(null==(o=t.row)?void 0:o.addonImageRemoved)&&e(h)}),F(()=>{var e;ye(n,"max-width: ".concat(100-y(g),"%")),ye(u,"max-width: ".concat(null!=(e=y(g))?e:"","%"))}),T(e,o)};X(e,e=>{3===t.addon.template&&e(n)},o)};X(n,e=>{2===t.addon.template?e(l):e(a,!1)}),T(e,o)};X(l,e=>{t.addon.template>=4||1===t.addon.template||o()<=960?e(a):e(r,!1)}),F(()=>ye(n,y(m))),T(e,n)};X(C,e=>{(app.showAllAddons>0||t.addon.showAddon||yo(t.addon.requireds))&&e(x)}),T(e,S),I()}var Ln=f('<i class="mdi mdi-minus"></i>'),Nn=f('<i class="mdi mdi-plus"></i>'),Wn=f('<div class="px-5 w-100"><!></div>'),En=f('<div class="d-row justify-space-around w-100"><!> <div translate="no"> </div> <!></div> <!>',1);function Un(e,t){h(t,!0);let o=S(0),i=te(()=>{if(t.choice.isMultipleUseVariable)return t.choice.multipleUseVariable;if(void 0!==t.choice.multipleScoreId){let e=xt.get(t.choice.multipleScoreId);if(void 0!==e)return e.startingSum}return 0});function n(e){t.selectedOneMore()}function l(e){t.selectedOneLess()}function a(){const e=y(o)-y(i);for(let o=0;o<Math.abs(e);o++)e>0?t.selectedOneMore():t.selectedOneLess();document.activeElement&&document.activeElement.blur()}p(()=>{t.choice.useSlider&&x(o,y(i),!0)});var r=$(),s=q(r),c=e=>{var r=En(),s=q(r),c=B(s);const d=te(()=>!t.isEnabled);be(c,{class:"counter-icons",get disabled(){return y(d)},onclickcapture:l,children:(e,o)=>{var i=Ln();F(()=>ye(i,t.multiChoiceButton)),T(e,i)},$$slots:{default:!0}});var u=K(c,2),g=B(u),m=K(u,2);const h=te(()=>!t.isEnabled);be(m,{class:"counter-icons",get disabled(){return y(h)},onclickcapture:n,children:(e,o)=>{var i=Nn();F(()=>ye(i,t.multiChoiceButton)),T(e,i)},$$slots:{default:!0}});var p=K(s,2),v=e=>{var i=Wn(),n=B(i);const l=te(()=>!t.isEnabled);Ce(n,{get min(){return t.choice.numMultipleTimesMinus},get max(){return t.choice.numMultipleTimesPluss},step:1,class:"mx-2",onpointerup:a,get disabled(){return y(l)},discrete:!0,get value(){return y(o)},set value(e){x(o,e,!0)}}),T(e,i)};X(p,e=>{t.choice.useSlider&&e(v)}),F(()=>{ye(u,t.multiChoiceText),re(g,y(i))}),T(e,r)};X(s,e=>{t.choice.hideCounterUntilSelect&&0===t.choice.multipleUseVariable||e(c)}),T(e,r),I()}var zn=f('<img class="me-1" alt=""/>'),Gn=f('<img class="mx-1" alt=""/>'),Hn=f('<img class="mx-1" alt=""/>'),_n=f('<img class="ms-1" alt=""/>'),Yn=f("<!> <!> <!> <!> <!> <!> <!>",1),Zn=f('<div class="row m-0"><div class="col-12 p-0 m-0 d-flex align-items-center justify-center"><p class="m-0 d-flex align-items-center"><!></p></div></div>');function Jn(e,t){h(t,!0);let o=te(()=>bo("privateTextIsOn",t.row,t.choice)),i=te(()=>bo("privateFilterIsOn",t.row,t.choice)),n=te(()=>xt.get(t.score.id)),l=te(()=>yo(t.choice.requireds)),a=te(()=>{let e=[];if(e.push("".concat(t.score.afterText)),t.score.discountIsOn&&t.score.discountShow&&void 0!==t.score.discountAfterText)if(t.score.appliedDiscount)e.push("".concat(t.score.discountAfterText));else if(t.score.discountedFrom&&t.score.discountedFrom.length>0){const o=At.get(t.score.discountedFrom[0]);if(void 0!==o){const i=o.choice;if(i.useDiscountCount&&void 0!==i.discountCount&&void 0!==i.numDiscountChoices){if(i.discountCount>i.numDiscountChoices)e.push("".concat(t.score.discountAfterText));else if(void 0!==t.score.tmpDiscount){let o=t.score.value,i="";for(let e=0;e<t.score.tmpDiscount.length;e++)t.score.tmpDiscount[e].showDiscount&&o>t.score.tmpDiscount[e].discountedValue&&(o=t.score.tmpDiscount[e].discountedValue,i=t.score.tmpDiscount[e].beforeText||"");e.push("".concat(i))}}else e.push("".concat(t.score.discountAfterText))}}return e.join(" ")}),r=te(()=>{let e=[];if(e.push("".concat(t.score.beforeText)),t.score.discountIsOn&&t.score.discountShow&&void 0!==t.score.discountBeforeText)if(t.score.appliedDiscount)e.push("".concat(t.score.discountBeforeText));else if(t.score.discountedFrom&&t.score.discountedFrom.length>0){const o=At.get(t.score.discountedFrom[0]);if(void 0!==o){const i=o.choice;if(i.useDiscountCount&&void 0!==i.discountCount&&void 0!==i.numDiscountChoices){if(i.discountCount>i.numDiscountChoices)e.push("".concat(t.score.discountBeforeText));else if(void 0!==t.score.tmpDiscount){let o=t.score.value,i="";for(let e=0;e<t.score.tmpDiscount.length;e++)t.score.tmpDiscount[e].showDiscount&&o>t.score.tmpDiscount[e].discountedValue&&(o=t.score.tmpDiscount[e].discountedValue,i=t.score.tmpDiscount[e].beforeText||"");e.push("".concat(i))}}else e.push("".concat(t.score.discountBeforeText))}}return e.join(" ")}),s=te(()=>t.score.hideValue?"":t.score.isRandom&&!t.score.setValue&&void 0!==t.score.maxValue?t.score.maxValue<0?"".concat(y(d)," ~ ").concat(y(u)):"".concat(y(u)," ~ ").concat(y(d)):"".concat(y(c))),c=te(()=>{var e,o;let i=t.score.value;if(t.score.discountIsOn&&t.score.discountShow&&void 0!==t.score.discountScore)if(t.score.appliedDiscount)i=t.score.discountScore;else if(t.score.discountedFrom&&t.score.discountedFrom.length>0){const e=At.get(t.score.discountedFrom[0]);if(void 0!==e){const o=e.choice;if(o.useDiscountCount&&void 0!==o.discountCount&&void 0!==o.numDiscountChoices){if(o.discountCount>o.numDiscountChoices)i=t.score.discountScore;else if(void 0!==t.score.tmpDiscount)for(let e=0;e<t.score.tmpDiscount.length;e++)i>t.score.tmpDiscount[e].discountedValue&&(i=t.score.tmpDiscount[e].discountedValue)}else i=t.score.discountScore}}if(i=Math.abs(i),i=(null==(e=y(n))?void 0:e.allowFloat)?i%1==0?i:parseFloat(i.toFixed(void 0!==y(n).decimalPlaces?y(n).decimalPlaces:2)):Math.floor(i),null==(o=y(n))?void 0:o.plussOrMinusAdded){let e=y(n).plussOrMinusInverted?y(g)?"-":"+":y(g)?"+":"-";return"".concat(e).concat(i)}return"".concat(i)}),d=te(()=>{var e,o;if(void 0!==t.score.maxValue){let i=t.score.maxValue<0,l=Math.abs(t.score.maxValue);if(l=(null==(e=y(n))?void 0:e.allowFloat)?l%1==0?l:parseFloat(l.toFixed(void 0!==y(n).decimalPlaces?y(n).decimalPlaces:2)):Math.floor(l),null==(o=y(n))?void 0:o.plussOrMinusAdded){let e=y(n).plussOrMinusInverted?i?"-":"+":i?"+":"-";return"".concat(e).concat(l)}return"".concat(l)}return""}),u=te(()=>{var e,o;if(void 0!==t.score.minValue){let i=t.score.minValue<0,l=Math.abs(t.score.minValue);if(l=(null==(e=y(n))?void 0:e.allowFloat)?l%1==0?l:parseFloat(l.toFixed(void 0!==y(n).decimalPlaces?y(n).decimalPlaces:2)):Math.floor(l),null==(o=y(n))?void 0:o.plussOrMinusAdded){let e=y(n).plussOrMinusInverted?i?"-":"+":i?"+":"-";return"".concat(e).concat(l)}return"".concat(l)}return""}),g=te(()=>t.score.discountShow?(void 0!==t.score.discountScore?t.score.discountScore:t.score.value)<0:t.score.value<0),m=te(()=>{var e;let a=[];return a.push("font-family: '".concat(y(o).scoreText,"'; font-size: ").concat(y(o).scoreTextSize,"%; text-align: ").concat(y(o).scoreTextAlign,";")),(null==(e=y(n))?void 0:e.pointColorsIsOn)?y(g)?a.push("color: ".concat(Si(y(n).positiveColor),";")):a.push("color: ".concat(Si(y(n).negativeColor),";")):a.push("color: ".concat(Si(y(o).scoreTextColor),";")),y(l)?t.choice.isActive&&y(i).selScoreTextColorIsOn&&a.push("color: ".concat(Si(y(i).selFilterSTextColor))):y(i).reqScoreTextColorIsOn&&a.push("color: ".concat(Si(y(i).reqFilterSTextColor))),a.join(" ")}),p=te(()=>{var e;return(null==(e=y(n))?void 0:e.negativeIconIsOn)&&y(g)}),v=te(()=>{var e,t;return y(p)?null==(e=y(n))?void 0:e.negativeImageSidePlacement:null==(t=y(n))?void 0:t.imageSidePlacement}),f=te(()=>{var e,t;return y(p)?null==(e=y(n))?void 0:e.negativeImageOnSide:null==(t=y(n))?void 0:t.imageOnSide}),w=te(()=>{var e,t;return(y(p)?null==(e=y(n))?void 0:e.negativeImage:null==(t=y(n))?void 0:t.image)||""}),S=te(()=>{var e,t;return(y(p)?null==(e=y(n))?void 0:e.negativeIconWidth:null==(t=y(n))?void 0:t.iconWidth)||0}),C=te(()=>{var e,t;return(y(p)?null==(e=y(n))?void 0:e.negativeIconHeight:null==(t=y(n))?void 0:t.iconHeight)||0}),x=te(()=>!y(v)&&!y(f)),A=te(()=>!y(v)&&y(f)),O=te(()=>y(v)&&!y(f)),k=te(()=>y(v)&&y(f));var M=$(),R=q(M),D=e=>{var t=Zn(),o=B(t),i=B(o),l=B(i),c=e=>{var t=Yn(),o=q(t),i=e=>{var t=zn();F(()=>{var e,o;Se(t,"src",y(w)),ye(t,"width: ".concat(null!=(e=y(S))?e:"","px; height: ").concat(null!=(o=y(C))?o:"","px;"))}),T(e,t)};X(o,e=>{y(x)&&e(i)});var n=K(o,2);b(n,()=>Ie.sanitize(y(r),qt));var l=K(n,2),c=e=>{var t=Gn();F(()=>{var e,o;Se(t,"src",y(w)),ye(t,"width: ".concat(null!=(e=y(S))?e:"","px; height: ").concat(null!=(o=y(C))?o:"","px;"))}),T(e,t)};X(l,e=>{y(A)&&e(c)});var d=K(l,2);b(d,()=>Ie.sanitize(y(s),qt));var u=K(d,2),g=e=>{var t=Hn();F(()=>{var e,o;Se(t,"src",y(w)),ye(t,"width: ".concat(null!=(e=y(S))?e:"","px; height: ").concat(null!=(o=y(C))?o:"","px;"))}),T(e,t)};X(u,e=>{y(O)&&e(g)});var m=K(u,2);b(m,()=>Ie.sanitize(y(a),qt));var h=K(m,2),p=e=>{var t=_n();F(()=>{var e,o;Se(t,"src",y(w)),ye(t,"width: ".concat(null!=(e=y(S))?e:"","px; height: ").concat(null!=(o=y(C))?o:"","px;"))}),T(e,t)};X(h,e=>{y(k)&&e(p)}),T(e,t)},d=e=>{var t=$(),o=q(t);b(o,()=>Ie.sanitize("".concat(y(r)," ").concat(y(s)," ").concat(y(a)),qt)),T(e,t)};X(l,e=>{var t;(null==(t=y(n))?void 0:t.iconIsOn)?e(c):e(d,!1)}),F(()=>ye(o,y(m))),T(e,t)};X(R,e=>{(function(){if(t.score.showScore){if(void 0!==y(n)&&y(n).isNotShownObjects){if(void 0!==y(n).activatedId&&""!==y(n).activatedId){let e=kt.get(y(n).activatedId),t=Ft.get(y(n).activatedId);return void 0!==e?yo(e.requireds):void 0!==t?t.isTrue:To(y(n).activatedId)}return!1}return!0}return!1})()&&yo(t.score.requireds)&&e(D)}),T(e,M),I()}var Xn=f('<div class="col-12"><!></div>'),Kn=f('<img alt=""/>'),Qn=f('<img alt=""/>'),el=f('<h3 class="m-0"><!></h3>'),tl=f('<img alt=""/>'),ol=f('<img alt=""/>'),il=f('<p class="mb-0"><!></p>'),nl=f('<img alt=""/>'),ll=f('<img alt=""/>'),al=f('<span class="d-column w-100 p-0 align-items-center"><!> <!> <span class="w-100"><!> <!> <!> <!> <!> <!> <!> <!> <!> <!></span> <div></div> <!></span>'),rl=f('<img alt=""/>'),sl=f('<img alt=""/>'),cl=f('<h2 class="mb-0"><!></h2>'),dl=f('<p class="mb-0"><!></p>'),ul=f("<div></div> <!>",1),gl=f('<div class="col-12 text-center"><div></div> <!></div>'),ml=f('<div class="col p-0 text-center"><!></div> <div class="col p-0 text-center"><!> <!> <!> <!> <!> <!> <!> <!> <!></div> <!>',1),hl=f('<h2 class="mb-0"><!></h2>'),pl=f('<p class="mb-0"><!></p>'),vl=f("<div></div> <!>",1),fl=f('<img alt=""/>'),bl=f('<img alt=""/>'),wl=f('<div class="col-12 text-center"><div></div> <!></div>'),Tl=f('<div class="col p-0 text-center"><!> <!> <!> <!> <!> <!> <!> <!> <!></div> <div class="col p-0 text-center"><!></div> <!>',1),Il=f("<div><span><span><!></span></span></div>"),yl=f("<!> <!>",1);function Sl(e,t){h(t,!0);const[o,i]=xe(),l=()=>Ae(Yt,"$winWidth",o),a=A(t,"preloadImages",3,!1),r=[],s={choice:null,row:null,context:"",prevText:"",isWord:!0};let c=te(()=>bo("privateBackgroundIsOn",t.row,t.choice)),u=te(()=>bo("privateFilterIsOn",t.row,t.choice)),g=te(()=>bo("privateMultiChoiceIsOn",t.row,t.choice)),m=te(()=>bo("privateObjectImageIsOn",t.row,t.choice)),p=te(()=>bo("privateObjectIsOn",t.row,t.choice)),v=te(()=>bo("privateTextIsOn",t.row,t.choice)),f=te(()=>void 0!==y(m).objectImageBoxWidth?y(m).objectImageBoxWidth:50),w=S("none"),C=!1,O=te(()=>yo(t.choice.requireds)),k=te(()=>t.choice.addonJustify?"justify-".concat(t.choice.addonJustify):""),j=te(()=>t.choice.isActive),P=te(()=>y(p).objectHeight),V=te(()=>{if(t.row.isResultRow){const e=At.get(t.choice.id);if(void 0!==e)return e.row}return t.row}),L=te(()=>{let e=[];return e.push("font-family: '".concat(y(v).objectTitle,"'; font-size: ").concat(y(v).objectTitleTextSize,"%; text-align: ").concat(y(v).objectTitleAlign,";")),!y(O)&&y(u).reqCTitleColorIsOn?e.push("color: ".concat(Si(y(u).reqFilterCTitleColor),";")):y(j)&&y(u).selCTitleColorIsOn?e.push("color: ".concat(Si(y(u).selFilterCTitleColor),";")):e.push("color: ".concat(Si(y(v).objectTitleColor),";")),y(p).titlePaddingIsOn&&e.push("padding: ".concat(y(p).objectTextPadding,"px;")),e.join(" ")}),N=te(()=>"font-family: '".concat(y(g).multiChoiceTextFont,"'; color: ").concat(Si(y(v).scoreTextColor),"; font-size: ").concat(y(g).multiChoiceTextSize,"%; align-content: center;")),W=te(()=>"font-size: ".concat(y(g).multiChoiceCounterSize,"%; color: ").concat(Si(y(v).scoreTextColor),";")),E=te(()=>!t.choice.hideMultipleCounter||y(O)),U=te(()=>{let e=[];return e.push("font-family: '".concat(y(v).objectText,"'; text-align: ").concat(y(v).objectTextAlign,"; font-size: ").concat(y(v).objectTextTextSize,"%; white-space: pre-line;")),!y(O)&&y(u).reqCTextColorIsOn?e.push("color: ".concat(Si(y(u).reqFilterCTextColor),";")):y(j)&&y(u).selCTextColorIsOn?e.push("color: ".concat(Si(y(u).selFilterCTextColor),";")):e.push("color: ".concat(Si(y(v).objectTextColor),";")),e.push("padding: ".concat(y(p).objectTextPadding,"px;")),e.join(" ")}),z=te(()=>{const e=y(p).objectBorderRadiusIsPixels?"px":"%";let o=0,i=0,n=0,l=[];if(y(p).objectBorderImage&&l.push("border-image: url('".concat(y(p).objectBorderImage,"') ").concat(y(p).objectBorderImageSliceTop," ").concat(y(p).objectBorderImageSliceRight," ").concat(y(p).objectBorderImageSliceBottom," ").concat(y(p).objectBorderImageSliceLeft," / ").concat(y(p).objectBorderImageWidth,"px ").concat(y(p).objectBorderImageRepeat,"; border-style: solid; padding: ").concat(y(p).objectBorderImageWidth,"px;")),y(c).objectBackgroundImage&&(l.push("background-image: url('".concat(y(c).objectBackgroundImage,"'); ").concat(y(c).isObjectBackgroundRepeat?"background-repeat: repeat;":y(c).isObjectBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;")),o=l.length),y(c).objectBgColorIsOn&&(l.push("background-color: ".concat(Si(y(c).objectBgColor),";")),i=l.length),l.push("margin: ".concat(y(p).objectMargin,"px;")),l.push("border-radius: ".concat(y(p).objectBorderRadiusTopLeft).concat(e," ").concat(y(p).objectBorderRadiusTopRight).concat(e," ").concat(y(p).objectBorderRadiusBottomRight).concat(e," ").concat(y(p).objectBorderRadiusBottomLeft).concat(e,";")),y(p).objectOverflowIsOn&&l.push("overflow: hidden;"),y(p).objectBorderIsOn||y(j)&&y(u).selBorderColorIsOn||!y(O)&&y(u).reqBorderColorIsOn){let e=y(p).objectBorderColor;!y(O)&&y(u).reqBorderColorIsOn?e=y(u).reqFilterBorderColor:y(j)&&y(u).selBorderColorIsOn&&(e=y(u).selFilterBorderColor),l.push("border: ".concat(y(p).objectBorderWidth,"px ").concat(y(p).objectBorderStyle," ").concat(Si(e),";"))}return y(p).objectDropShadowIsOn&&(y(p).objectUseBoxShadowIsOn?l.push("box-shadow: ".concat(y(p).objectDropShadowH,"px ").concat(y(p).objectDropShadowV,"px ").concat(y(p).objectDropShadowBlur,"px ").concat(Si(y(p).objectDropShadowColor),";")):(n=l.length,l.push("filter: drop-shadow(".concat(y(p).objectDropShadowH,"px ").concat(y(p).objectDropShadowV,"px ").concat(y(p).objectDropShadowBlur,"px ").concat(Si(y(p).objectDropShadowColor),")")))),0===n&&(l.push("filter:"),n=l.length),y(O)?(y(j)?(y(u).selFilterBlurIsOn&&l.push(" blur(".concat(y(u).selFilterBlur,"px)")),y(u).selFilterBrightIsOn&&l.push(" brightness(".concat(y(u).selFilterBright,"%)")),y(u).selFilterContIsOn&&l.push(" contrast(".concat(y(u).selFilterCont,"%)")),y(u).selFilterGrayIsOn&&l.push(" grayscale(".concat(y(u).selFilterGray,"%)")),y(u).selFilterHueIsOn&&l.push(" hue-rotate(".concat(y(u).selFilterHue,"deg)")),y(u).selFilterInvertIsOn&&l.push(" invert(".concat(y(u).selFilterInvert,"%)")),y(u).selFilterOpacIsOn&&l.push(" opacity(".concat(y(u).selFilterOpac,"%)")),y(u).selFilterSaturIsOn&&l.push(" saturate(".concat(y(u).selFilterSatur,")")),y(u).selFilterSepiaIsOn&&l.push(" sepia(".concat(y(u).selFilterGray,"%)")),l.length===n?l.splice(n-1,1):l.push(";"),y(u).selBgColorIsOn&&(0!==i&&l.splice(i-1,1),y(u).selOverlayOnImage||0!==o&&l.splice(o-1,1),l.push("background-color: ".concat(Si(y(u).selFilterBgColor),";"))),y(p).objectGradientIsOn&&l.push("background-image: linear-gradient(".concat(y(p).objectGradientOnSelect,");"))):(y(u).unselFilterBlurIsOn&&l.push(" blur(".concat(y(u).unselFilterBlur,"px)")),y(u).unselFilterBrightIsOn&&l.push(" brightness(".concat(y(u).unselFilterBright,"%)")),y(u).unselFilterContIsOn&&l.push(" contrast(".concat(y(u).unselFilterCont,"%)")),y(u).unselFilterGrayIsOn&&l.push(" grayscale(".concat(y(u).unselFilterGray,"%)")),y(u).unselFilterHueIsOn&&l.push(" hue-rotate(".concat(y(u).unselFilterHue,"deg)")),y(u).unselFilterInvertIsOn&&l.push(" invert(".concat(y(u).unselFilterInvert,"%)")),y(u).unselFilterOpacIsOn&&l.push(" opacity(".concat(y(u).unselFilterOpac,"%)")),y(u).unselFilterSaturIsOn&&l.push(" saturate(".concat(y(u).unselFilterSatur,")")),y(u).unselFilterSepiaIsOn&&l.push(" sepia(".concat(y(u).unselFilterGray,"%)")),l.length===n?l.splice(n-1,1):l.push(";"),y(p).objectGradientIsOn&&l.push("background-image: linear-gradient(".concat(y(p).objectGradient,");"))),app.isPointerCursor&&!t.choice.isNotSelectable&&(!t.choice.isSelectableMultiple||t.choice.allowSelectByClick&&0===t.choice.multipleUseVariable)&&l.push("cursor: pointer;")):(y(u).reqFilterBlurIsOn&&l.push(" blur(".concat(y(u).reqFilterBlur,"px)")),y(u).reqFilterBrightIsOn&&l.push(" brightness(".concat(y(u).reqFilterBright,"%)")),y(u).reqFilterContIsOn&&l.push(" contrast(".concat(y(u).reqFilterCont,"%)")),y(u).reqFilterGrayIsOn&&l.push(" grayscale(".concat(y(u).reqFilterGray,"%)")),y(u).reqFilterHueIsOn&&l.push(" hue-rotate(".concat(y(u).reqFilterHue,"deg)")),y(u).reqFilterInvertIsOn&&l.push(" invert(".concat(y(u).reqFilterInvert,"%)")),y(u).reqFilterOpacIsOn&&l.push(" opacity(".concat(y(u).reqFilterOpac,"%)")),y(u).reqFilterSaturIsOn&&l.push(" saturate(".concat(y(u).reqFilterSatur,")")),y(u).reqFilterSepiaIsOn&&l.push(" sepia(".concat(y(u).reqFilterGray,"%)")),l.length===n?l.splice(n-1,1):l.push(";"),y(u).reqBgColorIsOn&&(0!==i&&l.splice(i-1,1),y(u).reqOverlayOnImage||0!==o&&l.splice(o-1,1),l.push("background-color: ".concat(Si(y(u).reqFilterBgColor),";"))),y(p).objectGradientIsOn&&l.push("background-image: linear-gradient(".concat(y(p).objectGradientOnReq,");"))),l.join(" ")}),G=te(()=>{let e=[];const o=y(m).objectImgBorderRadiusIsPixels?"px":"%";return e.push("width: ".concat(y(m).objectImageWidth,"%; margin-top: ").concat(y(m).objectImageMarginTop,"%; margin-bottom: ").concat(y(m).objectImageMarginBottom,"%;")),y(m).objectImgObjectFillIsOn&&e.push("object-fit: ".concat(y(m).objectImgObjectFillStyle,"; height: ").concat(t.row.objectImgObjectFillHeight,"px;")),e.push("border-radius: ".concat(y(m).objectImgBorderRadiusTopLeft).concat(o," ").concat(y(m).objectImgBorderRadiusTopRight).concat(o," ").concat(y(m).objectImgBorderRadiusBottomRight).concat(o," ").concat(y(m).objectImgBorderRadiusBottomLeft).concat(o,";")),y(m).objectImgOverflowIsOn&&e.push("overflow: hidden;"),y(m).objectImgBorderIsOn&&e.push("border: ".concat(y(m).objectImgBorderWidth,"px ").concat(y(m).objectImgBorderStyle," ").concat(Si(y(m).objectImgBorderColor),";")),e.join(" ")}),H=te(()=>{let e=[];return e.push("font-family: '".concat(y(v).scoreText,"'; font-size: ").concat(y(v).scoreTextSize,"%; text-align: ").concat(y(v).scoreTextAlign,";")),e.push("color: ".concat(Si(y(v).scoreTextColor),";")),y(O)?t.choice.isActive&&y(u).selScoreTextColorIsOn&&e.push("color: ".concat(Si(y(u).selFilterSTextColor))):y(u).reqScoreTextColorIsOn&&e.push("color: ".concat(Si(y(u).reqFilterSTextColor))),e.join(" ")}),_=[];function Y(e,t,o,i){let n=!1;if(t.activateOtherChoice&&void 0!==t.activateThisChoice&&-1===r.indexOf(e.id)&&t.activateThisChoice.split(",").some(t=>t.split("/ON#")[0]===e.id)&&(r.push(e.id),n=!0),t.isSelectableMultiple){if(t.isMultipleUseVariable&&void 0!==t.numMultipleTimesMinus&&void 0!==t.numMultipleTimesPluss){let n=t.multipleUseVariable;if(i>0)for(let l=0;l<i;l++)re(t,o),n++,e.isAllowDeselect||(t.numMultipleTimesMinus+=1);else if(i<0)for(let l=0;l>-1*i;l++)se(t,o),n--,e.isAllowDeselect||(t.numMultipleTimesPluss-=1);if(t.multipleUseVariable!==n){const o=Math.abs(t.numMultipleTimesMinus-t.numMultipleTimesPluss);if(t.numMultipleTimesMinus>t.numMultipleTimePluss){const n=Ct.get(t.id);i>0?(t.numMultipleTimesMinus-=o,void 0!==n?n.multiple+=o:Ct.set(t.id,{multiple:o,isAllowDeselect:e.isAllowDeselect||!1})):i<0&&(void 0!==n?n.multiple-=o:Ct.set(t.id,{multiple:-o,isAllowDeselect:e.isAllowDeselect||!1}))}}}}else t.isActive||ne(t,o),e.isAllowDeselect||(t.forcedActivated=!0),void 0===t.activatedFrom&&(t.activatedFrom=0),n||t.activatedFrom++;t.isActive||(delete t.forcedActivated,Ct.set(t.id,{multiple:i,isAllowDeselect:e.isAllowDeselect||!1}))}function Z(e,t,o,i){if(t.activateOtherChoice&&void 0!==t.activateThisChoice&&-1===r.indexOf(e.id)&&t.activateThisChoice.split(",").some(t=>t.split("/ON#")[0]===e.id)&&r.push(e.id),t.isSelectableMultiple){if(t.isMultipleUseVariable&&void 0!==t.numMultipleTimesMinus&&void 0!==t.numMultipleTimesPluss)if(t.isActive){if(i>0)for(let n=0;n<i;n++)e.isAllowDeselect||(t.numMultipleTimesMinus-=1),e.isNotDeactivate||se(t,o);else if(i<0)for(let n=0;n>-1*i;n++)e.isAllowDeselect||(t.numMultipleTimesPluss+=1),e.isNotDeactivate||re(t,o)}else{const o=Ct.get(t.id);let n=0;void 0!==o?(n=o.multiple-i,0===n?Ct.delete(t.id):Ct.set(t.id,{multiple:n,isAllowDeselect:e.isAllowDeselect||!1})):Ct.delete(t.id)}}else void 0!==t.activatedFrom?(t.activatedFrom--,t.activatedFrom<=0&&(t.isActive?(delete t.activatedFrom,delete t.forcedActivated,e.isNotDeactivate||le(t,o)):Ct.delete(t.id))):(delete t.forcedActivated,!e.isNotDeactivate&&t.isActive&&le(t,o))}function Q(e){if(void 0!==e.activateThisChoice){let t=e.activateThisChoice.split(","),o=new Map;for(let e=0;e<t.length;e++){let[i,n="0"]=t[e].split("/ON#"),l=parseInt(n),a=Ot.get(i);if(void 0!==a)for(let e=0;e<a.elements.length;e++)St.has(a.elements[e])||o.set(a.elements[e],l);else St.has(i)||o.set(i,l)}let i=[...o.keys()],n=Math.min(i.length,e.numActivateRandom||0),l=n;for(let e=i.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[i[e],i[t]]=[i[t],i[e]]}let a=[];for(let r=0;r<n;){let t=i[r],s=At.get(t);if(void 0!==s){let c=s.row,d=s.choice;if(Y(e,d,c,o.get(t)||0),!d.isActive){if(a.length<n&&i.length>l){i[r]=i[l++],void 0!==d.activatedFrom&&(d.activatedFrom--,0===d.activatedFrom&&Ct.delete(d.id));continue}break}a.push(t)}r++}e.isSelectableMultiple?(void 0===e.activatedRandomMul&&(e.activatedRandomMul=[]),e.activatedRandomMul[e.multipleUseVariable-1]=[...a]):e.activatedRandom=[...a]}}function ee(e,t,o,i=new Set){Array.from(St.entries()).forEach(([l])=>{const a=At.get(l);if(void 0!==a){const l=a.row,r=a.choice,s=new n,c=new Set;let d=!1,u=!1;for(let o=0;o<r.scores.length;o++){const a=r.scores[o];if(!a.isNotRecalculatable){const o=xt.get(a.id);if(void 0!==o){if(e.discountOther&&a.isChangeDiscount&&void 0!==a.tmpDisScore&&a.appliedDiscount){const t=r.multipleUseVariable;if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){for(let e=t-1;e>=0;e--)r.isActive&&(o.belowZeroNotAllowed&&o.startingSum+a.tmpDisScore<0?r.forcedActivated&&r.isActive?(r.forcedActivated=!1,r.numMultipleTimesMinus--,se(r,l),r.forcedActivated=!0):se(r,l):o.startingSum+=a.tmpDisScore);r.isActive&&(s.set(a.id,a.tmpDisScore),delete a.isChangeDiscount,delete a.tmpDisScore)}else if(!r.isSelectableMultiple)if(o.belowZeroNotAllowed&&o.startingSum+a.tmpDisScore<0)if(r.forcedActivated&&(delete r.forcedActivated,r.isAllowDeselect||Ct.set(r.id,{multiple:r.multipleUseVariable})),r.isSelectableMultiple&&r.isMultipleUseVariable)for(let e=0;e<r.multipleUseVariable;e++)r.isActive&&se(r,l);else r.isActive&&le(r,l);else o.startingSum+=a.tmpDisScore,s.set(a.id,a.tmpDisScore),delete a.isChangeDiscount,delete a.tmpDisScore;d=e.id!==r.id,delete a.appliedDiscount}else if(!a.appliedDiscount&&a.discountIsOn&&void 0!==a.discountScore&&a.discountedFrom&&a.discountedFrom.length>0){const e=At.get(a.discountedFrom[0]);if(void 0!==e){const t=e.choice;if(t.discountCount&&void 0!==t.numDiscountChoices&&t.discountCount>t.numDiscountChoices){const e=r.multipleUseVariable;let i=a.value;if(void 0!==a.tmpDiscount)for(let t=0;t<a.tmpDiscount.length;t++)i>a.tmpDiscount[t].discountedValue&&(i=a.tmpDiscount[t].discountedValue);let n=i-a.discountScore;if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus)for(let t=e-1;t>=0;t--)r.isActive&&(o.belowZeroNotAllowed&&o.startingSum+n<0?r.forcedActivated&&r.isActive?(r.forcedActivated=!1,r.numMultipleTimesMinus--,se(r,l),r.forcedActivated=!0):se(r,l):o.startingSum+=n);else if(!r.isSelectableMultiple)if(o.belowZeroNotAllowed&&o.startingSum+n<0)if(r.forcedActivated&&(delete r.forcedActivated,r.isAllowDeselect||Ct.set(r.id,{multiple:r.multipleUseVariable})),r.isSelectableMultiple&&r.isMultipleUseVariable)for(let t=0;t<r.multipleUseVariable;t++)r.isActive&&se(r,l);else r.isActive&&le(r,l);else o.startingSum+=n,s.set(a.id,n);r.isActive&&(u=!0,a.appliedDiscount=!0,c.add(t))}}}if(!i.has(a.idx)){const c=e.scores.length>0,u=e.scores.length||1;for(let g=0;g<u;g++){const u=c?e.scores[g]:null,m=u&&t.get(u.id)||0,h=u?xt.get(u.id):null;if((!c||c&&h)&&r.isActive){const t=yo(a.requireds),c=new n(JSON.parse(JSON.stringify([...St])));c.set(e.id,{multiple:e.multipleUseVariable}),l.currentChoices+=1,h&&(h.startingSum+=m);const u=yo(a.requireds,c);if(l.currentChoices-=1,h&&(h.startingSum-=m),u!==t){let e=a.discountIsOn&&void 0!==a.discountScore?a.discountScore:a.value;if(e=o.allowFloat?e:Math.floor(e),u)if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){for(let t=r.multipleUseVariable-1;t>=0;t--)void 0!==a.isActiveMul&&a.isActiveMul[t]&&(o.belowZeroNotAllowed&&o.startingSum+e<0?r.forcedActivated&&r.isActive?(r.forcedActivated=!1,r.numMultipleTimesMinus--,se(r,l),r.forcedActivated=!0):se(r,l):(o.startingSum+=e,s.set(a.id,e),a.isActiveMul[t]=!1))}else r.isSelectableMultiple||a.isActive&&(o.belowZeroNotAllowed&&o.startingSum+e<0?(r.forcedActivated&&delete r.forcedActivated,le(r,l)):(o.startingSum+=e,s.set(a.id,e),delete a.isActive));else if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){const t=r.multipleUseVariable;void 0===a.isActiveMul&&(a.isActiveMul=[]);for(let i=t-1;i>=0;i--)a.isActiveMul[i]||(o.belowZeroNotAllowed&&o.startingSum+e<0?r.forcedActivated&&r.isActive?(r.forcedActivated=!1,r.numMultipleTimesMinus--,se(r,l),r.forcedActivated=!0):se(r,l):(o.startingSum-=e,s.set(a.id,e),a.isActiveMul[i]=!0))}else r.isSelectableMultiple||a.isActive||(o.belowZeroNotAllowed&&o.startingSum-e<0?(r.forcedActivated&&delete r.forcedActivated,le(r,l)):(o.startingSum-=e,s.set(a.id,e),a.isActive=!0));d||(d=!0),i.add(a.idx)}}}}}}}u&&c.size>0&&c.forEach(e=>{void 0!==e.numDiscountChoices&&(e.numDiscountChoices+=1)}),(d||u)&&(0===_.length?_.push("Scores Updated On: ".concat(r.title)):_.push(", ".concat(r.title)),ee(r,s,o+1,i))}}),0===o&&(_.length>0&&!app.hideScoresUpdated&&(Wt.labelText=_.join(""),Wt.isOpen=!0),_.splice(0))}function oe(e,t,o,i=new Set){Array.from(St.entries()).forEach(([l])=>{const a=At.get(l);if(void 0!==a){const l=a.row,r=a.choice,s=new n;let c=!1,d=!1;e.useDiscountCount&&void 0===e.numDiscountChoices&&(e.numDiscountChoices=0);for(let o=0;o<r.scores.length;o++){const a=r.scores[o];if(!a.isNotRecalculatable){const o=xt.get(a.id);if(void 0!==o){if(e.discountOther&&a.isChangeDiscount&&void 0!==a.tmpDisScore&&r.id!==e.id){const t=r.multipleUseVariable;if(!e.useDiscountCount||e.useDiscountCount&&e.discountCount&&e.discountCount>e.numDiscountChoices){if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){for(let e=t-1;e>=0;e--)r.isActive&&(o.belowZeroNotAllowed&&o.startingSum+a.tmpDisScore<0?r.forcedActivated&&r.isActive?(r.forcedActivated=!1,r.numMultipleTimesMinus--,se(r,l),r.forcedActivated=!0):se(r,l):o.startingSum+=a.tmpDisScore);r.isActive&&(s.set(a.id,a.tmpDisScore),delete a.isChangeDiscount,delete a.tmpDisScore)}else r.isSelectableMultiple||(o.belowZeroNotAllowed&&o.startingSum+a.tmpDisScore<0?(r.forcedActivated&&delete r.forcedActivated,le(r,l)):(o.startingSum+=a.tmpDisScore,s.set(a.id,a.tmpDisScore),delete a.isChangeDiscount,delete a.tmpDisScore));0===_.length?_.push("Scores Updated On: ".concat(r.title)):_.push(", ".concat(r.title)),d=!0,r.isActive&&(a.appliedDiscount=!0,c=!0)}}if(!i.has(a.idx)){const c=e.scores.length>0,u=e.scores.length||1;for(let g=0;g<u;g++){const u=c?e.scores[g]:null,m=u&&t.get(u.id)||0,h=u?xt.get(u.id):null;if((!c||c&&h)&&r.isActive&&!a.isChanged){const t=yo(a.requireds),c=new n(JSON.parse(JSON.stringify([...St])));c.delete(e.id),l.currentChoices-=1,h&&(h.startingSum+=m);const u=yo(a.requireds,c);if(l.currentChoices+=1,h&&(h.startingSum-=m),u!==t){console.log(r.id);let e=a.discountIsOn&&void 0!==a.discountScore?a.discountScore:a.value;if(e=o.allowFloat?e:Math.floor(e),u)if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){for(let t=r.multipleUseVariable-1;t>=0;t--)void 0!==a.isActiveMul&&a.isActiveMul[t]&&(o.belowZeroNotAllowed&&o.startingSum+e<0?r.forcedActivated&&r.isActive?(r.forcedActivated=!1,r.numMultipleTimesMinus--,se(r,l),r.forcedActivated=!0):se(r,l):(o.startingSum+=e,s.set(a.id,e),a.isActiveMul[t]=!1))}else r.isSelectableMultiple||a.isActive&&(o.belowZeroNotAllowed&&o.startingSum+e<0?(r.forcedActivated&&delete r.forcedActivated,le(r,l)):(o.startingSum+=e,s.set(a.id,e),delete a.isActive));else if(r.isSelectableMultiple&&r.isMultipleUseVariable&&void 0!==r.numMultipleTimesMinus){const t=r.multipleUseVariable;void 0===a.isActiveMul&&(a.isActiveMul=[]);for(let i=t-1;i>=0;i--)a.isActiveMul[i]||(o.belowZeroNotAllowed&&o.startingSum+e<0?r.forcedActivated&&r.isActive?(r.forcedActivated=!1,r.numMultipleTimesMinus--,se(r,l),r.forcedActivated=!0):se(r,l):(o.startingSum-=e,s.set(a.id,e),a.isActiveMul[i]=!0))}else r.isSelectableMultiple||a.isActive||(o.belowZeroNotAllowed&&o.startingSum-e<0?(r.forcedActivated&&delete r.forcedActivated,le(r,l)):(o.startingSum-=e,s.set(a.id,e),a.isActive=!0));d||(0===_.length?_.push("Scores Updated On: ".concat(r.title)):_.push(", ".concat(r.title)),d=!0),i.add(a.idx)}}}}}}}c&&void 0!==e.numDiscountChoices&&(e.numDiscountChoices+=1),d&&oe(r,s,o+1,i)}}),0===o&&(_.length>0&&!app.hideScoresUpdated&&(Wt.labelText=_.join(""),Wt.isOpen=!0),_.splice(0))}function ie(){let e=!1;Array.from(Ct.entries()).forEach(([t,o])=>{const i=At.get(t);if(void 0!==i){const n=i.row,l=i.choice;l.isActive||(ne(l,n),l.isActive&&(Ct.delete(t),e=!0,o.isAllowDeselect||(l.forcedActivated=!0)))}}),e&&ie()}function ne(e,o,i){let n=o;if(o.isResultRow||o.isGroupRow){const t=At.get(e.id);void 0!==t&&(n=t.row)}if(e.isSelectableMultiple){if(e.id===t.choice.id&&e.allowSelectByClick&&0===e.multipleUseVariable){if(i&&i.target){const e=i.target;if(e.classList.contains("counter-icons")||e.classList.contains("mdi-plus"))return}re(e,n)}}else!yo(e.requireds)||o.isInfoRow||e.isNotSelectable||e.forcedActivated||(e.isActive?e.selectOnce||le(e,n):ae(e,n))}function le(e,t){if(Do(e,!1)){const o=()=>{const o=new n;let i=new Set;for(let t=0;t<e.scores.length;t++){const n=e.scores[t];if(yo(n.requireds)&&n.isActive||n.isActive){const e=xt.get(n.id);if(void 0!==e){let t=n.value;if(n.discountIsOn&&void 0!==n.discountScore&&n.appliedDiscount){if(n.discountedFrom&&n.discountedFrom.length>0){const e=At.get(n.discountedFrom[0]);if(void 0!==e){const t=e.choice;t.useDiscountCount&&void 0!==t.discountCount&&void 0!==t.numDiscountChoices&&i.add(t)}}t=n.discountScore}t=e.allowFloat?t:Math.floor(t),e.startingSum+=t;let l=o.get(n.id);void 0!==l?o.set(n.id,-t+l):o.set(n.id,-t),delete n.isActive,delete n.setValue}}}if(i.size>0&&i.forEach(e=>{void 0!==e.numDiscountChoices&&(e.numDiscountChoices-=1)}),e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.isActivateRandom&&void 0!==e.activatedRandom){for(let t=0;t<e.activatedRandom.length;t++){const o=At.get(e.activatedRandom[t]);if(void 0!==o){const t=o.row,i=o.choice;Z(e,i,t,0)}}delete e.activatedRandom}else{const t=e.activateThisChoice.split(",");for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.row,o=l.choice;Z(e,o,t,n)}else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.elements;for(let t=0;t<o.length;t++){const i=At.get(o[t]);if(void 0!==i){const t=i.row,o=i.choice;Z(e,o,t,n)}}}}}}if(e.discountOther){if(void 0!==e.discountOperator&&void 0!==e.discountValue)if(void 0===e.discountPointTypes&&(e.discountPointTypes=[]),e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let o=0;o<e.discountRows.length;o++){const i=Bt.get(e.discountRows[o]);if(void 0!==i)for(let o=0;o<i.objects.length;o++){const n=i.objects[o];for(let t=0;t<n.scores.length;t++){const o=n.scores[t];o.isNotDiscountable||0!==e.discountPointTypes.length&&-1===e.discountPointTypes.indexOf(o.id)||Mo(e,o)}t.add(n.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const i=At.get(e.discountChoices[o]);if(void 0!==i){const o=i.choice;for(let n=0;n<o.scores.length;n++){const o=i.choice.scores[n];o.isNotDiscountable||0!==e.discountPointTypes.length&&-1===e.discountPointTypes.indexOf(o.id)||t.has(o.idx)||Mo(e,o)}}}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Ot.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=At.get(o.elements[t]);if(void 0!==i)for(let t=0;t<i.choice.scores.length;t++){const o=i.choice.scores[t];o.isNotDiscountable||0!==e.discountPointTypes.length&&-1===e.discountPointTypes.indexOf(o.id)||Mo(e,o)}}}delete e.numDiscountChoices}if(e.isActive=!1,t.currentChoices-=1,St.delete(e.id),Array.from(St.entries()).forEach(([t,o])=>{const i=At.get(t);if(void 0!==i){const t=i.row,n=i.choice;if(n.id!==e.id&&!yo(n.requireds))if(n.forcedActivated&&(delete n.forcedActivated,n.isAllowDeselect||Ct.set(n.id,{multiple:o.multiple})),0===o.multiple)n.isActive&&le(n,t);else if(o.multiple>0)for(let e=0;e<o.multiple;e++)n.isActive&&se(n,t)}}),e.multiplyPointtypeIsOnCheck&&void 0!==e.pointTypeToMultiply){let t=0;for(let o=0;o<e.pointTypeToMultiply.length;o++){let i=xt.get(e.pointTypeToMultiply[o]);if(void 0!==i){for(let n=Pt.length-1;n>=0;n--){let l=Pt[n];if(l.multiplyPointtypeIsOnCheck&&void 0!==l.startingSumAtMultiply){let e=l.startingSumAtMultiply[o].value*l.startingSumAtMultiply[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=l.startingSumAtMultiply[o].value}if(l.dividePointtypeIsOnCheck&&void 0!==l.startingSumAtDivide){let e=l.startingSumAtDivide[o].value/l.startingSumAtDivide[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=l.startingSumAtDivide[o].value}if(l.id===e.id){t=n;break}}for(let e=t+1;e<Pt.length;e++){let t=Pt[e];t.multiplyPointtypeIsOnCheck&&void 0!==t.startingSumAtMultiply&&(t.startingSumAtMultiply[o].value=i.startingSum,i.startingSum*=t.startingSumAtMultiply[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)),t.dividePointtypeIsOnCheck&&void 0!==t.startingSumAtDivide&&(t.startingSumAtDivide[o].value=i.startingSum,i.startingSum/=t.startingSumAtDivide[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum))}}}delete e.multiplyPointtypeIsOnCheck,delete e.startingSumAtMultiply,e.dividePointtypeIsOnCheck||Pt.splice(t,1)}if(e.dividePointtypeIsOnCheck&&void 0!==e.pointTypeToDivide){let t=0;for(let o=0;o<e.pointTypeToDivide.length;o++){let i=xt.get(e.pointTypeToDivide[o]);if(void 0!==i){for(let n=Pt.length-1;n>=0;n--){let l=Pt[n];if(l.multiplyPointtypeIsOnCheck&&void 0!==l.startingSumAtMultiply){let e=l.startingSumAtMultiply[o].value*l.startingSumAtMultiply[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=l.startingSumAtMultiply[o].value}if(l.dividePointtypeIsOnCheck&&void 0!==l.startingSumAtDivide){let e=l.startingSumAtDivide[o].value/l.startingSumAtDivide[o].calcVal;e=i.allowFloat?e:Math.floor(e),i.startingSum-=e,i.startingSum+=l.startingSumAtDivide[o].value}if(l.id===e.id){t=n;break}}for(let e=t+1;e<Pt.length;e++){let t=Pt[e];t.multiplyPointtypeIsOnCheck&&void 0!==t.startingSumAtMultiply&&(t.startingSumAtMultiply[o].value=i.startingSum,i.startingSum*=t.startingSumAtMultiply[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)),t.dividePointtypeIsOnCheck&&void 0!==t.startingSumAtDivide&&(t.startingSumAtDivide[o].value=i.startingSum,i.startingSum/=t.startingSumAtDivide[o].calcVal,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum))}}}delete e.dividePointtypeIsOnCheck,delete e.startingSumAtDivide,Pt.splice(t,1)}if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Ft.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!1:"2"===e.changeType?o.isTrue=!0:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const o=Bt.get(e.idOfAllowChoice[t]);if(void 0!==o&&(o.allowedChoices-=e.numbAddToAllowChoice,o.allowedChoices>0&&o.currentChoices>=o.allowedChoices))for(let e=0;e<o.objects.length;e++){const t=o.objects[e];if(t.isActive&&!t.forcedActivated)if(t.isSelectableMultiple){let e=t.multipleUseVariable;for(let i=0;i<e;i++)se(t,o)}else le(t,o);if(o.allowedChoices>=o.currentChoices)break}}if(e.textfieldIsOn&&void 0!==e.idOfTheTextfieldWord&&void 0!==e.wordChangeSelect){const t=Mt.get(e.idOfTheTextfieldWord);void 0!==t&&(t.replaceText=void 0===e.wordChangeDeselect?"":e.wordChangeDeselect)}if(e.isImageUpload&&void 0!==e.defaultImage&&(e.image=e.defaultImage),e.backpackBtnRequirement&&void 0!==app.btnBackpackIsOn&&(app.btnBackpackIsOn-=1),e.showAllAddons&&void 0!==app.showAllAddons&&(app.showAllAddons-=1),e.changeBackground)if(e.changeBgImage){if(void 0!==app.bgImageStack){const t=app.bgImageStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgImageStack.splice(t,1);const o=app.bgImageStack.length;o>0?app.styling.backgroundImage=app.bgImageStack[o-1].data:(app.styling.backgroundImage=void 0!==app.defaultBgImage?app.defaultBgImage:"",delete app.bgImageStack)}}else if(void 0!==e.changedBgColorCode&&void 0!==app.bgColorStack){const t=app.bgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgColorStack.splice(t,1);const o=app.bgColorStack.length;o>0?app.styling.backgroundColor=app.bgColorStack[o-1].data:(app.styling.backgroundColor=void 0!==app.defaultBgColor?app.defaultBgColor:"#FFFFFFFF",delete app.bgColorStack)}if(e.changePointBar){if(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&void 0!==app.barBgColorStack){const t=app.barBgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barBgColorStack.splice(t,1);const o=app.barBgColorStack.length;o>0?app.styling.barBackgroundColor=app.barBgColorStack[o-1].data:(app.styling.barBackgroundColor=void 0!==app.defaultBarBgColor?app.defaultBarBgColor:"#FFFFFFFF",delete app.barBgColorStack)}if(e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&void 0!==app.barIconColorStack){const t=app.barIconColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barIconColorStack.splice(t,1);const o=app.barIconColorStack.length;o>0?app.styling.barIconColor=app.barIconColorStack[o-1].data:(app.styling.barIconColor=void 0!==app.defaultBarIconColor?app.defaultBarIconColor:"#0000008A",delete app.barIconColorStack)}if(e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&void 0!==app.barTextColorStack){const t=app.barTextColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barTextColorStack.splice(t,1);const o=app.barTextColorStack.length;o>0?app.styling.barTextColor=app.barTextColorStack[o-1].data:(app.styling.barTextColor=void 0!==app.defaultBarIconColor?app.defaultBarIconColor:"#000000",delete app.barTextColorStack)}}if(e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;if(wi(t,e.id),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){wi(t.addons[o],e.id)}continue}const l=Bt.get(i);if(void 0!==l){wi(l,e.id);continue}const a=Ot.get(i[0]);if(void 0!==a){const t=a.rowElements;for(let i=0;i<t.length;i++){const o=Bt.get(t[i]);void 0!==o&&wi(o,e.id)}const o=a.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){wi(t.choice,e.id)}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){Ii(n.choice,e.id);continue}const l=Bt.get(i);if(void 0!==l){Ii(l,e.id);continue}const a=Ot.get(i[0]);if(void 0!==a){const t=a.rowElements;for(let i=0;i<t.length;i++){const o=Bt.get(t[i]);void 0!==o&&Ii(o,e.id)}const o=a.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){Ii(t.choice,e.id)}}continue}}}if(e.setBgmIsOn&&Vt&&e.bgmId&&(Lt.bgmIsPlaying=!1,xo(e,e.bgmId,0)),e.muteBgm&&Vt){const e=d(Vt);app.isMute=!1,e&&"function"==typeof e.unMute&&e.unMute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Bt.get(e.hiddenContentsRow[t]);if(void 0!==o)for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":delete o.objectTitleRemoved;break;case"2":delete o.objectImageRemoved;break;case"3":delete o.objectTextRemoved;break;case"4":delete o.objectScoreRemoved;break;case"5":delete o.objectRequirementRemoved;break;case"6":delete o.addonTitleRemoved;break;case"7":delete o.addonImageRemoved;break;case"8":delete o.addonTextRemoved}}delete e.tempSlots,ee(e,o,0),ie()};-1===r.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,o()},1e3*app.fadeTransitionTime)):o()),0===r.indexOf(e.id)&&r.splice(0)}}function ae(e,o){let i=!0;if(o.allowedChoices>0&&o.currentChoices>=o.allowedChoices){let e=0;for(let t=0;t<o.objects.length;t++){const i=o.objects[t];if(i.isActive){if(!i.forcedActivated){if(i.isSelectableMultiple){let e=i.multipleUseVariable;for(let t=0;t<e;t++)ne(i,o)}else ne(i,o);break}e++}}e>=o.allowedChoices&&(i=!1)}if(i){for(let t=0;t<e.scores.length;t++){const o=e.scores[t],i=xt.get(o.id);void 0!==i&&o.isRandom&&!o.setValue&&void 0!==o.maxValue&&void 0!==o.minValue&&(o.value=Math.floor(Math.random()*(o.maxValue-o.minValue+1))+o.minValue,o.value=i.allowFloat?o.value:Math.floor(o.value),o.setValue=!0)}if(Do(e,!0)){const i=()=>{var i,l,a,r,s,c;const u=new n;if(e.isActive=!0,St.set(e.id,{multiple:0}),o.currentChoices+=1,e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue)if(e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let o=0;o<e.discountRows.length;o++){const n=Bt.get(e.discountRows[o]);if(void 0!==n)for(let o=0;o<n.objects.length;o++){const a=n.objects[o];for(let t=0;t<a.scores.length;t++){const o=a.scores[t];o.isNotDiscountable||0!==(null==(i=e.discountPointTypes)?void 0:i.length)&&-1===(null==(l=e.discountPointTypes)?void 0:l.indexOf(o.id))||Fo(e,o)}t.add(a.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const t=At.get(e.discountChoices[o]);if(void 0!==t){const o=t.choice;for(let t=0;t<o.scores.length;t++){const i=o.scores[t];i.isNotDiscountable||0!==(null==(a=e.discountPointTypes)?void 0:a.length)&&-1===(null==(r=e.discountPointTypes)?void 0:r.indexOf(i.id))||Fo(e,i)}}}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Ot.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=At.get(o.elements[t]);if(void 0!==i)for(let t=0;t<i.choice.scores.length;t++){const o=i.choice.scores[t];o.isNotDiscountable||0!==(null==(s=e.discountPointTypes)?void 0:s.length)&&-1===(null==(c=e.discountPointTypes)?void 0:c.indexOf(o.id))||Fo(e,o)}}}let g=new Set;for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(yo(o.requireds)&&!o.isActive){const e=xt.get(o.id);if(void 0!==e){let t=o.value;if(o.discountIsOn&&void 0!==o.discountScore&&o.discountedFrom&&o.discountedFrom.length>0){const e=At.get(o.discountedFrom[0]);if(void 0!==e){const i=e.choice;if(i.useDiscountCount&&void 0!==i.discountCount){if(void 0===i.numDiscountChoices&&(i.numDiscountChoices=0),i.discountCount>i.numDiscountChoices)g.add(i),t=o.discountScore,o.appliedDiscount=!0;else if(void 0!==o.tmpDiscount)for(let e=0;e<o.tmpDiscount.length;e++)t>o.tmpDiscount[e].discountedValue&&(t=o.tmpDiscount[e].discountedValue)}else t=o.discountScore,o.appliedDiscount=!0}}t=e.allowFloat?t:Math.floor(t),e.startingSum-=t,o.isActive=!0;let i=u.get(o.id);void 0!==i?u.set(o.id,t+i):u.set(o.id,t)}}}if(g.size>0&&g.forEach(e=>{void 0!==e.numDiscountChoices&&(e.numDiscountChoices+=1)}),e.duplicateRow&&void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace&&No(e),e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.isActivateRandom)Q(e);else{const t=e.activateThisChoice.split(",");for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.row,o=l.choice;Y(e,o,t,n)}else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.elements;for(let t=0;t<o.length;t++){const i=At.get(o[t]);if(void 0!==i){const t=i.row,o=i.choice;Y(e,o,t,n)}}}}}}if(e.deactivateOtherChoice&&void 0!==e.deactivateThisChoice){const t=e.deactivateThisChoice.split(",");for(let e=0;e<t.length;e++){const o=t[e].split("/ON#"),i=o.length>1?parseInt(o[1]):0,n=At.get(o[0]);if(void 0!==n){const e=n.row,t=n.choice;if(t.isActive)if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let o=0;o<i;o++)se(t,e);else le(t,e)}else{const e=Ot.get(o[0]);if(void 0!==e){const t=e.elements;for(let e=0;e<t.length;e++){const o=At.get(t[e]);if(void 0!==o){const e=o.row,t=o.choice;if(t.isActive)if(t.isSelectableMultiple&&t.isMultipleUseVariable)for(let o=0;o<i;o++)se(t,e);else le(t,e)}}}}}}if(Array.from(St.entries()).forEach(([t,o])=>{const i=At.get(t);if(void 0!==i){const t=i.row,n=i.choice;if(n.id!==e.id&&!yo(n.requireds))if(n.forcedActivated&&(delete n.forcedActivated,n.isAllowDeselect||Ct.set(n.id,{multiple:o.multiple})),0===o.multiple)n.isActive&&le(n,t);else if(o.multiple>0)for(let e=0;e<o.multiple;e++)n.isActive&&se(n,t)}}),e.multiplyPointtypeIsOn&&void 0!==e.pointTypeToMultiply&&void 0!==e.multiplyWithThis){let t=0;e.multiplyPointtypeIsOnCheck=!0,"object"!=typeof e.startingSumAtMultiply&&(e.startingSumAtMultiply=[]);for(let o=0;o<e.pointTypeToMultiply.length;o++){let i=xt.get(e.pointTypeToMultiply[o]);if(void 0!==i)if(e.multiplyPointtypeIsId&&"string"==typeof e.multiplyWithThis){let n=xt.get(e.multiplyWithThis);void 0!==n?(e.startingSumAtMultiply[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum*=n.startingSum,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)):t++}else"number"==typeof e.multiplyWithThis&&(e.startingSumAtMultiply[o]={value:i.startingSum,calcVal:e.multiplyWithThis},i.startingSum*=e.multiplyWithThis,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum));else t++}t===e.pointTypeToMultiply.length&&delete e.multiplyPointtypeIsOnCheck,e.multiplyPointtypeIsOnCheck&&Pt.push(e)}if(e.dividePointtypeIsOn&&void 0!==e.pointTypeToDivide&&void 0!==e.divideWithThis){let t=0;e.dividePointtypeIsOnCheck=!0,"object"!=typeof e.startingSumAtDivide&&(e.startingSumAtDivide=[]);for(let o=0;o<e.pointTypeToDivide.length;o++){let i=xt.get(e.pointTypeToDivide[o]);if(void 0!==i)if(e.dividePointtypeIsId&&"string"==typeof e.divideWithThis){let n=xt.get(e.divideWithThis);void 0!==n?0===n.startingSum?t++:(e.startingSumAtDivide[o]={value:i.startingSum,calcVal:n.startingSum},i.startingSum/=n.startingSum,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)):t++}else"number"==typeof e.divideWithThis&&(0===e.dividedWithThis?t++:(e.startingSumAtDivide[o]={value:i.startingSum,calcVal:e.divideWithThis},i.startingSum/=e.divideWithThis,i.startingSum=i.allowFloat?i.startingSum:Math.floor(i.startingSum)));else t++}t===e.pointTypeToDivide.length&&delete e.dividePointtypeIsOnCheck,!e.multiplyPointtypeIsOnCheck&&e.dividePointtypeIsOnCheck&&Pt.push(e)}if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Ft.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!0:"2"===e.changeType?o.isTrue=!1:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const o=Bt.get(e.idOfAllowChoice[t]);if(void 0!==o&&(o.allowedChoices+=e.numbAddToAllowChoice,o.allowedChoices>0&&o.currentChoices>=o.allowedChoices))for(let e=0;e<o.objects.length;e++){const t=o.objects[e];if(t.isActive&&!t.forcedActivated)if(t.isSelectableMultiple){let e=t.multipleUseVariable;for(let i=0;i<e;i++)se(t,o)}else le(t,o);if(o.allowedChoices>=o.currentChoices)break}}if(e.textfieldIsOn&&void 0!==e.idOfTheTextfieldWord&&void 0!==e.wordChangeSelect){const t=Mt.get(e.idOfTheTextfieldWord);void 0!==t&&(t.replaceText=e.wordChangeSelect)}if(e.isImageUpload&&(e.defaultImage=e.image,Nt.currentDialog="appImageUpload",Nt.data=e,Nt.imgProp="image"),e.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),e.showAllAddons&&(app.showAllAddons+=1),e.changeBackground&&(e.changeBgImage?void 0!==e.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=void 0!==app.styling.backgroundImage?app.styling.backgroundImage:""),app.bgImageStack.push({id:e.id,data:e.bgImage}),app.styling.backgroundImage=e.bgImage):void 0!==e.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=void 0!==app.styling.backgroundColor?app.styling.backgroundColor:""),app.bgColorStack.push({id:e.id,data:e.changedBgColorCode}),app.styling.backgroundColor=e.changedBgColorCode)),e.changePointBar&&(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=void 0!==app.styling.barBackgroundColor?app.styling.barBackgroundColor:"#FFFFFFFF"),app.barBgColorStack.push({id:e.id,data:e.changedBarBgColor}),app.styling.barBackgroundColor=e.changedBarBgColor),e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=void 0!==app.styling.barIconColor?app.styling.barIconColor:"#0000008A"),app.barIconColorStack.push({id:e.id,data:e.changedBarIconColor}),app.styling.barIconColor=e.changedBarIconColor),e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=void 0!==app.styling.barTextColor?app.styling.barTextColor:"#000000"),app.barTextColorStack.push({id:e.id,data:e.changedBarTextColor}),app.styling.barTextColor=e.changedBarTextColor)),e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;if(bi(t,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){bi(t.addons[o],e.id,e.changeToThisTemplate)}continue}const l=Bt.get(i);if(void 0!==l){bi(l,e.id,e.changeToThisTemplate);continue}const a=Ot.get(i[0]);if(void 0!==a){const t=a.rowElements;for(let i=0;i<t.length;i++){const o=Bt.get(t[i]);void 0!==o&&bi(o,e.id,e.changeToThisTemplate)}const o=a.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){bi(t.choice,e.id,e.changeToThisTemplate)}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){Ti(n.choice,e.id,e.changeToThisWidth);continue}const l=Bt.get(i);if(void 0!==l){Ti(l,e.id,e.changeToThisWidth);continue}const a=Ot.get(i[0]);if(void 0!==a){const t=a.rowElements;for(let i=0;i<t.length;i++){const o=Bt.get(t[i]);void 0!==o&&Ti(o,e.id,e.changeToThisWidth)}const o=a.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){Ti(t.choice,e.id,e.changeToThisWidth)}}continue}}}if(e.setBgmIsOn&&e.bgmId&&(Lt.bgmIsPlaying=!0,Lt.isBgmInit?xo(e,e.bgmId,0):(Bo(e),Lt.isBgmInit=!0)),e.muteBgm&&Vt){const e=d(Vt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Bt.get(e.hiddenContentsRow[t]);if(void 0!==o){o.textIsRemoved||(o.textIsRemoved=!0);for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!0;break;case"2":o.objectImageRemoved=!0;break;case"3":o.objectTextRemoved=!0;break;case"4":o.objectScoreRemoved=!0;break;case"5":o.objectRequirementRemoved=!0;break;case"6":o.addonTitleRemoved=!0;break;case"7":o.addonImageRemoved=!0;break;case"8":o.addonTextRemoved=!0}}}e.scrollToRow&&J().then(()=>{setTimeout(()=>{var o,i,n,l,a;if(e.scrollToObject){if(e.scrollObjectId){const a=At.get(e.scrollObjectId);if(void 0!==a){const e=a.choice,r=a.row,s=null==(l=null==(n=null==(i=null==(o=t.mainDiv)?void 0:o.children[r.index])?void 0:i.children[0])?void 0:n.children[1])?void 0:l.children;if(void 0!==s)if(t.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:s[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}else window.scrollTo({top:s[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}}else if(e.scrollRowId){const o=Bt.get(e.scrollRowId);if(void 0!==o){const e=null==(a=t.mainDiv)?void 0:a.children;if(void 0!==e)if(t.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:e[o.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}else window.scrollTo({top:e[o.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}},10)}),e.cleanACtivatedOnSelect&&jo(),oe(e,u,0),ie(),!yo(e.requireds)&&e.isActive&&le(e,o)};if(e.customTextfieldIsOn&&!C)return s.choice=e,s.row=o,s.context=void 0!==e.wordPromptText?e.wordPromptText:"",s.prevText=void 0!==e.wordChangeSelect?e.wordChangeSelect:"",s.isWord=!0,void x(w,"dlgCommon");if(e.confirmIsOn&&!C)return s.choice=e,s.row=o,s.context=void 0!==e.wordPromptText?e.wordPromptText:"",s.isWord=!1,void x(w,"dlgCommon");-1===r.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,i()},1e3*app.fadeTransitionTime)):i()),0===r.indexOf(e.id)&&r.splice(0)}}}function re(e,o){const i=yo(e.requireds)&&!o.isInfoRow&&!e.isNotSelectable;let l=!0,a=o;if(o.isResultRow){const t=At.get(e.id);void 0!==t&&(a=t.row)}if(i&&e.isMultipleUseVariable&&a.allowedChoices>0&&a.currentChoices>=a.allowedChoices){let e=0;for(let t=0;t<a.objects.length;t++){const o=a.objects[t];if(o.isActive){if(!o.forcedActivated){if(o.isSelectableMultiple){let e=o.multipleUseVariable;for(let t=0;t<e;t++)se(o,a)}else ne(o,a);break}e++}}e>=a.allowedChoices&&(l=!1)}if(l){for(let t=0;t<e.scores.length;t++){const o=e.scores[t],i=xt.get(o.id);void 0!==i&&o.isRandom&&!o.setValue&&void 0!==o.maxValue&&void 0!==o.minValue&&(o.value=Math.floor(Math.random()*(o.maxValue-o.minValue+1))+o.minValue,o.value=i.allowFloat?o.value:Math.floor(o.value),o.setValue=!0)}if(Do(e,!0)){const l=()=>{var i,l,r,s,c,u;const g=new n,m=e.isActive,h=e.multipleUseVariable>=0,p=Math.abs(e.multipleUseVariable);if(e.multipleUseVariable+=1,0===e.multipleUseVariable?(St.delete(e.id),e.isActive=!1,a.currentChoices-=1):(1===e.multipleUseVariable&&(e.isActive=!0,a.currentChoices+=1),St.set(e.id,{multiple:e.multipleUseVariable})),h){if(e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue&&(e.stackableDiscount||!e.stackableDiscount&&1===e.multipleUseVariable))if(e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let o=0;o<e.discountRows.length;o++){const n=Bt.get(e.discountRows[o]);if(void 0!==n)for(let o=0;o<n.objects.length;o++){const a=n.objects[o];for(let t=0;t<a.scores.length;t++){const o=a.scores[t];o.isNotDiscountable||0!==(null==(i=e.discountPointTypes)?void 0:i.length)&&-1===(null==(l=e.discountPointTypes)?void 0:l.indexOf(o.id))||Fo(e,o)}t.add(a.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const t=At.get(e.discountChoices[o]);if(void 0!==t){const o=t.choice;for(let t=0;t<o.scores.length;t++){const i=o.scores[t];i.isNotDiscountable||0!==(null==(r=e.discountPointTypes)?void 0:r.length)&&-1===(null==(s=e.discountPointTypes)?void 0:s.indexOf(i.id))||Fo(e,i)}}}}else if(void 0!==e.discountGroups)for(let o=0;o<e.discountGroups.length;o++){const t=Ot.get(e.discountGroups[o]);if(void 0!==t)for(let o=0;o<t.elements.length;o++){const i=At.get(t.elements[o]);if(void 0!==i)for(let t=0;t<i.choice.scores.length;t++){const o=i.choice.scores[t];o.isNotDiscountable||0!==(null==(c=e.discountPointTypes)?void 0:c.length)&&-1===(null==(u=e.discountPointTypes)?void 0:u.indexOf(o.id))||Fo(e,o)}}}let t=new Set;for(let o=0;o<e.scores.length;o++){const i=e.scores[o];if(void 0===i.isActiveMul&&(i.isActiveMul=[]),yo(i.requireds)&&!i.isActiveMul[p]){const e=xt.get(i.id);if(void 0!==e){let o=i.value;if(i.discountIsOn&&void 0!==i.discountScore&&i.discountedFrom&&i.discountedFrom.length>0){const e=At.get(i.discountedFrom[0]);if(void 0!==e){const n=e.choice;if(n.useDiscountCount&&void 0!==n.discountCount){if(void 0===n.numDiscountChoices&&(n.numDiscountChoices=0),n.discountCount>n.numDiscountChoices)t.add(n),o=i.discountScore,i.appliedDiscount=!0;else if(void 0!==i.tmpDiscount)for(let e=0;e<i.tmpDiscount.length;e++)o>i.tmpDiscount[e].discountedValue&&(o=i.tmpDiscount[e].discountedValue)}else o=i.discountScore,i.appliedDiscount=!0}}o=e.allowFloat?o:Math.floor(o),i.multiplyByTimes&&(o*=p+1),e.startingSum-=o,i.isActiveMul[p]=!0;let n=g.get(i.id);void 0!==n?g.set(i.id,o+n):g.set(i.id,o)}}}t.size>0&&t.forEach(e=>{void 0!==e.numDiscountChoices&&(e.numDiscountChoices+=1)})}else for(let t=0;t<e.scores.length;t++){const o=e.scores[t];if(void 0===o.isActiveMulMinus&&(o.isActiveMulMinus=[]),yo(o.requireds)&&o.isActiveMulMinus[p]||o.isActiveMulMinus[p]){const e=xt.get(o.id);if(void 0!==e){let t=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value;t=e.allowFloat?t:Math.floor(t),o.multiplyByTimes&&(t*=Math.abs(p)),e.startingSum-=t;let i=g.get(o.id);void 0!==i?g.set(o.id,t+i):g.set(o.id,t),delete o.isActiveMulMinus[p]}}}if(h&&(e.duplicateRow&&void 0!==e.duplicateRowId&&void 0!==e.duplicateRowPlace&&No(e),e.activateOtherChoice&&void 0!==e.activateThisChoice))if(e.isActivateRandom)Q(e);else{const t=e.activateThisChoice.split(",");for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=i.length>1?parseInt(i[1]):0,l=At.get(i[0]);if(void 0!==l){const t=l.row,o=l.choice;!o.isSelectableMultiple&&m||Y(e,o,t,n)}else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.elements;for(let t=0;t<o.length;t++){const i=At.get(o[t]);if(void 0!==i){const t=i.row,o=i.choice;!o.isSelectableMultiple&&m||Y(e,o,t,n)}}}}}}if(Array.from(St.entries()).forEach(([t,o])=>{const i=At.get(t);if(void 0!==i){const t=i.row,n=i.choice;if(n.id!==e.id&&!yo(n.requireds))if(n.forcedActivated&&(delete n.forcedActivated,n.isAllowDeselect||Ct.set(n.id,{multiple:o.multiple})),0===o.multiple)n.isActive&&le(n,t);else if(o.multiple>0)for(let e=0;e<o.multiple;e++)n.isActive&&se(n,t)}}),e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let t=0;t<e.idOfAllowChoice.length;t++){const o=Bt.get(e.idOfAllowChoice[t]);if(void 0!==o&&(o.allowedChoices+=e.numbAddToAllowChoice,o.allowedChoices>0&&o.currentChoices>=o.allowedChoices))for(let e=0;e<o.objects.length;e++){const t=o.objects[e];if(t.isActive&&!t.forcedActivated)if(t.isSelectableMultiple){let e=t.multipleUseVariable;for(let i=0;i<e;i++)se(t,o)}else t.isActive&&le(t,o);if(o.allowedChoices>=o.currentChoices)break}}if(!m){if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Ft.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!0:"2"===e.changeType?o.isTrue=!1:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.backpackBtnRequirement&&(app.btnBackpackIsOn+=1),e.showAllAddons&&(app.showAllAddons+=1),e.changeBackground&&(e.changeBgImage?void 0!==e.bgImage&&(void 0===app.bgImageStack&&(app.bgImageStack=[],app.defaultBgImage=void 0!==app.styling.backgroundImage?app.styling.backgroundImage:""),app.bgImageStack.push({id:e.id,data:e.bgImage}),app.styling.backgroundImage=e.bgImage):void 0!==e.changedBgColorCode&&(void 0===app.bgColorStack&&(app.bgColorStack=[],app.defaultBgColor=void 0!==app.styling.backgroundColor?app.styling.backgroundColor:""),app.bgColorStack.push({id:e.id,data:e.changedBgColorCode}),app.styling.backgroundColor=e.changedBgColorCode)),e.changePointBar&&(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&(void 0===app.barBgColorStack&&(app.barBgColorStack=[],app.defaultBarBgColor=void 0!==app.styling.barBackgroundColor?app.styling.barBackgroundColor:"#FFFFFFFF"),app.barBgColorStack.push({id:e.id,data:e.changedBarBgColor}),app.styling.barBackgroundColor=e.changedBarBgColor),e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&(void 0===app.barIconColorStack&&(app.barIconColorStack=[],app.defaultBarIconColor=void 0!==app.styling.barIconColor?app.styling.barIconColor:"#0000008A"),app.barIconColorStack.push({id:e.id,data:e.changedBarIconColor}),app.styling.barIconColor=e.changedBarIconColor),e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&(void 0===app.barTextColorStack&&(app.barTextColorStack=[],app.defaultBarTextColor=void 0!==app.styling.barTextColor?app.styling.barTextColor:"#000000"),app.barTextColorStack.push({id:e.id,data:e.changedBarTextColor}),app.styling.barTextColor=e.changedBarTextColor)),e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;if(bi(t,e.id,e.changeToThisTemplate),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){bi(t.addons[o],e.id,e.changeToThisTemplate)}continue}const l=Bt.get(i);if(void 0!==l){bi(l,e.id,e.changeToThisTemplate);continue}const a=Ot.get(i[0]);if(void 0!==a){const t=a.rowElements;for(let i=0;i<t.length;i++){const o=Bt.get(t[i]);void 0!==o&&bi(o,e.id,e.changeToThisTemplate)}const o=a.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){bi(t.choice,e.id,e.changeToThisTemplate)}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){Ti(n.choice,e.id,e.changeToThisWidth);continue}const l=Bt.get(i);if(void 0!==l){Ti(l,e.id,e.changeToThisWidth);continue}const a=Ot.get(i[0]);if(void 0!==a){const t=a.rowElements;for(let i=0;i<t.length;i++){const o=Bt.get(t[i]);void 0!==o&&Ti(o,e.id,e.changeToThisWidth)}const o=a.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){Ti(t.choice,e.id,e.changeToThisWidth)}}continue}}}if(e.setBgmIsOn&&e.bgmId&&(Lt.bgmIsPlaying=!0,Lt.isBgmInit?xo(e,e.bgmId,0):(Bo(e),Lt.isBgmInit=!0)),e.muteBgm&&Vt){const e=d(Vt);app.isMute=!0,e&&"function"==typeof e.mute&&e.mute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Bt.get(e.hiddenContentsRow[t]);if(void 0!==o){o.textIsRemoved||(o.textIsRemoved=!0);for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!0;break;case"2":o.objectImageRemoved=!0;break;case"3":o.objectTextRemoved=!0;break;case"4":o.objectScoreRemoved=!0;break;case"5":o.objectRequirementRemoved=!0;break;case"6":o.addonTitleRemoved=!0;break;case"7":o.addonImageRemoved=!0;break;case"8":o.addonTextRemoved=!0}}}if(e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;t.defaultTemplate&&(t.defaultTemplate=t.template),t.template=e.changeToThisTemplate,e.changeAddonTemplate}else{const t=Bt.get(i);if(void 0!==t)t.defaultTemplate=t.template,t.template=e.changeToThisTemplate;else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.rowElements;for(let t=0;t<o.length;t++){const i=Bt.get(o[t]);void 0!==i&&(i.defaultTemplate=i.template,i.template=e.changeToThisTemplate)}const i=t.elements;for(let t=0;t<i.length;t++){const o=At.get(i[t]);if(void 0!==o){const t=o.choice;t.defaultTemplate=t.template,t.template=e.changeToThisTemplate}}}}}}}e.scrollToRow&&J().then(()=>{setTimeout(()=>{var o,i,n,l,a;if(e.scrollToObject){if(e.scrollObjectId){const a=At.get(e.scrollObjectId);if(void 0!==a){const e=a.choice,r=a.row,s=null==(l=null==(n=null==(i=null==(o=t.mainDiv)?void 0:o.children[r.index])?void 0:i.children[0])?void 0:n.children[1])?void 0:l.children;if(void 0!==s)if(t.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:s[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}else window.scrollTo({top:s[e.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}}else if(e.scrollRowId){const o=Bt.get(e.scrollRowId);if(void 0!==o){const e=null==(a=t.mainDiv)?void 0:a.children;if(void 0!==e)if(t.isBackpack){const t=document.getElementById("backpackDialog");null==t||t.scrollTo({top:e[o.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}else window.scrollTo({top:e[o.index].getBoundingClientRect().top+window.scrollY,behavior:"smooth"})}}},10)})}oe(e,g,0),ie(),!yo(e.requireds)&&e.isActive&&se(e,o)};if(i)if(e.isMultipleUseVariable)void 0===e.multipleUseVariable&&(e.multipleUseVariable=0),void 0===e.numMultipleTimesPluss&&(e.numMultipleTimesPluss=0),e.numMultipleTimesPluss>e.multipleUseVariable&&(-1===r.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,l()},1e3*app.fadeTransitionTime)):l()),0===r.indexOf(e.id)&&r.splice(0));else if(void 0!==e.multipleScoreId){const t=xt.get(e.multipleScoreId);void 0!==t&&(void 0===e.numMultipleTimesPluss&&(e.numMultipleTimesPluss=0),e.numMultipleTimesPluss>t.startingSum&&(t.startingSum+=1))}}}}function se(e,t){const o=Do(e,!1);let i=t;if(t.isResultRow){const t=At.get(e.id);void 0!==t&&(i=t.row)}if(o){const o=()=>{const t=new n,o=e.multipleUseVariable>0,l=Math.abs(e.multipleUseVariable-1);if(o){for(let o=0;o<e.scores.length;o++){const i=e.scores[o];if(void 0!==i.isActiveMul&&(yo(i.requireds)&&i.isActiveMul[l]||i.isActiveMul[l])){const e=xt.get(i.id);if(void 0!==e){let o=i.discountIsOn&&void 0!==i.discountScore?i.discountScore:i.value;o=e.allowFloat?o:Math.floor(o),i.multiplyByTimes&&(o*=l+1),e.startingSum+=o;let n=t.get(i.id);void 0!==n?t.set(i.id,-o+n):t.set(i.id,-o),delete i.isActiveMul[l],0===l&&delete i.setValue}}}if(e.activateOtherChoice&&void 0!==e.activateThisChoice)if(e.isActivateRandom&&void 0!==e.activatedRandomMul&&void 0!==e.activatedRandomMul[l]){for(let t=0;t<e.activatedRandomMul[l].length;t++){const o=At.get(e.activatedRandomMul[l][t]);if(void 0!==o){const t=o.row,i=o.choice;Z(e,i,t,0)}}e.activatedRandomMul.splice(l,1)}else{const t=e.activateThisChoice.split(",");for(let o=0;o<t.length;o++){const i=t[o].split("/ON#"),n=i.length>1?parseInt(i[1]):0,a=At.get(i[0]);if(void 0!==a){const t=a.row,o=a.choice;(0===l||o.isSelectableMultiple)&&Z(e,o,t,n)}else{const t=Ot.get(i[0]);if(void 0!==t){const o=t.elements;for(let t=0;t<o.length;t++){const i=At.get(o[t]);if(void 0!==i){const t=i.row,o=i.choice;(0===l||o.isSelectableMultiple)&&Z(e,o,t,n)}}}}}}if(e.discountOther&&void 0!==e.discountOperator&&void 0!==e.discountValue&&(e.stackableDiscount||!e.stackableDiscount&&1===e.multipleUseVariable))if(void 0===e.discountPointTypes&&(e.discountPointTypes=[]),e.isDisChoices){const t=new Set;if(void 0!==e.discountRows)for(let o=0;o<e.discountRows.length;o++){const i=Bt.get(e.discountRows[o]);if(void 0!==i)for(let o=0;o<i.objects.length;o++){const n=i.objects[o];for(let t=0;t<n.scores.length;t++){const o=n.scores[t];o.isNotDiscountable||0!==e.discountPointTypes.length&&-1===e.discountPointTypes.indexOf(o.id)||Mo(e,o)}t.add(n.id)}}if(void 0!==e.discountChoices)for(let o=0;o<e.discountChoices.length;o++)if(!t.has(e.discountChoices[o])){const i=At.get(e.discountChoices[o]);if(void 0!==i){const o=i.choice;for(let n=0;n<o.scores.length;n++){const o=i.choice.scores[n];o.isNotDiscountable||0!==e.discountPointTypes.length&&-1===e.discountPointTypes.indexOf(o.id)||t.has(o.idx)||Mo(e,o)}}}}else if(void 0!==e.discountGroups)for(let t=0;t<e.discountGroups.length;t++){const o=Ot.get(e.discountGroups[t]);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=At.get(o.elements[t]);if(void 0!==i)for(let t=0;t<i.choice.scores.length;t++){const o=i.choice.scores[t];o.isNotDiscountable||0!==e.discountPointTypes.length&&-1===e.discountPointTypes.indexOf(o.id)||Mo(e,o)}}}}else for(let i=0;i<e.scores.length;i++){const o=e.scores[i];if(void 0===o.isActiveMulMinus&&(o.isActiveMulMinus=[]),yo(o.requireds)&&!o.isActiveMulMinus[l]){const e=xt.get(o.id);if(void 0!==e){let i=o.discountIsOn&&void 0!==o.discountScore?o.discountScore:o.value;i=e.allowFloat?i:Math.floor(i),o.multiplyByTimes&&(i*=l),e.startingSum+=i;let n=t.get(o.id);void 0!==n?t.set(o.id,-i+n):t.set(o.id,-i),o.isActiveMulMinus[l]=!0}}}if(e.multipleUseVariable-=1,0===e.multipleUseVariable?(e.isActive=!1,i.currentChoices-=1,St.delete(e.id)):(-1===e.multipleUseVariable&&(e.isActive=!0,i.currentChoices+=1),St.set(e.id,{multiple:e.multipleUseVariable})),Array.from(St.entries()).forEach(([t,o])=>{const i=At.get(t);if(void 0!==i){const t=i.row,n=i.choice;if(n.id!==e.id&&!yo(n.requireds))if(n.forcedActivated&&(delete n.forcedActivated,n.isAllowDeselect||Ct.set(n.id,{multiple:o.multiple})),0===o.multiple)n.forcedActivated&&delete n.forcedActivated,n.isActive&&le(n,t);else if(o.multiple>0)for(let e=0;e<o.multiple;e++)n.isActive&&se(n,t)}}),e.addToAllowChoice&&void 0!==e.idOfAllowChoice&&void 0!==e.numbAddToAllowChoice)for(let i=0;i<e.idOfAllowChoice.length;i++){const t=Bt.get(e.idOfAllowChoice[i]);if(void 0!==t&&(t.allowedChoices-=e.numbAddToAllowChoice,t.allowedChoices>0&&t.currentChoices>=t.allowedChoices))for(let e=0;e<t.objects.length;e++){const o=t.objects[e];if(o.isActive&&!o.forcedActivated)if(o.isSelectableMultiple){let e=o.multipleUseVariable;for(let i=0;i<e;i++)se(o,t)}else o.isActive&&le(o,t);if(t.allowedChoices>=t.currentChoices)break}}if(0===l){if(e.isChangeVariables&&void 0!==e.changedVariables)for(let t=0;t<e.changedVariables.length;t++){const o=Ft.get(e.changedVariables[t]);void 0!==o&&("1"===e.changeType?o.isTrue=!1:"2"===e.changeType?o.isTrue=!0:"3"===e.changeType&&(o.isTrue=!o.isTrue))}if(e.backpackBtnRequirement&&void 0!==app.btnBackpackIsOn&&(app.btnBackpackIsOn-=1),e.showAllAddons&&void 0!==app.showAllAddons&&(app.showAllAddons-=1),e.changeBackground)if(e.changeBgImage){if(void 0!==app.bgImageStack){const t=app.bgImageStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgImageStack.splice(t,1);const o=app.bgImageStack.length;o>0?app.styling.backgroundImage=app.bgImageStack[o-1].data:(app.styling.backgroundImage=void 0!==app.defaultBgImage?app.defaultBgImage:"",delete app.bgImageStack)}}else if(void 0!==e.changedBgColorCode&&void 0!==app.bgColorStack){const t=app.bgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.bgColorStack.splice(t,1);const o=app.bgColorStack.length;o>0?app.styling.backgroundColor=app.bgColorStack[o-1].data:(app.styling.backgroundColor=void 0!==app.defaultBgColor?app.defaultBgColor:"#FFFFFFFF",delete app.bgColorStack)}if(e.changePointBar){if(e.changeBarBgColorIsOn&&void 0!==e.changedBarBgColor&&void 0!==app.barBgColorStack){const t=app.barBgColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barBgColorStack.splice(t,1);const o=app.barBgColorStack.length;o>0?app.styling.barBackgroundColor=app.barBgColorStack[o-1].data:(app.styling.barBackgroundColor=void 0!==app.defaultBarBgColor?app.defaultBarBgColor:"#FFFFFFFF",delete app.barBgColorStack)}if(e.changeBarIconColorIsOn&&void 0!==e.changedBarIconColor&&void 0!==app.barIconColorStack){const t=app.barIconColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barIconColorStack.splice(t,1);const o=app.barIconColorStack.length;o>0?app.styling.barIconColor=app.barIconColorStack[o-1].data:(app.styling.barIconColor=void 0!==app.defaultBarIconColor?app.defaultBarIconColor:"#0000008A",delete app.barIconColorStack)}if(e.changeBarTextColorIsOn&&void 0!==e.changedBarTextColor&&void 0!==app.barTextColorStack){const t=app.barTextColorStack.findIndex(t=>t.id===e.id);-1!==t&&app.barTextColorStack.splice(t,1);const o=app.barTextColorStack.length;o>0?app.styling.barTextColor=app.barTextColorStack[o-1].data:(app.styling.barTextColor=void 0!==app.defaultBarIconColor?app.defaultBarIconColor:"#000000",delete app.barTextColorStack)}}if(e.changeTemplates&&e.changeTemplatesList&&e.changeToThisTemplate){const t=e.changeTemplatesList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){const t=n.choice;if(wi(t,e.id),e.changeAddonTemplate)for(let o=0;o<t.addons.length;o++){wi(t.addons[o],e.id)}continue}const l=Bt.get(i);if(void 0!==l){wi(l,e.id);continue}const a=Ot.get(i[0]);if(void 0!==a){const t=a.rowElements;for(let i=0;i<t.length;i++){const o=Bt.get(t[i]);void 0!==o&&wi(o,e.id)}const o=a.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){wi(t.choice,e.id)}}continue}}}if(e.changeWidth&&e.changeWidthList&&e.changeToThisWidth){const t=e.changeWidthList.split(",");for(let o=0;o<t.length;o++){const i=t[o],n=At.get(i);if(void 0!==n){Ii(n.choice,e.id);continue}const l=Bt.get(i);if(void 0!==l){Ii(l,e.id);continue}const a=Ot.get(i[0]);if(void 0!==a){const t=a.rowElements;for(let i=0;i<t.length;i++){const o=Bt.get(t[i]);void 0!==o&&Ii(o,e.id)}const o=a.elements;for(let i=0;i<o.length;i++){const t=At.get(o[i]);if(void 0!==t){Ii(t.choice,e.id)}}continue}}}if(e.setBgmIsOn&&Vt&&e.bgmId&&(Lt.bgmIsPlaying=!1,xo(e,e.bgmId,0)),e.muteBgm&&Vt){const e=d(Vt);app.isMute=!1,e&&"function"==typeof e.unMute&&e.unMute()}if(e.isContentHidden&&void 0!==e.hiddenContentsRow&&void 0!==e.hiddenContentsType)for(let t=0;t<e.hiddenContentsRow.length;t++){const o=Bt.get(e.hiddenContentsRow[t]);if(void 0!==o)for(let t=0;t<e.hiddenContentsType.length;t++)switch(e.hiddenContentsType[t]){case"1":o.objectTitleRemoved=!1;break;case"2":o.objectImageRemoved=!1;break;case"3":o.objectTextRemoved=!1;break;case"4":o.objectScoreRemoved=!1;break;case"5":o.objectRequirementRemoved=!1;break;case"6":o.addonTitleRemoved=!1;break;case"7":o.addonImageRemoved=!1;break;case"8":o.addonTextRemoved=!1}}}ee(e,t,0),ie()};if(!t.isInfoRow&&!e.isNotSelectable&&!e.selectOnce)if(e.isMultipleUseVariable)void 0===e.numMultipleTimesMinus&&(e.numMultipleTimesMinus=0),e.multipleUseVariable>e.numMultipleTimesMinus&&(-1===r.indexOf(e.id)&&(e.isFadeTransition?(void 0===e.fadeTransitionColor||""===e.fadeTransitionColor?app.fadeTransitionColor="000000FF":app.fadeTransitionColor=e.fadeTransitionColor,void 0===e.fadeInTransitionTime?app.fadeTransitionTime=.25:app.fadeTransitionTime=e.fadeInTransitionTime/1e3,app.fadeTransitionIsOn=!0,window.setTimeout(()=>{void 0!==e.fadeOutTransitionTime&&(app.fadeTransitionTime=e.fadeOutTransitionTime/1e3),app.fadeTransitionIsOn=!1,o()},1e3*app.fadeTransitionTime)):o()),0===r.indexOf(e.id)&&r.splice(0));else if(void 0!==e.multipleScoreId){const t=xt.get(e.multipleScoreId);void 0!==t&&(void 0===e.numMultipleTimesMinus&&(e.numMultipleTimesMinus=0),t.startingSum>e.numMultipleTimesMinus&&(t.startingSum-=1))}}}var ce=yl(),de=q(ce),ue=e=>{var o=Il(),i=B(o);let n;var r=B(i),s=B(r),c=e=>{var o=al(),i=B(o),n=e=>{var t=Xn(),o=B(t);b(o,()=>Ie.sanitize(fo(y(V).title),qt)),F(()=>ye(t,y(H))),T(e,t)};X(i,e=>{t.row.resultShowRowTitle&&e(n)});var l=K(i,2),r=e=>{var o=$(),i=q(o),n=e=>{var o=Kn();M(o,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.choice.imageSourceTooltip),F(()=>{Se(o,"src",t.choice.image),ye(o,y(G)),Se(o,"loading",a()?"eager":"lazy")}),T(e,o)},l=e=>{var o=Qn();F(()=>{Se(o,"src",t.choice.image),ye(o,y(G)),Se(o,"loading",a()?"eager":"lazy")}),T(e,o)};X(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),T(e,o)};X(l,e=>{(1===t.choice.template||t.windowWidth<=960||t.row.choicesShareTemplate)&&t.choice.image&&!t.row.objectImageRemoved&&e(r)});var s=K(l,2),c=B(s),d=e=>{var o=el(),i=B(o);b(i,()=>Ie.sanitize(fo(t.choice.title),qt)),F(()=>ye(o,y(L))),T(e,o)};X(c,e=>{""===t.choice.title||t.row.objectTitleRemoved||e(d)});var u=K(c,2),m=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(u,e=>{t.choice.isSelectableMultiple&&y(E)&&0===y(g).multiChoiceCounterPosition&&e(m)});var h=K(u,2),p=e=>{var o=$(),i=q(o);we(i,17,()=>t.choice.scores,Te,(e,o)=>{Jn(e,{get score(){return y(o)},get row(){return t.row},get choice(){return t.choice}})}),T(e,o)};X(h,e=>{t.row.objectScoreRemoved||e(p)});var v=K(h,2),f=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(v,e=>{t.choice.isSelectableMultiple&&y(E)&&1===y(g).multiChoiceCounterPosition&&e(f)});var w=K(v,2),I=e=>{var o=$(),i=q(o);we(i,17,()=>t.choice.requireds,Te,(e,t)=>{vn(e,{get required(){return y(t)},get scoreText(){return y(H)}})}),T(e,o)};X(w,e=>{t.row.objectRequirementRemoved||e(I)});var S=K(w,2),C=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(S,e=>{t.choice.isSelectableMultiple&&y(E)&&2===y(g).multiChoiceCounterPosition&&e(C)});var x=K(S,2),A=e=>{var o=$(),i=q(o),n=e=>{var o=tl();M(o,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.choice.imageSourceTooltip),F(()=>{Se(o,"src",t.choice.image),ye(o,y(G)),Se(o,"loading",a()?"eager":"lazy")}),T(e,o)},l=e=>{var o=ol();F(()=>{Se(o,"src",t.choice.image),ye(o,y(G)),Se(o,"loading",a()?"eager":"lazy")}),T(e,o)};X(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),T(e,o)};X(x,e=>{5===t.choice.template&&t.choice.image&&!t.row.objectImageRemoved&&e(A)});var D=K(x,2),j=e=>{var o=il(),i=B(o);b(i,()=>Ie.sanitize(fo(t.choice.text),qt)),F(()=>ye(o,y(U))),T(e,o)};X(D,e=>{""===t.choice.text||t.row.objectTextRemoved||e(j)});var P=K(D,2),z=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(P,e=>{t.choice.isSelectableMultiple&&y(E)&&3===y(g).multiChoiceCounterPosition&&e(z)});var _=K(P,2),Y=e=>{var o=$(),i=q(o),n=e=>{var o=nl();M(o,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.choice.imageSourceTooltip),F(()=>{Se(o,"src",t.choice.image),ye(o,y(G)),Se(o,"loading",a()?"eager":"lazy")}),T(e,o)},l=e=>{var o=ll();F(()=>{Se(o,"src",t.choice.image),ye(o,y(G)),Se(o,"loading",a()?"eager":"lazy")}),T(e,o)};X(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),T(e,o)};X(_,e=>{4===t.choice.template&&t.choice.image&&!t.row.objectImageRemoved&&e(Y)});var Z=K(s,2);we(Z,21,()=>t.choice.addons,Te,(e,o)=>{Vn(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return y(o)},get isEnabled(){return y(O)},get windowWidth(){return t.windowWidth},get preloadImages(){return a()}})});var J=K(Z,2),Q=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(J,e=>{t.choice.isSelectableMultiple&&y(E)&&4===y(g).multiChoiceCounterPosition&&e(Q)}),F(()=>{var e;return R(Z,1,"d-column pa-0 col w-100 ".concat(null!=(e=y(k))?e:""))}),T(e,o)},d=e=>{var o=$(),i=q(o),n=e=>{var o=ml(),i=q(o),n=B(i),l=e=>{var o=$(),i=q(o),n=e=>{var o=rl();M(o,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.choice.imageSourceTooltip),F(()=>{Se(o,"src",t.choice.image),ye(o,y(G)),Se(o,"loading",a()?"eager":"lazy")}),T(e,o)},l=e=>{var o=sl();F(()=>{Se(o,"src",t.choice.image),ye(o,y(G)),Se(o,"loading",a()?"eager":"lazy")}),T(e,o)};X(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),T(e,o)};X(n,e=>{t.choice.image&&!t.row.objectImageRemoved&&e(l)});var r=K(i,2),s=B(r),c=e=>{var o=cl(),i=B(o);b(i,()=>Ie.sanitize(fo(t.choice.title),qt)),F(()=>ye(o,y(L))),T(e,o)};X(s,e=>{""===t.choice.title||t.row.objectTitleRemoved||e(c)});var d=K(s,2),u=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(d,e=>{t.choice.isSelectableMultiple&&y(E)&&0===y(g).multiChoiceCounterPosition&&e(u)});var m=K(d,2),h=e=>{var o=$(),i=q(o);we(i,17,()=>t.choice.scores,Te,(e,o)=>{Jn(e,{get score(){return y(o)},get row(){return t.row},get choice(){return t.choice}})}),T(e,o)};X(m,e=>{t.row.objectScoreRemoved||e(h)});var p=K(m,2),v=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(p,e=>{t.choice.isSelectableMultiple&&y(E)&&1===y(g).multiChoiceCounterPosition&&e(v)});var w=K(p,2),I=e=>{var o=$(),i=q(o);we(i,17,()=>t.choice.requireds,Te,(e,t)=>{vn(e,{get required(){return y(t)},get scoreText(){return y(H)}})}),T(e,o)};X(w,e=>{t.row.objectRequirementRemoved||e(I)});var S=K(w,2),C=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(S,e=>{t.choice.isSelectableMultiple&&y(E)&&2===y(g).multiChoiceCounterPosition&&e(C)});var x=K(S,2),A=e=>{var o=dl(),i=B(o);b(i,()=>Ie.sanitize(fo(t.choice.text),qt)),F(()=>ye(o,y(U))),T(e,o)};X(x,e=>{""===t.choice.text||t.row.objectTextRemoved||e(A)});var D=K(x,2),j=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(D,e=>{t.choice.isSelectableMultiple&&y(E)&&3===y(g).multiChoiceCounterPosition&&e(j)});var P=K(D,2),V=e=>{var o=ul(),i=q(o);we(i,21,()=>t.choice.addons,Te,(e,o)=>{Vn(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return y(o)},get isEnabled(){return y(O)},get windowWidth(){return t.windowWidth},get preloadImages(){return a()}})});var n=K(i,2),l=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(n,e=>{t.choice.isSelectableMultiple&&y(E)&&4===y(g).multiChoiceCounterPosition&&e(l)}),F(()=>{var e;return R(i,1,"d-column pa-0 col w-100 ".concat(null!=(e=y(k))?e:""))}),T(e,o)};X(P,e=>{t.choice.useSeperateAddon||e(V)});var z=K(r,2),_=e=>{var o=gl(),i=B(o);we(i,21,()=>t.choice.addons,Te,(e,o)=>{Vn(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return y(o)},get isEnabled(){return y(O)},get windowWidth(){return t.windowWidth},get preloadImages(){return a()}})});var n=K(i,2),l=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(n,e=>{t.choice.isSelectableMultiple&&y(E)&&4===y(g).multiChoiceCounterPosition&&e(l)}),F(()=>{var e;return R(i,1,"d-column pa-0 col w-100 ".concat(null!=(e=y(k))?e:""))}),T(e,o)};X(z,e=>{t.choice.useSeperateAddon&&e(_)}),F(()=>{var e;ye(i,"max-width: ".concat(null!=(e=y(f))?e:"","%")),ye(r,"max-width: ".concat(100-y(f),"%"))}),T(e,o)},l=(e,o)=>{var i=e=>{var o=Tl(),i=q(o),n=B(i),l=e=>{var o=hl(),i=B(o);b(i,()=>Ie.sanitize(fo(t.choice.title),qt)),F(()=>ye(o,y(L))),T(e,o)};X(n,e=>{""===t.choice.title||t.row.objectTitleRemoved||e(l)});var r=K(n,2),s=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(r,e=>{t.choice.isSelectableMultiple&&y(E)&&0===y(g).multiChoiceCounterPosition&&e(s)});var c=K(r,2),d=e=>{var o=$(),i=q(o);we(i,17,()=>t.choice.scores,Te,(e,o)=>{Jn(e,{get score(){return y(o)},get row(){return t.row},get choice(){return t.choice}})}),T(e,o)};X(c,e=>{t.row.objectScoreRemoved||e(d)});var u=K(c,2),m=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(u,e=>{t.choice.isSelectableMultiple&&y(E)&&1===y(g).multiChoiceCounterPosition&&e(m)});var h=K(u,2),p=e=>{var o=$(),i=q(o);we(i,17,()=>t.choice.requireds,Te,(e,t)=>{vn(e,{get required(){return y(t)},get scoreText(){return y(H)}})}),T(e,o)};X(h,e=>{t.row.objectRequirementRemoved||e(p)});var v=K(h,2),w=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(v,e=>{t.choice.isSelectableMultiple&&y(E)&&2===y(g).multiChoiceCounterPosition&&e(w)});var I=K(v,2),S=e=>{var o=pl(),i=B(o);b(i,()=>Ie.sanitize(fo(t.choice.text),qt)),F(()=>ye(o,y(U))),T(e,o)};X(I,e=>{""===t.choice.text||t.row.objectTextRemoved||e(S)});var C=K(I,2),x=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(C,e=>{t.choice.isSelectableMultiple&&y(E)&&3===y(g).multiChoiceCounterPosition&&e(x)});var A=K(C,2),D=e=>{var o=vl(),i=q(o);we(i,21,()=>t.choice.addons,Te,(e,o)=>{Vn(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return y(o)},get isEnabled(){return y(O)},get windowWidth(){return t.windowWidth},get preloadImages(){return a()}})});var n=K(i,2),l=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(n,e=>{t.choice.isSelectableMultiple&&y(E)&&4===y(g).multiChoiceCounterPosition&&e(l)}),F(()=>{var e;return R(i,1,"d-column pa-0 col w-100 ".concat(null!=(e=y(k))?e:""))}),T(e,o)};X(A,e=>{t.choice.useSeperateAddon||e(D)});var j=K(i,2),P=B(j),V=e=>{var o=$(),i=q(o),n=e=>{var o=fl();M(o,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.choice.imageSourceTooltip),F(()=>{Se(o,"src",t.choice.image),ye(o,y(G)),Se(o,"loading",a()?"eager":"lazy")}),T(e,o)},l=e=>{var o=bl();F(()=>{Se(o,"src",t.choice.image),ye(o,y(G)),Se(o,"loading",a()?"eager":"lazy")}),T(e,o)};X(i,e=>{t.choice.imageSourceTooltip?e(n):e(l,!1)}),T(e,o)};X(P,e=>{t.choice.image&&!t.row.objectImageRemoved&&e(V)});var z=K(j,2),_=e=>{var o=wl(),i=B(o);we(i,21,()=>t.choice.addons,Te,(e,o)=>{Vn(e,{get row(){return t.row},get choice(){return t.choice},get addon(){return y(o)},get isEnabled(){return y(O)},get windowWidth(){return t.windowWidth},get preloadImages(){return a()}})});var n=K(i,2),l=e=>{const o=te(()=>y(O)&&!t.row.isInfoRow&&!t.choice.isNotSelectable);Un(e,{get isEnabled(){return y(o)},get multiChoiceButton(){return y(W)},get multiChoiceText(){return y(N)},get choice(){return t.choice},selectedOneMore:()=>re(t.choice,t.row),selectedOneLess:()=>se(t.choice,t.row)})};X(n,e=>{t.choice.isSelectableMultiple&&y(E)&&4===y(g).multiChoiceCounterPosition&&e(l)}),F(()=>{var e;return R(i,1,"d-column pa-0 col w-100 ".concat(null!=(e=y(k))?e:""))}),T(e,o)};X(z,e=>{t.choice.useSeperateAddon&&e(_)}),F(()=>{var e;ye(i,"max-width: ".concat(100-y(f),"%")),ye(j,"max-width: ".concat(null!=(e=y(f))?e:"","%"))}),T(e,o)};X(e,e=>{3===t.choice.template&&e(i)},o)};X(i,e=>{2===t.choice.template?e(n):e(l,!1)}),T(e,o)};X(s,e=>{t.choice.template>=4||1===t.choice.template||t.windowWidth<=960||t.row.choicesShareTemplate?e(c):e(d,!1)}),F((e,l)=>{var a,s;R(o,1,e),n=R(i,1,"d-flex",null,n,l),R(r,1,"row row-".concat(null!=(a=t.row.id)?a:""," choice-").concat(null!=(s=t.choice.id)?s:""," ").concat(y(j)?"choice-selected":"choice-unselected"," ").concat(y(O)?"choice-enabled":"choice-disabled"," ").concat(y(j)&&y(u).selOverlayOnImage||!y(O)&&y(u).reqOverlayOnImage?"bg-overlay":""," w-100")),ye(r,y(z))},[()=>D(function(){let e=t.choice.objectWidth||t.row.objectWidth,o=function(e){switch(e){case"col-sm-6":case"col-sm-5":return 2;case"col-md-4":return 3;case"col-md-3":return 4;case"w-20":return 5;case"col-lg-2":return 6;case"w-14":return 7;case"w-12":return 8;case"w-11":return 9;case"w-10":return 10;case"w-9":return 11;case"col-xl-1":return 12;default:return 1}}(e),i="col-6"===app.objectsPerRow?2:"col-4"===app.objectsPerRow?3:4;if(l()>1280)return e;if(!(l()>720))return l()>480?1===o?"col-12":"col-6":"col-12";switch(o){case 1:return"col-12";case 2:return"col-6";case 3:return i>2?"col-4":app.objectsPerRow;case 4:return i>3?"col-3":app.objectsPerRow;default:return app.objectsPerRow}}()),()=>({fullHeight:y(P)})]),Be("click",r,e=>ne(t.choice,t.row,e),!0),T(e,o)};X(de,e=>{!y(O)&&y(u).reqFilterVisibleIsOn||e(ue)});var ge=K(de,2),me=e=>{const t=te(()=>"dlgCommon"===y(w));Hi(e,{get open(){return y(t)},onclose:()=>x(w,"none"),title:"",get context(){return s.context},closeHandler:(e,t)=>{"accept"===e.detail.action&&s.choice&&s.row?(C=!0,s.isWord&&(s.choice.wordChangeSelect=t),ae(s.choice,s.row),C=!1):C=!1},get isWord(){return s.isWord},get prevText(){return s.prevText}})};X(ge,e=>{"dlgCommon"===y(w)&&e(me)}),T(e,ce);var he=I({activateObject:ne});return i(),he}var Cl=f('<img alt=""/>'),xl=f('<img alt=""/>'),Bl=f('<h2 class="mb-0"><!></h2>'),Al=f('<img alt=""/>'),Ol=f('<img alt=""/>'),kl=f('<p class="mb-0"><!></p>'),Ml=f('<img alt=""/>'),Fl=f('<img alt=""/>'),Rl=f('<div class="col-12 m-0 p-0"><!> <!> <!> <!> <!></div>'),Dl=f('<h2 class="mb-0"><!></h2>'),jl=f('<p class="mb-0"><!></p>'),Pl=f('<img alt=""/>'),$l=f('<img alt=""/>'),ql=f('<div class="col p-0 text-center"><!> <!></div> <div class="col p-0 text-center"><!></div>',1),Vl=f('<img alt=""/>'),Ll=f('<img alt=""/>'),Nl=f('<h2 class="mb-0"><!></h2>'),Wl=f('<p class="mb-0"><!></p>'),El=f('<div class="col p-0 text-center"><!></div> <div class="col p-0 text-center"><!> <!></div>',1),Ul=f("<div><!></div>"),zl=f("<div><!></div>"),Gl=f("<div><!> <!></div>");function Hl(e,t){h(t,!0);const o=A(t,"preloadImages",3,!1),i=A(t,"isBackpack",3,!1);let n=S(void 0),l=te(()=>bo("privateBackgroundIsOn",t.row)),a=te(()=>bo("privateRowImageIsOn",t.row)),r=te(()=>bo("privateRowIsOn",t.row)),s=te(()=>bo("privateTextIsOn",t.row)),c=S(0),d=te(()=>void 0!==y(a).rowImageBoxWidth?y(a).rowImageBoxWidth:50),u=te(()=>yo(t.row.requireds)),g=te(()=>t.row.onlyIfNoChoices&&0!==t.row.currentChoices),m=te(()=>t.row.rowJustify?"justify-".concat(t.row.rowJustify):""),v=te(()=>{const e=[];if(void 0!==t.row.resultGroupId&&""!==t.row.resultGroupId&&t.row.resultGroupId)for(const[o]of St){const i=At.get(o);if(void 0!==i){const o=i.choice,n=i.row;if(!o.isNotResult)if(t.row.resultGroupId===n.resultGroupId)e.push({choice:o,row:n});else if(void 0!==o.groups)for(let i=0;i<o.groups.length;i++)if(o.groups[i]===t.row.resultGroupId){e.push({choice:o,row:n});break}}}else for(const[t]of St){const o=At.get(t);if(void 0!==o){const t=o.choice,i=o.row;t.isNotResult||e.push({choice:t,row:i})}}return e.sort((e,t)=>e.row.index!==t.row.index?e.row.index-t.row.index:e.choice.index-t.choice.index),e}),f=te(()=>{const e=[];if(void 0!==t.row.resultGroupId){const o=Ot.get(t.row.resultGroupId);if(void 0!==o)for(let t=0;t<o.elements.length;t++){const i=At.get(o.elements[t]);void 0!==i&&e.push({choice:i.choice,row:i.row})}}return e.sort((e,t)=>e.row.index!==t.row.index?e.row.index-t.row.index:e.choice.index-t.choice.index),e}),C=te(()=>{if(void 0!==t.row.styling&&t.row.isPrivateStyling&&t.row.privateBackgroundIsOn&&t.row.styling.backgroundImage)return t.row.styling;if(void 0!==app.rowDesignGroups&&t.row.rowDesignGroups)for(let e=0;e<t.row.rowDesignGroups.length;e++){let o=Rt.get(t.row.rowDesignGroups[e]);if(void 0!==o&&o.privateBackgroundIsOn&&o.styling.backgroundImage){let e=o.activatedId,t=kt.get(e);if(""===e||To(o.activatedId))return o.styling;if(void 0!==app.globalRequirements&&void 0!==t&&yo(t.requireds))return o.styling}}return!1}),O=te(()=>{if(void 0!==t.row.styling&&t.row.isPrivateStyling&&t.row.privateBackgroundIsOn&&t.row.styling.bgColorIsOn&&t.row.styling.backgroundColor)return t.row.styling;if(void 0!==app.rowDesignGroups&&t.row.rowDesignGroups)for(let e=0;e<t.row.rowDesignGroups.length;e++){let o=Rt.get(t.row.rowDesignGroups[e]);if(void 0!==o&&o.privateBackgroundIsOn&&o.styling.bgColorIsOn&&o.styling.backgroundColor){let e=o.activatedId,t=kt.get(e);if(""===e||To(o.activatedId))return o.styling;if(void 0!==app.globalRequirements&&void 0!==t&&yo(t.requireds))return o.styling}}return!1}),k=te(()=>{let e=[];return e.push("margin: ".concat(y(r).rowBodyMarginTop,"px ").concat(y(r).rowBodyMarginSides,"% ").concat(y(r).rowBodyMarginBottom,"px ").concat(y(r).rowBodyMarginSides,"%;")),y(C)&&e.push("background-image: url('".concat(y(C).backgroundImage,"'); ").concat(y(C).isBackgroundRepeat?"background-repeat: repeat;":y(C).isBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;")),y(O)&&e.push("background-color: ".concat(Si(y(O).backgroundColor),";")),e.join(" ")}),D=te(()=>{let e=y(r).rowBorderRadiusIsPixels?"px":"%",t=[];return y(r).rowBorderImage&&t.push("border-image: url('".concat(y(r).rowBorderImage,"') ").concat(y(r).rowBorderImageSliceTop," ").concat(y(r).rowBorderImageSliceRight," ").concat(y(r).rowBorderImageSliceBottom," ").concat(y(r).rowBorderImageSliceLeft," / ").concat(y(r).rowBorderImageWidth,"px ").concat(y(r).rowBorderImageRepeat,"; border-style: solid; padding: ").concat(y(r).rowBorderImageWidth,"px;")),y(l).rowBackgroundImage&&t.push("background-image: url('".concat(y(l).rowBackgroundImage,"'); ").concat(y(l).isRowBackgroundRepeat?"background-repeat: repeat;":y(l).isRowBackgroundFitIn?"background-size: 100% 100%;":"background-size: cover;")),y(l).rowBgColorIsOn&&t.push("background-color: ".concat(Si(y(l).rowBgColor),";")),t.push("margin-left: ".concat(y(r).rowMargin,"%; margin-right: ").concat(y(r).rowMargin,"%;")),y(r).rowGradientIsOn&&t.push("background-image: linear-gradient(".concat(y(r).rowGradient,");")),t.push("border-radius: ".concat(y(r).rowBorderRadiusTopLeft).concat(e," ").concat(y(r).rowBorderRadiusTopRight).concat(e," ").concat(y(r).rowBorderRadiusBottomRight).concat(e," ").concat(y(r).rowBorderRadiusBottomLeft).concat(e,";")),y(r).rowOverflowIsOn&&t.push("overflow: hidden;"),y(r).rowBorderIsOn&&t.push("border: ".concat(y(r).rowBorderWidth,"px ").concat(y(r).rowBorderStyle," ").concat(Si(y(r).rowBorderColor),";")),y(r).rowDropShadowIsOn&&(y(r).rowUseBoxShadowIsOn?t.push("box-shadow: ".concat(y(r).rowDropShadowH,"px ").concat(y(r).rowDropShadowV,"px ").concat(y(r).rowDropShadowBlur,"px ").concat(Si(y(r).rowDropShadowColor),";")):t.push("filter: drop-shadow(".concat(y(r).rowDropShadowH,"px ").concat(y(r).rowDropShadowV,"px ").concat(y(r).rowDropShadowBlur,"px ").concat(Si(y(r).rowDropShadowColor),");"))),t.join(" ")}),j=te(()=>"font-family: '".concat(y(s).rowTitle,"'; font-size: ").concat(y(s).rowTitleTextSize,"%; text-align: ").concat(y(s).rowTitleAlign,"; color: ").concat(Si(y(s).rowTitleColor))),P=te(()=>"white-space: pre-wrap; font-family: '".concat(y(s).rowText,"'; font-size: ").concat(y(s).rowTextTextSize,"%; text-align: ").concat(y(s).rowTextAlign,"; color: ").concat(Si(y(s).rowTextColor),"; padding: ").concat(y(r).rowTextPaddingX,"px ").concat(y(r).rowTextPaddingY,"% ").concat(y(r).rowTextPaddingX,"px ").concat(y(r).rowTextPaddingY,"%;")),V=te(()=>{let e=y(a).rowImgBorderRadiusIsPixels?"px":"%",t=[];return t.push("width: ".concat(y(a).rowImageWidth,"%; margin-top: ").concat(y(a).rowImageMarginTop,"%; margin-bottoom: ").concat(y(a).rowImageMarginBottom,"%;")),t.push("border-radius: ".concat(y(a).rowImgBorderRadiusTopLeft).concat(e," ").concat(y(a).rowImgBorderRadiusTopRight).concat(e," ").concat(y(a).rowImgBorderRadiusBottomRight).concat(e," ").concat(y(a).rowImgBorderRadiusBottomLeft).concat(e,";")),y(a).rowImgOverflowIsOn&&t.push("overflow: hidden;"),y(a).rowImgBorderIsOn&&t.push("border: ".concat(y(a).rowImgBorderWidth,"px ").concat(y(a).rowImgBorderStyle," ").concat(Si(y(a).rowImgBorderColor),";")),t.join(" ")}),L=te(()=>"padding-left: ".concat(y(r).rowButtonYPadding,"px; padding-right: ").concat(y(r).rowButtonYPadding,"px; padding-top: ").concat(y(r).rowButtonXPadding,"px; padding-bottom: ").concat(y(r).rowButtonXPadding,"px;"));function N(){if(t.row.btnPointAddon&&"sumaddon"===t.row.buttonTypeRadio&&void 0!==t.row.pointTypeRandom){const e=t.row.randomMax||0,o=t.row.randomMin||0,i=Math.floor(Math.random()*(e-o)+o),n=xt.get(t.row.pointTypeRandom);return void(void 0!==n&&(n.startingSum+=i))}if(t.row.buttonRandom){const e=[],o=t.row.objects.filter(e=>yo(e.requireds)&&!e.isNotSelectable);if(t.row.isWeightedRandom){let e=0;for(let t=0;t<o.length;t++){e+=o[t].randomWeight||100}if(void 0!==t.row.buttonRandomNumber)for(let i=0;i<t.row.buttonRandomNumber;i++){const i=Math.floor(Math.random()*e);let l=0;for(let e=0;e<o.length;e++){const a=o[e];if(l+=a.randomWeight||100,i<l){y(n).activateObject(a,t.row);break}}}}else if(void 0!==t.row.buttonRandomNumber)for(let i=0;i<t.row.buttonRandomNumber;i++){let i,l,a=0,r=100;do{l=Math.floor(Math.random()*o.length),i=o[l],a++}while(t.row.onlyUnselectedChoices&&(-1!==e.indexOf(l)||St.has(i.id))&&a<r);i&&-1===e.indexOf(l)&&(e.push(l),y(n).activateObject(i,t.row))}}else if(void 0!==t.row.buttonId){const e=Ft.get(t.row.buttonId);void 0!==e&&(St.has(e.id)?t.row.buttonType&&(e.isTrue=!1,St.delete(e.id)):(e.isTrue=!0,St.set(e.id,{multiple:0,isVariable:!0})))}}p(()=>{if(t.row.deselectChoices&&!y(u))for(let e=0;e<t.row.objects.length;e++){const o=t.row.objects[e];o.isActive&&y(n).activateObject(o,t.row)}});var W=Gl(),E=B(W),U=e=>{var i=Ul(),n=B(i),l=e=>{var i=Rl(),n=B(i),l=e=>{var i=$(),n=q(i),l=e=>{const o=te(()=>!t.row.buttonType&&void 0!==t.row.buttonId&&St.has(t.row.buttonId)||y(g));he(e,{onclickcapture:N,get disabled(){return y(o)},get style(){return y(L)},variant:"raised",children:(e,o)=>{pe(e,{children:(e,o)=>{var i=$(),n=q(i);b(n,()=>void 0!==t.row.buttonText?t.row.buttonText:"Click"),T(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},a=(e,i)=>{var n=e=>{var i=$(),n=q(i),l=e=>{var i=Cl();M(i,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.row.imageSourceTooltip),F(()=>{Se(i,"src",t.row.image),ye(i,y(V)),Se(i,"loading",o()?"eager":"lazy")}),T(e,i)},a=e=>{var i=xl();F(()=>{Se(i,"src",t.row.image),ye(i,y(V)),Se(i,"loading",o()?"eager":"lazy")}),T(e,i)};X(n,e=>{t.row.imageSourceTooltip?e(l):e(a,!1)}),T(e,i)};X(e,e=>{t.row.image&&e(n)},i)};X(n,e=>{t.row.isButtonRow?e(l):e(a,!1)}),T(e,i)};X(n,e=>{(1===t.row.template||t.windowWidth<=960)&&e(l)});var a=K(n,2),r=e=>{var o=Bl(),i=B(o);b(i,()=>Ie.sanitize(fo(t.row.title),qt)),F(()=>ye(o,y(j))),T(e,o)};X(a,e=>{""!==t.row.title&&e(r)});var s=K(a,2),c=e=>{var i=$(),n=q(i),l=e=>{const o=te(()=>!t.row.buttonType&&void 0!==t.row.buttonId&&St.has(t.row.buttonId)||y(g));he(e,{onclickcapture:N,get disabled(){return y(o)},get style(){return y(L)},variant:"raised",children:(e,o)=>{pe(e,{children:(e,o)=>{var i=$(),n=q(i);b(n,()=>void 0!==t.row.buttonText?t.row.buttonText:"Click"),T(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},a=(e,i)=>{var n=e=>{var i=$(),n=q(i),l=e=>{var i=Al();M(i,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.row.imageSourceTooltip),F(()=>{Se(i,"src",t.row.image),ye(i,y(V)),Se(i,"loading",o()?"eager":"lazy")}),T(e,i)},a=e=>{var i=Ol();F(()=>{Se(i,"src",t.row.image),ye(i,y(V)),Se(i,"loading",o()?"eager":"lazy")}),T(e,i)};X(n,e=>{t.row.imageSourceTooltip?e(l):e(a,!1)}),T(e,i)};X(e,e=>{t.row.image&&e(n)},i)};X(n,e=>{t.row.isButtonRow?e(l):e(a,!1)}),T(e,i)};X(s,e=>{5===t.row.template&&e(c)});var d=K(s,2),u=e=>{var o=kl(),i=B(o);b(i,()=>Ie.sanitize(fo(t.row.titleText),qt)),F(()=>ye(o,y(P))),T(e,o)};X(d,e=>{""!==t.row.titleText&&e(u)});var m=K(d,2),h=e=>{var i=$(),n=q(i),l=e=>{const o=te(()=>!t.row.buttonType&&void 0!==t.row.buttonId&&St.has(t.row.buttonId)||y(g));he(e,{onclickcapture:N,get disabled(){return y(o)},get style(){return y(L)},variant:"raised",children:(e,o)=>{pe(e,{children:(e,o)=>{var i=$(),n=q(i);b(n,()=>void 0!==t.row.buttonText?t.row.buttonText:"Click"),T(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},a=(e,i)=>{var n=e=>{var i=$(),n=q(i),l=e=>{var i=Ml();M(i,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.row.imageSourceTooltip),F(()=>{Se(i,"src",t.row.image),ye(i,y(V)),Se(i,"loading",o()?"eager":"lazy")}),T(e,i)},a=e=>{var i=Fl();F(()=>{Se(i,"src",t.row.image),ye(i,y(V)),Se(i,"loading",o()?"eager":"lazy")}),T(e,i)};X(n,e=>{t.row.imageSourceTooltip?e(l):e(a,!1)}),T(e,i)};X(e,e=>{t.row.image&&e(n)},i)};X(n,e=>{t.row.isButtonRow?e(l):e(a,!1)}),T(e,i)};X(m,e=>{4===t.row.template&&e(h)}),T(e,i)},a=e=>{var i=$(),n=q(i),l=e=>{var i=ql(),n=q(i),l=B(n),a=e=>{var o=Dl(),i=B(o);b(i,()=>Ie.sanitize(fo(t.row.title),qt)),F(()=>ye(o,y(j))),T(e,o)};X(l,e=>{""!==t.row.title&&e(a)});var r=K(l,2),s=e=>{var o=jl(),i=B(o);b(i,()=>Ie.sanitize(fo(t.row.titleText),qt)),F(()=>ye(o,y(P))),T(e,o)};X(r,e=>{""!==t.row.titleText&&e(s)});var c=K(n,2),u=B(c),m=e=>{const o=te(()=>!t.row.buttonType&&void 0!==t.row.buttonId&&St.has(t.row.buttonId)||y(g));he(e,{onclickcapture:N,get disabled(){return y(o)},get style(){return y(L)},variant:"raised",children:(e,o)=>{pe(e,{children:(e,o)=>{var i=$(),n=q(i);b(n,()=>void 0!==t.row.buttonText?t.row.buttonText:"Click"),T(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},h=(e,i)=>{var n=e=>{var i=$(),n=q(i),l=e=>{var i=Pl();M(i,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.row.imageSourceTooltip),F(()=>{Se(i,"src",t.row.image),ye(i,y(V)),Se(i,"loading",o()?"eager":"lazy")}),T(e,i)},a=e=>{var i=$l();F(()=>{Se(i,"src",t.row.image),ye(i,y(V)),Se(i,"loading",o()?"eager":"lazy")}),T(e,i)};X(n,e=>{t.row.imageSourceTooltip?e(l):e(a,!1)}),T(e,i)};X(e,e=>{t.row.image&&e(n)},i)};X(u,e=>{t.row.isButtonRow?e(m):e(h,!1)}),F(()=>{var e;ye(n,"max-width: ".concat(100-y(d),"%")),ye(c,"max-width: ".concat(null!=(e=y(d))?e:"","%"))}),T(e,i)},a=(e,i)=>{var n=e=>{var i=El(),n=q(i),l=B(n),a=e=>{const o=te(()=>!t.row.buttonType&&void 0!==t.row.buttonId&&St.has(t.row.buttonId)||y(g));he(e,{onclickcapture:N,get disabled(){return y(o)},get style(){return y(L)},variant:"raised",children:(e,o)=>{pe(e,{children:(e,o)=>{var i=$(),n=q(i);b(n,()=>void 0!==t.row.buttonText?t.row.buttonText:"Click"),T(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})},r=(e,i)=>{var n=e=>{var i=$(),n=q(i),l=e=>{var i=Vl();M(i,(e,t)=>null==Bi?void 0:Bi(e,t),()=>t.row.imageSourceTooltip),F(()=>{Se(i,"src",t.row.image),ye(i,y(V)),Se(i,"loading",o()?"eager":"lazy")}),T(e,i)},a=e=>{var i=Ll();F(()=>{Se(i,"src",t.row.image),ye(i,y(V)),Se(i,"loading",o()?"eager":"lazy")}),T(e,i)};X(n,e=>{t.row.imageSourceTooltip?e(l):e(a,!1)}),T(e,i)};X(e,e=>{t.row.image&&e(n)},i)};X(l,e=>{t.row.isButtonRow?e(a):e(r,!1)});var s=K(n,2),c=B(s),u=e=>{var o=Nl(),i=B(o);b(i,()=>Ie.sanitize(fo(t.row.title),qt)),F(()=>ye(o,y(j))),T(e,o)};X(c,e=>{""!==t.row.title&&e(u)});var m=K(c,2),h=e=>{var o=Wl(),i=B(o);b(i,()=>Ie.sanitize(fo(t.row.titleText),qt)),F(()=>ye(o,y(P))),T(e,o)};X(m,e=>{""!==t.row.titleText&&e(h)}),F(()=>{var e;ye(n,"max-width: ".concat(null!=(e=y(d))?e:"","%")),ye(s,"max-width: ".concat(100-y(d),"%"))}),T(e,i)};X(e,e=>{3===t.row.template&&e(n)},i)};X(n,e=>{2===t.row.template?e(l):e(a,!1)}),T(e,i)};X(n,e=>{t.row.template>=4||1===t.row.template||t.windowWidth<=960?e(l):e(a,!1)}),F(()=>{var e;R(i,1,"row gx-0 row-".concat(null!=(e=t.row.id)?e:"")),ye(i,""!==t.row.title?y(D):"")}),T(e,i)};X(E,e=>{y(u)&&e(U)});var z=K(E,2),G=e=>{var l=zl(),a=B(l),r=e=>{var i=$(),l=q(i);we(l,17,()=>y(v),Te,(e,i,l)=>{w(Sl(e,{get row(){return t.row},get choice(){return y(i).choice},index:l,get windowWidth(){return t.windowWidth},get preloadImages(){return o()}}),e=>x(n,e,!0),()=>y(n))}),T(e,i)},s=(e,l)=>{var a=e=>{var l=$(),a=q(l);we(a,17,()=>y(f),Te,(e,l,a)=>{w(Sl(e,{get row(){return t.row},get choice(){return y(l).choice},index:a,get windowWidth(){return t.windowWidth},get preloadImages(){return o()},get isBackpack(){return i()},get mainDiv(){return t.mainDiv}}),e=>x(n,e,!0),()=>y(n))}),T(e,l)},r=e=>{var l=$(),a=q(l);we(a,17,()=>t.row.objects,Te,(e,l,a)=>{w(Sl(e,{get row(){return t.row},get choice(){return y(l)},index:a,get windowWidth(){return t.windowWidth},get preloadImages(){return o()},get isBackpack(){return i()},get mainDiv(){return t.mainDiv}}),e=>x(n,e,!0),()=>y(n))}),T(e,l)};X(e,e=>{t.row.isGroupRow?e(a):e(r,!1)},l)};X(a,e=>{t.row.isResultRow?e(r):e(s,!1)}),F(()=>{var e;return R(l,1,"row gx-0 m-0 p-0 ".concat(null!=(e=y(m))?e:""))}),T(e,l)};X(z,e=>{y(u)&&e(G)}),F(()=>{var e;R(W,1,"row-".concat(null!=(e=t.row.id)?e:"","-bg text-center ").concat(y(u)?"":"hidden")),ye(W,y(k))}),Oe(W,"clientWidth",e=>x(c,e)),T(e,W),I()}var _l=f('<div><span><!> <!> <span translate="no"> </span> <!> <!></span></div>');var Yl=f("<!> <!>",1),Zl=f('<div class="p-0 col-12"><!></div>'),Jl=f("<div><!></div>"),Xl=f('<div class="container-fluid p-0"><div class="row gx-0"></div></div>'),Kl=f("<!> <!> <!>",1);function Ql(e,t){h(t,!0);let o=A(t,"open",7),i=S(0),n=S(void 0),l=te(()=>{let e=[];return e.push("overflow-wrap: break-word;"),e.push("white-space: normal;"),app.styling.useBackpackDesign?(app.styling.backpackBgImage&&e.push("background-image: url('".concat(app.styling.backpackBgImage,"');")),e.push("background-color: ".concat(Si(app.styling.backpackBgColor),";")),app.styling.isBackpackBgRepeat?e.push("background-repeat: repeat;"):app.styling.isBackpackBgFitIn?e.push("background-size: 100% 100%;"):e.push("background-size: cover;")):(app.styling.backgroundImage&&e.push("background-image: url('".concat(app.styling.backgroundImage,"');")),e.push("background-color: ".concat(Si(app.styling.backgroundColor),";")),app.styling.isBackgroundRepeat?e.push("background-repeat: repeat;"):app.styling.isBackgroundFitIn?e.push("background-size: 100% 100%;"):e.push("background-size: cover;")),e.join(" ")});const a=te(()=>"dlgBackpack"!==Nt.currentDialog?"close":""),r=te(()=>"dlgBackpack"!==Nt.currentDialog?"close":""),s=te(()=>void 0!==app.styling.backPackWidth?app.styling.backPackWidth:1200);de(e,{get escapeKeyAction(){return y(a)},get scrimClickAction(){return y(r)},get surface$style(){var e;return"width: ".concat(null!=(e=y(s))?e:"","px; max-width: 100vw;")},get onSMUIDialogClosed(){return t.onclose},get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=Kl(),a=q(o);ue(a,{class:"p-0 m-0 row",tabindex:0,autofocus:!0,children:(e,t)=>{var o=Zl(),i=B(o);he(i,{onclickcapture:()=>async function(e){var t;if(e){let i=[];try{Wt.labelText="Downloading image...",Wt.isOpen=!0,pi(e),await hi(e),e.querySelectorAll("span.d-flex").forEach(e=>{const t=e;!t.style.height&&t.offsetHeight>0&&(t.style.height="".concat(t.offsetHeight+1,"px"),i.push(t))});const t=(await st.maxArea({usePromise:!0})).height,n=e.offsetHeight,l=e.offsetWidth;if(!Et.isSingleFile&&n>t){let i=0,a=1;const r=Math.ceil(n/t);for(;i<n;){const s=Math.min(t,n-i),c=document.createElement("div");Wt.labelText="Splitting large image...(".concat(a," / ").concat(r,")"),Wt.isOpen=!0,app.styling.useBackpackDesign?(app.styling.backpackBgImage&&(c.style.backgroundImage=app.styling.backpackBgImage),app.styling.backpackBgColor&&(c.style.backgroundColor=Si(app.styling.backpackBgColor)),app.styling.isBackpackBgRepeat?c.style.backgroundRepeat="repeat":app.styling.isBackpackBgFitIn?c.style.backgroundSize="100% 100%":c.style.backgroundSize="cover"):(app.styling.backgroundImage&&(c.style.backgroundImage=app.styling.backgroundImage),app.styling.backgroundColor&&(c.style.backgroundColor=Si(app.styling.backgroundColor)),app.styling.isBackgroundRepeat?c.style.backgroundRepeat="repeat":app.styling.isBackgroundFitIn?c.style.backgroundSize="100% 100%":c.style.backgroundSize="cover"),e.parentElement&&e.parentElement.classList.contains("mdc-dialog__content")&&c.classList.add("backpack-wrapper"),c.style.width="".concat(l,"px"),c.style.height="".concat(s,"px"),c.style.overflow="hidden",c.style.position="absolute",c.style.display="block",c.style.top="0",c.style.left="0",c.style.zIndex="-9999",c.style.pointerEvents="none";const d=e.cloneNode(!0);pi(d),d.style.position="relative",d.style.top="-".concat(i,"px"),c.appendChild(d),document.body.appendChild(c),await hi(c),await vi(c),await fi(5);try{const e=await m(c,{filter:e=>{var t,o;return!(null==(t=e.classList)?void 0:t.contains("mdc-top-app-bar"))&&!(null==(o=e.classList)?void 0:o.contains("hidden"))&&e.nodeType!==Node.COMMENT_NODE}});if(!e)throw new Error("blob creation failed");const t=URL.createObjectURL(e),o=document.createElement("a");o.href=t,o.download="Build_".concat(oo(),"_part").concat(a++,".png"),o.target="_blank",o.click(),setTimeout(()=>{URL.revokeObjectURL(t)},1e3)}catch(o){Wt.labelText="Download failed: Restricted content detected.",Wt.isOpen=!0,console.error(o)}finally{document.body.removeChild(c)}i+=t}Wt.labelText="Image downloads complete.",Wt.isOpen=!0}else{const t=await m(e,{filter:e=>{var t,o;return!(null==(t=e.classList)?void 0:t.contains("mdc-top-app-bar"))&&!(null==(o=e.classList)?void 0:o.contains("hidden"))&&e.nodeType!==Node.COMMENT_NODE}});if(!t)throw new Error("blob creation failed");const o=URL.createObjectURL(t),i=document.createElement("a");i.href=o,i.download="Build_".concat(oo(),".png"),i.target="_blank",i.click(),setTimeout(()=>{URL.revokeObjectURL(o)},1e3),Wt.labelText="Image download complete.",Wt.isOpen=!0}}catch(o){Wt.labelText="Download failed: Restricted content detected.",Wt.isOpen=!0,console.error(o)}finally{for(let e=0;e<i.length;e++){const o=i[e];o.style.removeProperty("height"),""===(null==(t=o.getAttribute("style"))?void 0:t.trim())&&o.removeAttribute("style")}}}else Wt.labelText="Download failed: Cannot find window.",Wt.isOpen=!0}(y(n)),class:"h-100",children:(e,t)=>{var o=Yl(),i=q(o);ke(i,{class:"mdi mdi-file-image"});var n=K(i,2);pe(n,{children:(e,t)=>{var o=ae("Download Image");T(e,o)},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}});var r=K(a,2);ge(r,{id:"backpackDialog",class:"p-0",children:(e,t)=>{var o=Xl(),a=B(o);we(a,21,()=>app.backpack,Te,(e,t)=>{var o=Jl();Hl(B(o),{get row(){return y(t)},get windowWidth(){return y(i)},get preloadImages(){return app.preloadImages},isBackpack:!0}),F(()=>R(o,1,D(y(t).width?"col-6":"col-12"))),T(e,o)}),w(o,e=>x(n,e),()=>y(n)),F(()=>ye(o,y(l))),Oe(o,"clientWidth",e=>x(i,e)),T(e,o)},$$slots:{default:!0}});var s=K(r,2);me(s,{class:"p-0",style:"min-height: 36px",children:(e,t)=>{he(e,{action:"close",children:(e,t)=>{pe(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ae("Close");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}}),I()}var ea=f("<div><!></div>"),ta=(e,t)=>{e.preventDefault(),t()},oa=f('<span class="picture-inner-text svelte-k98dno"><!></span>'),ia=f('<span class="picture-inner-text svelte-k98dno"><!></span>'),na=f('<div class="picture-inner svelte-k98dno"><!></div>'),la=f('<div class="preview-container svelte-k98dno"><canvas tabindex="0"></canvas> <!></div> <!> <!> <!>',1),aa=f("<div><!></div> <!> <!>",1),ra=f("<div><!></div>"),sa=f('<div id="picture-input" class="picture-input svelte-k98dno"><!> <input type="file" class="svelte-k98dno"/></div>');function ca(e,o){h(o,!0);let n,l,a=A(o,"width",19,()=>Number.MAX_SAFE_INTEGER),r=A(o,"height",19,()=>Number.MAX_SAFE_INTEGER),s=A(o,"margin",3,0),c=A(o,"accept",3,"image/*, image/avif"),d=A(o,"capture",3,null),u=A(o,"size",19,()=>Number.MAX_SAFE_INTEGER),g=A(o,"name",3,null),m=A(o,"id",3,null),f=A(o,"buttonClass",3,""),C=A(o,"removeButtonClass",3,""),O=A(o,"aspectButtonClass",3,""),k=A(o,"prefill",11,""),M=A(o,"prefillOptions",19,()=>({})),D=A(o,"crop",3,!0),j=A(o,"radius",3,0),P=A(o,"removable",3,!1),$=A(o,"hideChangeButton",3,!1),V=A(o,"autoToggleAspectRatio",3,!1),N=A(o,"toggleAspectRatio",3,!1),W=A(o,"changeOnClick",3,!0),E=A(o,"plain",3,!1),U=A(o,"zIndex",3,1e4),z=A(o,"alertOnError",3,!0),G=A(o,"customStrings",19,()=>({})),H=S(!1),_=S(0),Y=S(0),Z=S(!1),Q=S(0),ee=S(0),oe=S(1),ie=S(0),ne=S(""),le=S(null),se=S(null),ce=S(""),de=S(0),ue=S(0),ge=S(""),me=S(!1),ve=S(0),fe=S(0),be=S(0),we=S(null),Te=S(i([])),Ie={upload:"<p>Your device does not support file uploading.</p>",drag:"Drag an image or <br>click here to select a file",tap:"Tap here to select a photo <br>from your gallery",change:"Change Photo",aspect:"Landscape/Portrait",remove:"Remove Photo",select:"Select a Photo",selected:"<p>Photo successfully selected!</p>",fileSize:"The file size exceeds the limit",fileType:"This file type is not supported."},Ce=S(void 0);const xe=te(()=>{if(navigator.userAgent.match(/(Android (1\.0|1\.1|1\.5|1\.6|2\.0|2\.1))|(Windows Phone (OS 7|8\.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1\.0|2\.0|2\.5|3\.0))/))return!1;const e=document.createElement("input");return e.type="file",!e.disabled}),Ae=te(()=>!(!window.FileReader||!window.CanvasRenderingContext2D)),Oe=te(()=>{const e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&!("ontouchstart"in window||navigator.maxTouchPoints)}),ke=te(()=>y(Z)?"dragging-over":""),Me=te(()=>"".concat(Math.min(.04*y(Y),21),"px"));function Fe(){y(H)&&!W()||qe(),o.onclick&&o.onclick()}function Re(){Ne()&&y(le)&&$e(y(le))}function De(){y(Oe)&&x(Z,!1)}function je(e,t=!1){var i;const n=e.target,l="drop"===e.type?null==(i=e.dataTransfer)?void 0:i.files:n.files;if(l&&0!==l.length){if(l[0].size<=0||l[0].size>1024*Number(u())*1024)return o.onerror&&o.onerror({type:"fileSize",fileSize:l[0].size,fileType:l[0].type,fileName:l[0].name,message:"".concat(Ie.fileSize," (").concat(u(),"MB)")}),void(z()&&alert("".concat(Ie.fileSize," (").concat(u(),"MB)")));if(l[0].name!==y(ce)||l[0].size!==y(de)||y(ue)!==l[0].lastModified){if(x(se,l[0],!0),x(ce,l[0].name,!0),x(de,l[0].size,!0),x(ue,l[0].lastModified,!0),x(ge,l[0].type.split(";")[0],!0),"image/*, image/avif"===c()){if(!y(ge).startsWith("image/"))return}else if(-1===y(Te).indexOf(y(ge)))return o.onerror&&o.onerror({type:"fileType",fileSize:y(de),fileType:y(ge),fileName:y(ce),message:Ie.fileType}),void(z()&&alert(Ie.fileType));x(H,!0),x(ne,""),y(Ae)&&y(se)?Pe(y(se)):t?o.onprefill&&o.onprefill():o.onchange&&o.onchange(y(ne))}}}function Pe(e,t){!function(e,t){const o=new FileReader;o.onload=e=>{const o=new DataView(e.target.result);if(65496!==o.getUint16(0,!1))return t(-2);const i=o.byteLength;let n=2;for(;n<i;){const e=o.getUint16(n,!1);if(n+=2,65505===e){if(1165519206!==o.getUint32(n+=2,!1))return t(-1);const e=18761===o.getUint16(n+=6,!1);n+=o.getUint32(n+4,e);const i=o.getUint16(n,e);n+=2;for(let l=0;l<i;l++)if(274===o.getUint16(n+12*l,e))return t(o.getUint16(n+12*l+8,e))}else{if(65280&~e)break;n+=o.getUint16(n,!1)}}return t(-1)},o.readAsArrayBuffer(e.slice(0,65536))}(e,t=>{!function(e){x(me,!1),8===e?x(me,-Math.PI/2):6===e?x(me,Math.PI/2):3===e&&x(me,-Math.PI)}(t);const i=new FileReader;i.onload=e=>{x(ne,e.target.result,!0),x(le,new Image,!0),y(le).onload=()=>{if(V()){We(y(Q),y(ee))!==We(y(le).width,y(le).height)&&Ee()}$e(y(le))},y(le).src=y(ne),o.onchange&&o.onchange(y(ne))},i.readAsDataURL(e)})}function $e(e){x(ve,e.width,!0),x(fe,e.height,!0),x(be,e.width/e.height);let t=0,o=0,i=y(Y),n=y(_);const l=y(Y)/y(_);D()?y(be)>=l?(i=n*y(be),t=(y(Y)-i)/2):(n=i/y(be),o=(y(_)-n)/2):y(be)>=l?(n=i/y(be),o=(y(_)-n)/2):(i=n*y(be),t=(y(Y)-i)/2),y(Ce)&&(y(Ce).style.background="none",y(Ce).width=y(Y)*y(oe),y(Ce).height=y(_)*y(oe),y(we)&&(y(we).setTransform(1,0,0,1,0,0),y(we).clearRect(0,0,y(Ce).width,y(Ce).height),y(me)&&void 0===e.style.imageOrientation&&(y(we).translate(t*y(oe),o*y(oe)),y(we).translate(i/2*y(oe),n/2*y(oe)),y(we).rotate(y(me)),t=-i/2,o=-n/2),y(we).drawImage(e,t*y(oe),o*y(oe),i*y(oe),n*y(oe))))}function qe(){l.click()}function Ve(){l.value="",l.type="",l.type="file",x(ce,""),x(ge,""),x(de,0),x(ue,0),x(H,!1),x(ne,""),x(se,null),x(le,null),y(Ce)&&(y(Ce).style.backgroundColor="rgba(200,200,200,.25)",y(Ce).width=y(Y)*y(oe)),o.onremove&&o.onremove()}function Le(){Ee(),y(le)&&$e(y(le));const e=We(y(Q),y(ee));o.onaspectratiochange&&o.onaspectratiochange(e)}function Ne(){const e=y(Q)/y(ee),t=n.clientWidth;return!!t&&(!(!N()&&!V()&&t===y(ie))&&(x(ie,t,!0),x(Y,Math.min(y(ie)-2*Number(s()),y(Q)),!0),x(_,y(Y)/e),!0))}function We(e,t){return e>t?"landscape":e<t?"portrait":"square"}function Ee(){!function(){const e=y(Q);x(Q,y(ee),!0),x(ee,e,!0)}(),Ne()}function Ue(e,i){let n=window.File;try{new n([],"")}catch(a){n=class extends Blob{constructor(e,o,i={}){super(e,i),t(this,"lastModifiedDate",new Date),t(this,"lastModified",+this.lastModifiedDate),t(this,"name"),this.name=o}}}if(i=Object.assign({},i),"object"==typeof e)return x(H,!0),x(ne,""),void(y(Ae)?Pe(e):o.onprefill&&o.onprefill());-1===e.indexOf("data:")&&(e+=-1!==e.indexOf("?")?"&_="+(new Date).getTime():"?_="+(new Date).getTime());const l=new Headers;l.append("Accept","image/*, image/avif"),fetch(e,{method:"GET",mode:"cors",headers:l}).then(e=>e.blob()).then(t=>{const o={target:{files:[]}},l=i.fileName||e.split("/").slice(-1)[0];let a=i.mediaType||t.type||"image/"+(i.fileType||l.split("?")[0].split(".").slice(-1)[0]);a=a.replace("jpg","jpeg").replace("image/svg","image/svg+xml"),"image/svg"===a&&(a="image/svg+xml"),o.target.files[0]=new n([t],l,{type:a}),je(o,!0)}).catch(e=>{o.onerror&&o.onerror({type:"failedPrefill",message:"Failed loading prefill image: "+e}),z()&&alert("Failed loading prefill image: "+e)})}p(()=>{k()&&Ue(k(),M())}),L(async()=>{await J(),function(){if(G())for(const e in G())e in Ie&&"string"==typeof G()[e]&&(Ie[e]=G()[e])}(),k()&&Ue(k(),M()),window.addEventListener("resize",Re),Re(),y(Ae)&&y(Ce)&&(x(oe,Math.round(window.devicePixelRatio||1),!0),y(Ce).getContext&&(x(we,y(Ce).getContext("2d"),!0),y(we)&&y(we).scale(y(oe),y(oe)))),"image/*, image/avif"!==c()&&x(Te,c().split(",").map(e=>e.trim()),!0),x(Q,a()!=Number.MAX_SAFE_INTEGER?Number(a()):n.clientWidth,!0),x(ee,r()!=Number.MAX_SAFE_INTEGER?Number(r()):y(Q),!0),x(Y,y(Q),!0),x(_,y(ee),!0)}),v(()=>{window.removeEventListener("resize",Re)});var ze=sa(),Ge=B(ze),He=e=>{var t=ea(),o=B(t);b(o,()=>Ie.upload),T(e,t)},_e=(e,t)=>{var o=e=>{var t=la(),o=q(t),i=B(o);i.__click=[ta,Fe],w(i,e=>x(Ce,e),()=>y(Ce));var n=K(i,2),l=e=>{var t=na(),o=B(t),i=e=>{var t=oa(),o=B(t);b(o,()=>Ie.drag),T(e,t)},n=e=>{var t=ia(),o=B(t);b(o,()=>Ie.tap),T(e,t)};X(o,e=>{y(Oe)?e(i):e(n,!1)}),F(e=>{var o,i,n,l;return ye(t,"top: -".concat(null!=(o=y(_))?o:"","px; margin-bottom: -").concat(null!=(i=y(_))?i:"","px; font-size: ").concat(null!=(n=y(Me))?n:"","; border-radius: ").concat(null!=(l=j())?l:"","%; z-index: ").concat(null!=e?e:"",";"))},[()=>parseInt(U()+"")+2]),T(e,t)};X(n,e=>{y(H)||E()||e(l)});var s=K(o,2),c=e=>{he(e,{variant:"raised",onclick:qe,get class(){return f()},children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae();F(()=>re(o,Ie.change)),T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};X(s,e=>{y(H)&&!$()&&e(c)});var d=K(s,2),u=e=>{he(e,{variant:"raised",onclick:Ve,get class(){return C()},children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae();F(()=>re(o,Ie.remove)),T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};X(d,e=>{y(H)&&P()&&e(u)});var g=K(d,2),m=e=>{he(e,{variant:"raised",onclick:Le,get class(){return O()},children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae();F(()=>re(o,Ie.aspect)),T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};X(g,e=>{y(H)&&N()&&a()!==r()&&e(m)}),F(e=>{var t,n,l,a,r;ye(o,"max-width: ".concat(null!=(t=y(Y))?t:"","px; height: ").concat(null!=(n=y(_))?n:"","px; border-radius: ").concat(null!=(l=j())?l:"","%;")),R(i,1,"picture-preview ".concat(null!=(a=y(ke))?a:""),"svelte-k98dno"),ye(i,"height: ".concat(null!=(r=y(_))?r:"","px; z-index: ").concat(null!=e?e:"",";"))},[()=>parseInt(U()+"")+1]),Be("drag",i,e=>{e.stopPropagation(),e.preventDefault()}),Be("dragover",i,e=>{e.stopPropagation(),e.preventDefault()}),Be("dragstart",i,e=>{e.stopPropagation(),e.preventDefault()}),Be("dragend",i,e=>{e.stopPropagation(),e.preventDefault()}),Be("dragenter",i,e=>{e.stopPropagation(),e.preventDefault(),y(Oe)&&x(Z,!0)}),Be("dragleave",i,e=>{e.stopPropagation(),e.preventDefault(),De()}),Be("drop",i,e=>{e.stopPropagation(),e.preventDefault(),function(e){De(),je(e)}(e)}),T(e,t)},i=e=>{var t=ra(),o=B(t),i=e=>{he(e,{variant:"raised",onclick:qe,get class(){return f()},children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae();F(()=>re(o,Ie.select)),T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},n=e=>{var t=aa(),o=q(t),i=B(o);b(i,()=>Ie.selected);var n=K(o,2),l=e=>{he(e,{variant:"raised",onclick:qe,get class(){return f()},children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae();F(()=>re(o,Ie.change)),T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};X(n,e=>{$()||e(l)});var a=K(n,2),r=e=>{he(e,{variant:"raised",onclick:Ve,get class(){return C()},children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae();F(()=>re(o,Ie.remove)),T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})};X(a,e=>{P()&&e(r)}),T(e,t)};X(o,e=>{y(H)?e(n,!1):e(i)}),T(e,t)};X(e,e=>{y(Ae)?e(o):e(i,!1)},t)};X(Ge,e=>{y(xe)?e(_e,!1):e(He)});var Ye=K(Ge,2);Ye.__change=je,w(Ye,e=>l=e,()=>l),w(ze,e=>n=e,()=>n),F(()=>{Se(Ye,"name",g()),Se(Ye,"id",m()),Se(Ye,"accept",c()),Se(Ye,"capture",d())}),T(e,ze),I()}Me(["click","change"]);var da=f('<div class="mb-4 text-left"><!></div>'),ua=f('<img alt="Converted" loading="lazy" class="svelte-1br61l5"/> <!> <!>',1),ga=f('<div class="col col-lg-4"><!> <!></div> <div class="col col-lg-8"><!></div>',1),ma=f('<div><img alt="Cropper" loading="lazy" class="cropper-image svelte-1br61l5"/></div>'),ha=f('<div class="row justify-center"><div class="col"><!></div> <div class="col"><!></div> <div class="col"><!></div></div> <div class="mt-2"><!></div> <!>',1),pa=f('<div class="pt-3 col col-12"><img alt="Compress" loading="lazy" class="svelte-1br61l5"/></div>'),va=f('<div class="row justify-center"><div class="col"><!></div> <div class="col"><!></div> <div class="col"><!></div> <!></div>'),fa=f('<div class="col col-lg-4"><div><!></div> <div><b>Before:</b> <b>After:</b> </div> <!></div> <div class="col-lg-8"><!> <!> <!></div>',1),ba=f('<div class="container"><!> <div class="row"><!></div></div>'),wa=f("<!> <!> <!>",1);function Ta(e,t){h(t,!0);let o,i=A(t,"open",7),n=A(t,"imgObject",7),l=A(t,"canHaveURL",3,!0),a=S("Cropper"),r=S(100),s=S(90),c=!1,d=S(1),u=S(1),g=S(void 0),m=S(void 0),v=S(void 0),f=S(!1),b=0,C=te(()=>{if(y(m)){const e=function(e){const t=e.match(/^data:.+;base64,(.+)$/);return t?t[1]:e}(y(m)).length*(3/4)-2;return Math.round(e/1024)}return 0}),O=te(()=>{if(y(v)){const e=y(v).split(",")[1].length*(3/4)-2;return Math.round(e/1024)}return 0});function M(){const e=L(n(),t.imgProp);e&&$(e)}function D(){y(v)&&V(n(),t.imgProp,y(v),!1)}function j(){o&&o.setAspectRatio(y(u)/y(d))}function P(){if(o&&y(g)){const e=o.getCroppedCanvas().toDataURL("image/webp");y(g).src=e,V(n(),t.imgProp,e)}}function $(e){const t=document.createElement("canvas"),o=t.getContext("2d"),i=new Image;i.crossOrigin="anonymous",i.onload=()=>{const e=y(r)/100,n=i.width*e,l=i.height*e;t.setAttribute("width",n.toString()),t.setAttribute("height",l.toString()),null==o||o.drawImage(i,0,0,n,l),x(v,t.toDataURL("image/webp",y(s)/100),!0),b++,c&&b>1&&(c=!1,D(),b=0)},i.src=e}function V(e,t,i,n=!0){e&&(e[t]=i,x(m,i,!0),o&&o.replace(i),n&&$(i))}function L(e,t){return e&&e[t]?e[t]:""}p(()=>(y(g)?o=new Fe(y(g),{viewMode:3,dragMode:"move"}):o&&o.destroy(),()=>{o&&o.destroy()})),de(e,{surface$style:"width: 1200px; max-width: calc(100vw - 32px);",style:"text-align: center",get onSMUIDialogClosed(){return t.onclose},get open(){return i()},set open(e){i(e)},children:(e,o)=>{var m=wa(),h=q(m);ue(h,{tabindex:0,autofocus:!0,children:(e,t)=>{var o=ae("Image");T(e,o)},$$slots:{default:!0}});var p=K(h,2);ge(p,{children:(e,o)=>{var m=ba(),h=B(m),p=e=>{var t=da(),o=B(t);ve(o,{label:e=>{var t=ae("Uploaded Image or External URL.");T(e,t)},children:(e,t)=>{fe(e,{color:"secondary",class:"switch-scale",get checked(){return y(f)},set checked(e){x(f,e,!0)}})},$$slots:{label:!0,default:!0}});T(e,t)};X(h,e=>{l()&&e(p)});var v=K(h,2),b=B(v),I=e=>{var o=ga(),i=q(o),l=B(i);Wi(l,{get value(){return n().imageLink||""},set value(e){var t;t=e,n().imageLink=t},label:"External Image URL",variant:"filled"});var a=K(l,2);he(a,{onclick:()=>{V(n(),t.imgProp,n().imageLink)},variant:"raised",children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae("Convert URL to Image");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var r=K(i,2),s=B(r),c=e=>{var o=ua(),i=q(o),l=K(i,2);he(l,{onclick:()=>{V(n(),t.imgProp,""),delete n().imageLink},variant:"raised",class:"my-3",children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae("Remove Photo");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var a=K(l,2);Wi(a,{get value(){return n().imageSourceTooltip||""},set value(e){var t;t=e,n().imageSourceTooltip=t},label:"Tooltip That Shows When Hovering over it",variant:"filled"}),F(e=>Se(i,"src",e),[()=>L(n(),t.imgProp)]),T(e,o)};X(s,e=>{void 0!==L(n(),t.imgProp)&&""!==L(n(),t.imgProp)&&e(c)}),T(e,o)},S=e=>{var o=fa(),l=q(o),m=B(l),h=B(m),p=e=>{const o=te(()=>Wo(L(n(),t.imgProp))?L(n(),t.imgProp):"");ca(e,{hideChangeButton:!0,removable:!0,crop:!1,get prefill(){return y(o)},onchange:e=>{V(n(),t.imgProp,e)},onclick:()=>c=app.compressImageAuto,onremove:()=>V(n(),t.imgProp,"")})};X(h,e=>{i()&&e(p)});var v=K(m,2);let f;var b=K(B(v)),I=K(b,2),S=K(v,2);Wi(S,{get value(){return n().imageSourceTooltip||""},set value(e){var t;t=e,n().imageSourceTooltip=t},label:"Tooltip That Shows When Hovering over it",variant:"filled"});var A=K(l,2),$=B(A);{const e=(e,t=k)=>{Pe(e,{get tab(){return t()},children:(e,o)=>{pe(e,{children:(e,o)=>{var i=ae();F(()=>re(i,t())),T(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})};Re($,{tabs:["Cropper","Compress"],get active(){return y(a)},set active(e){x(a,e,!0)},tab:e,$$slots:{tab:!0}})}var N=K($,2);const W=te(()=>"Cropper"!==y(a)?"display: none;":"");De(N,{role:"tabpanel",variant:"unelevated",get style(){return y(W)},children:(e,o)=>{je(e,{children:(e,o)=>{var i=ha(),l=q(i),a=B(l);Wi(B(a),{label:"Width Aspect",type:"number",variant:"filled",get value(){return y(u)},set value(e){x(u,e,!0)}});var r=K(a,2);Wi(B(r),{label:"Height Aspect",type:"number",variant:"filled",get value(){return y(d)},set value(e){x(d,e,!0)}});var s=K(r,2),c=B(s);he(c,{onclick:j,variant:"raised",style:"height: 100%;",children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae("Change Aspect");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var m=K(l,2),h=B(m);he(h,{onclick:P,variant:"raised",children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae("Crop Image");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var p=K(m,2),v=e=>{var o=ma(),i=B(o);w(i,e=>x(g,e),()=>y(g)),F(e=>Se(i,"src",e),[()=>L(n(),t.imgProp)]),T(e,o)};X(p,e=>{Wo(L(n(),t.imgProp))&&e(v)}),T(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}});var E=K(N,2);const U=te(()=>"Compress"!==y(a)?"display: none;":"");De(E,{role:"tabpanel",variant:"unelevated",get style(){return y(U)},children:(e,o)=>{je(e,{children:(e,o)=>{var i=va(),l=B(i);Wi(B(l),{onchange:M,label:"Image Scale",type:"number",variant:"filled",get value(){return y(r)},set value(e){x(r,e,!0)}});var a=K(l,2);Wi(B(a),{onchange:M,label:"Image Quality",type:"number",variant:"filled",get value(){return y(s)},set value(e){x(s,e,!0)}});var c=K(a,2),d=B(c);he(d,{onclick:D,variant:"raised",style:"height: 100%;",children:(e,t)=>{pe(e,{children:(e,t)=>{var o=ae("Compress Image");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var u=K(c,2),g=e=>{var o=pa(),i=B(o);F(e=>Se(i,"src",e),[()=>L(n(),t.imgProp)]),T(e,o)};X(u,e=>{Wo(L(n(),t.imgProp))&&e(g)}),T(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}}),F(e=>{var t,o;f=R(v,1,"pa-4",null,f,e),re(b,"".concat(null!=(t=y(C))?t:""," kB|")),re(I,"".concat(null!=(o=y(O))?o:""," kB"))},[()=>({hidden:!L(n(),t.imgProp)})]),T(e,o)};X(b,e=>{y(f)?e(I):e(S,!1)}),T(e,m)},$$slots:{default:!0}});var v=K(p,2);me(v,{children:(e,t)=>{he(e,{action:"close",children:(e,t)=>{pe(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ae("Close");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),T(e,m)},$$slots:{default:!0}}),I()}let Ia=0;var ya=f("<div><!></div>");let Sa=0;var Ca=f("<input/>"),xa=f('<span class="mdc-select__ripple"></span>'),Ba=f('<div><!> <div><!> <!> <!> <!> <span><span> </span></span> <span><svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false"><polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd" points="7 10 12 15 17 10"></polygon><polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd" points="7 15 12 10 17 15"></polygon></svg></span> <!></div> <!></div> <!>',1);function Aa(e,t){h(t,!0);const[o,n]=xe(),l=()=>Ae(Ke,"$selectedTextStore",o);let a=()=>{};function r(e){return e===a}let s=A(t,"use",19,()=>[]),c=A(t,"class",3,""),d=A(t,"style",3,""),g=A(t,"ripple",3,!0),m=A(t,"disabled",3,!1),f=A(t,"variant",3,"standard"),b=A(t,"noLabel",3,!1),C=A(t,"label",3,void 0),R=A(t,"value",15),D=A(t,"key",3,e=>e),j=A(t,"dirty",15,!1),U=A(t,"invalid",15,a),z=A(t,"updateInvalid",19,()=>r(U())),_=A(t,"required",3,!1),Y=A(t,"inputId",19,()=>"SMUI-select-"+Sa++),Z=A(t,"hiddenInput",3,!1),J=A(t,"withLeadingIcon",3,a),ee=A(t,"anchor$use",19,()=>[]),de=A(t,"anchor$class",3,""),ue=A(t,"selectedTextContainer$use",19,()=>[]),ge=A(t,"selectedTextContainer$class",3,""),me=A(t,"selectedText$use",19,()=>[]),he=A(t,"selectedText$class",3,""),pe=A(t,"dropdownIcon$use",19,()=>[]),ve=A(t,"dropdownIcon$class",3,""),fe=A(t,"menu$class",3,""),be=A(t,"alwaysFloat",3,!1),we=V(t,["$$slots","$$events","$$legacy","use","class","style","ripple","disabled","variant","noLabel","label","value","key","dirty","invalid","updateInvalid","required","inputId","hiddenInput","withLeadingIcon","anchor$use","anchor$class","selectedTextContainer$use","selectedTextContainer$class","selectedText$use","selectedText$class","dropdownIcon$use","dropdownIcon$class","menu$class","children","leadingIcon","helperText","alwaysFloat"]);const Te=r(U());let Ie;r(U())&&U(!1);let ye,Se=S(void 0),Ce=i({}),Be=i({}),Oe=i({}),ke=S(-1);const Me=te(()=>void 0!==we.menu$id?we.menu$id:Y()+"-menu");let Fe,Re,De,je,Pe=S(void 0),Ee=G("SMUI:addLayoutListener"),Ue=S(!1),ze=i({}),Ge=S(void 0),He=S(void 0),_e=S(!1),Ye=G("SMUI:select:context"),Ze=S(void 0),Je=S(void 0),Xe=S(void 0);H("SMUI:list:role",""),H("SMUI:list:nav",!1);const Ke=u("");H("SMUI:select:selectedText",Ke);const Qe=u(R());p(()=>{qe(Qe,R())}),H("SMUI:select:value",Qe),p(()=>{y(Se)&&y(Se).getValue()!==D()(R())&&y(Se).setValue(D()(R()))});let et=y(ke);function tt(e){return e in Ce?Ce[e]:mt().classList.contains(e)}function ot(e){Ce[e]||(Ce[e]=!0)}function it(e){e in Ce&&!Ce[e]||(Ce[e]=!1)}function nt(e,t){Be[e]!=t&&(""===t||null==t?delete Be[e]:Be[e]=t)}function lt(e){ze[e]||(ze[e]=!0)}function at(e){e in ze&&!ze[e]||(ze[e]=!1)}function rt(e){return e in Oe?void 0!==Oe[e]?Oe[e]:null:mt().getAttribute(e)}function st(e,t){Oe[e]!==t&&(Oe[e]=t)}function ct(e){e in Oe&&null==Oe[e]||(Oe[e]=void 0)}function dt(){return Re.getOrderedList().map(e=>e.getValue())}function ut(e){var t;null==(t=y(Se))||t.setUseDefaultValidation(e)}function gt(){var e;null==(e=y(Se))||e.layout()}function mt(){return Ie}p(()=>{if(et!==y(ke))if(et=y(ke),y(Se))y(Se).setSelectedIndex(y(ke),!1,!0);else{const e=dt();R()!==e[y(ke)]&&R(e[y(ke)])}}),p(()=>{y(Se)&&y(Se).getDisabled()!==m()&&y(Se).setDisabled(m())}),p(()=>{y(Se)&&j()&&y(Se).isValid()!==!U()&&(z()?U(!y(Se).isValid()):y(Se).setValid(!U()))}),p(()=>{y(Se)&&y(Se).getRequired()!==_()&&y(Se).setRequired(_())}),Ee&&(Fe=Ee(gt)),H("SMUI:select:leading-icon:mount",e=>{De=e}),H("SMUI:select:leading-icon:unmount",()=>{De=void 0}),H("SMUI:list:mount",e=>{Re=e}),H("SMUI:select:helper-text:id",e=>{x(Pe,e,!0)}),H("SMUI:select:helper-text:mount",e=>{je=e}),H("SMUI:select:helper-text:unmount",()=>{x(Pe,void 0),je=void 0}),L(()=>(x(Se,new Ve({setSelectedText:e=>{qe(Ke,e)},isSelectAnchorFocused:()=>document.activeElement===ye,getSelectAnchorAttr:rt,setSelectAnchorAttr:st,removeSelectAnchorAttr:ct,addMenuClass:lt,removeMenuClass:at,openMenu:()=>{x(Ue,!0)},closeMenu:()=>{x(Ue,!1)},getAnchorElement:()=>ye,setMenuAnchorElement:e=>{x(Ge,e,!0)},setMenuAnchorCorner:e=>{x(He,e,!0)},setMenuWrapFocus:e=>{x(_e,e,!0)},getSelectedIndex:()=>y(ke),setSelectedIndex:e=>{et=e,x(ke,e,!0),R(dt()[y(ke)])},focusMenuItemAtIndex:e=>{Re.focusItemAtIndex(e)},getMenuItemCount:()=>Re.items.length,getMenuItemValues:()=>dt().map(D()),getMenuItemTextAtIndex:e=>Re.getPrimaryTextAtIndex(e),isTypeaheadInProgress:()=>Re.typeaheadInProgress,typeaheadMatchItem:(e,t)=>Re.typeaheadMatchItem(e,t),addClass:ot,removeClass:it,hasClass:tt,setRippleCenter:e=>y(Je)&&y(Je).setRippleCenter(e),activateBottomLine:()=>y(Je)&&y(Je).activate(),deactivateBottomLine:()=>y(Je)&&y(Je).deactivate(),notifyChange:e=>{var t;j(!0),z()&&U(!(null==(t=y(Se))?void 0:t.isValid())),se(mt(),"SMUISelectChange",{value:R(),index:y(ke)})},hasOutline:()=>!!y(Xe),notchOutline:e=>y(Xe)&&y(Xe).notch(e),closeOutline:()=>y(Xe)&&y(Xe).closeNotch(),hasLabel:()=>!!y(Ze),floatLabel:e=>y(Ze)&&y(Ze).float(e||be()),getLabelWidth:()=>y(Ze)?y(Ze).getWidth():0,setLabelRequired:e=>y(Ze)&&y(Ze).setRequired(e)},{get helperText(){return je},get leadingIcon(){return De}}),!0),x(ke,dt().indexOf(R()),!0),y(Se).init(),ut(Te),()=>{var e;null==(e=y(Se))||e.destroy()})),v(()=>{Fe&&Fe()});var ht=Ba(),pt=q(ht);N(pt,(e,t,o)=>({class:e,style:t,...o}),[()=>W({[c()]:!0,"mdc-select":!0,"mdc-select--required":_(),"mdc-select--disabled":m(),"mdc-select--filled":"filled"===f(),"mdc-select--outlined":"outlined"===f(),"smui-select--standard":"standard"===f(),"mdc-select--with-leading-icon":r(J())?t.leadingIcon:J(),"mdc-select--no-label":b()||null==C(),"mdc-select--invalid":U(),"mdc-select--activated":y(Ue),"mdc-data-table__pagination-rows-per-page-select":"data-table:pagination"===Ye,...Ce}),()=>Object.entries(Be).map(([e,t])=>"".concat(e,": ").concat(t,";")).concat([d()]).join(" "),()=>Q(we,["input$","anchor$","label$","outline$","selectedTextContainer$","selectedText$","dropdownIcon$","ripple$","menu$","list$","helperText$"])]);var vt=B(pt),ft=e=>{var t=Ca();N(t,e=>({type:"hidden",required:_(),disabled:m(),value:R(),...e}),[()=>ie(we,"input$")]),T(e,t)};X(vt,e=>{Z()&&e(ft)});var bt=K(vt,2),wt=e=>{var o;ye.focus(),y(Se)&&y(Se).handleClick(function(e){const t=e.currentTarget.getBoundingClientRect();return(function(e){return"touches"in e}(e)?e.touches[0].clientX:e.clientX)-t.left}(e)),null==(o=t.anchor$onclick)||o.call(t,e)},Tt=e=>{var o;y(Se)&&y(Se).handleKeydown(e),null==(o=t.onkeydown)||o.call(t,e)},It=e=>{var o;y(Se)&&y(Se).handleBlur(),se(mt(),"blur",e),null==(o=t.anchor$onblur)||o.call(t,e)},yt=e=>{var o;y(Se)&&y(Se).handleFocus(),se(mt(),"focus",e),null==(o=t.anchor$onfocus)||o.call(t,e)};N(bt,(e,t)=>({class:e,"aria-required":_()?"true":void 0,"aria-disabled":m()?"true":void 0,"aria-controls":y(Me),"aria-expanded":y(Ue)?"true":"false","aria-describedby":y(Pe),role:"combobox",tabindex:"0",...Oe,...t,onclick:wt,onkeydown:Tt,onblur:It,onfocus:yt}),[()=>W({[de()]:!0,"mdc-select__anchor":!0}),()=>ie(we,"anchor$")]);var St=B(bt),Ct=e=>{var t=xa();T(e,t)};X(St,e=>{"filled"===f()&&e(Ct)});var xt=K(St,2),Bt=e=>{const t=te(()=>Y()+"-smui-label"),o=te(()=>""!==l()||be());var i=te(()=>ie(we,"label$"));w(le(e,P({get id(){return y(t)},get floatAbove(){return y(o)},get required(){return _()}},()=>y(i),{children:(e,t)=>{var o=$(),i=q(o),n=e=>{},l=(e,t)=>{var o=e=>{var t=ae();F(()=>re(t,C())),T(e,t)},i=e=>{var t=$(),o=q(t);O(o,C),T(e,t)};X(e,e=>{"string"==typeof C()?e(o):e(i,!1)},t)};X(i,e=>{null==C()?e(n):e(l,!1)}),T(e,o)},$$slots:{default:!0}})),e=>x(Ze,e,!0),()=>y(Ze))};X(xt,e=>{"outlined"===f()||b()||null==C()||e(Bt)});var At=K(xt,2),Ot=e=>{const t=te(()=>b()||null==C());var o=te(()=>ie(we,"outline$"));w(ne(e,P({get noLabel(){return y(t)}},()=>y(o),{children:(e,t)=>{var o=$(),i=q(o),n=e=>{const t=te(()=>Y()+"-smui-label"),o=te(()=>""!==l()||be());var i=te(()=>ie(we,"label$"));w(le(e,P({get id(){return y(t)},get floatAbove(){return y(o)},get required(){return _()}},()=>y(i),{children:(e,t)=>{var o=$(),i=q(o),n=e=>{},l=(e,t)=>{var o=e=>{var t=ae();F(()=>re(t,C())),T(e,t)},i=e=>{var t=$(),o=q(t);O(o,C),T(e,t)};X(e,e=>{"string"==typeof C()?e(o):e(i,!1)},t)};X(i,e=>{null==C()?e(n):e(l,!1)}),T(e,o)},$$slots:{default:!0}})),e=>x(Ze,e,!0),()=>y(Ze))};X(i,e=>{b()||null==C()||e(n)}),T(e,o)},$$slots:{default:!0}})),e=>x(Xe,e,!0),()=>y(Xe))};X(At,e=>{"outlined"===f()&&e(Ot)});var kt=K(At,2);O(kt,()=>{var e;return null!=(e=t.leadingIcon)?e:k});var Mt=K(kt,2);N(Mt,(e,t)=>({class:e,...t}),[()=>W({[ge()]:!0,"mdc-select__selected-text-container":!0}),()=>ie(we,"selectedTextContainer$")]);var Ft=B(Mt);N(Ft,(e,t)=>({id:Y()+"-smui-selected-text",class:e,role:"button","aria-haspopup":"listbox","aria-labelledby":Y()+"-smui-label",...t}),[()=>W({[he()]:!0,"mdc-select__selected-text":!0}),()=>ie(we,"selectedText$")]);var Rt=B(Ft);M(Ft,(e,t)=>{var o;return null==(o=E)?void 0:o(e,t)},me),M(Mt,(e,t)=>{var o;return null==(o=E)?void 0:o(e,t)},ue);var Dt=K(Mt,2);N(Dt,(e,t)=>({class:e,...t}),[()=>W({[ve()]:!0,"mdc-select__dropdown-icon":!0}),()=>ie(we,"dropdownIcon$")]),M(Dt,(e,t)=>{var o;return null==(o=E)?void 0:o(e,t)},pe);var jt=K(Dt,2),Pt=e=>{var t=te(()=>ie(we,"ripple$"));w(ce(e,P(()=>y(t))),e=>x(Je,e,!0),()=>y(Je))};X(jt,e=>{"outlined"!==f()&&g()&&e(Pt)}),w(bt,e=>ye=e,()=>ye),M(bt,(e,t)=>{var o;return null==(o=E)?void 0:o(e,t)},ee);var $t=K(bt,2);const qt=te(()=>W({[fe()]:!0,"mdc-select__menu":!0,...ze}));var Vt=te(()=>ie(we,"menu$"));Le($t,P({get class(){return y(qt)},get id(){return y(Me)},fullWidth:!0,anchor:!1,get anchorElement(){return y(Ge)},get anchorCorner(){return y(He)}},()=>y(Vt),{onSMUIMenuSelected:e=>{var o;y(Se)&&y(Se).handleMenuItemAction(e.detail.index),null==(o=t.onSMUIMenuSelected)||o.call(t,e)},onSMUIMenuSurfaceClosing:e=>{var o;y(Se)&&y(Se).handleMenuClosing(),null==(o=t.onSMUIMenuSurfaceClosing)||o.call(t,e)},onSMUIMenuSurfaceClosed:e=>{var o;y(Se)&&y(Se).handleMenuClosed(),null==(o=t.onSMUIMenuSurfaceClosed)||o.call(t,e)},onSMUIMenuSurfaceOpened:e=>{var o;y(Se)&&y(Se).handleMenuOpened(),null==(o=t.onSMUIMenuSurfaceOpened)||o.call(t,e)},get open(){return y(Ue)},set open(e){x(Ue,e,!0)},children:(e,o)=>{var i=te(()=>ie(we,"list$"));Ne(e,P({role:"listbox",get wrapFocus(){return y(_e)}},()=>y(i),{style:"max-height: 296px",get selectedIndex(){return y(ke)},set selectedIndex(e){x(ke,e,!0)},children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.children)?e:k}),T(e,i)},$$slots:{default:!0}}))},$$slots:{default:!0}})),w(pt,e=>Ie=e,()=>Ie),M(pt,(e,t)=>{var o;return null==(o=oe)?void 0:o(e,t)},()=>({ripple:"filled"===f(),unbounded:!1,addClass:ot,removeClass:it,addStyle:nt})),M(pt,(e,t)=>{var o;return null==(o=We)?void 0:o(e,t)},()=>({addClass:ot,removeClass:it})),M(pt,(e,t)=>{var o;return null==(o=E)?void 0:o(e,t)},s);var Lt=K(pt,2),Nt=e=>{var o=te(()=>ie(we,"helperText$"));!function(e,t){h(t,!0);let o,n=A(t,"use",19,()=>[]),l=A(t,"class",3,""),a=A(t,"id",19,()=>"SMUI-select-helper-text-"+Ia++),r=A(t,"persistent",3,!1),s=A(t,"validationMsg",3,!1),c=V(t,["$$slots","$$events","$$legacy","use","class","id","persistent","validationMsg","children"]),d=S(void 0),u=i({}),g=i({}),m=S(void 0);const p=G("SMUI:select:helper-text:id"),v=G("SMUI:select:helper-text:mount"),f=G("SMUI:select:helper-text:unmount");function b(e){return e in u?u[e]:U().classList.contains(e)}function C(e){u[e]||(u[e]=!0)}function R(e){e in u&&!u[e]||(u[e]=!1)}function D(e){return e in g?void 0!==g[e]?g[e]:null:U().getAttribute(e)}function j(e,t){g[e]!==t&&(g[e]=t)}function P(e){e in g&&null==g[e]||(g[e]=void 0)}function U(){return o}L(()=>(x(d,new $e({addClass:C,removeClass:R,hasClass:b,getAttr:D,setAttr:j,removeAttr:P,setContent:e=>{x(m,e,!0)}}),!0),p&&p(a()),v&&v(y(d)),y(d).init(),()=>{var e;f&&y(d)&&f(y(d)),null==(e=y(d))||e.destroy()}));var z=ya();N(z,e=>({class:e,"aria-hidden":r()?void 0:"true",id:a(),...g,...c}),[()=>W({[l()]:!0,"mdc-select-helper-text":!0,"mdc-select-helper-text--validation-msg":s(),"mdc-select-helper-text--validation-msg-persistent":r(),...u})]);var H=B(z),_=e=>{var o=$(),i=q(o);O(i,()=>{var e;return null!=(e=t.children)?e:k}),T(e,o)},Y=e=>{var t=ae();F(()=>re(t,y(m))),T(e,t)};X(H,e=>{null==y(m)?e(_):e(Y,!1)}),w(z,e=>o=e,()=>o),M(z,(e,t)=>{var o;return null==(o=E)?void 0:o(e,t)},n),T(e,z),I({getElement:U})}(e,P(()=>y(o),{children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.helperText)?e:k}),T(e,i)},$$slots:{default:!0}}))};X(Lt,e=>{t.helperText&&e(Nt)}),F(()=>re(Rt,l())),T(e,ht);var Wt=I({getUseDefaultValidation:function(){if(null==y(Se))throw new Error("Instance is undefined.");return y(Se).getUseDefaultValidation()},setUseDefaultValidation:ut,focus:function(){ye.focus()},layout:gt,getElement:mt});return n(),Wt}function Oa(e,t){h(t,!0);const[o,i]=xe();let n=A(t,"use",19,()=>[]);A(t,"class",3,"");let l,a=A(t,"value",3,""),r=V(t,["$$slots","$$events","$$legacy","use","class","value","children"]);const s=G("SMUI:select:selectedText"),c=G("SMUI:select:value");H("SMUI:list:item:role","option");const d=te(()=>null!=a()&&""!==a()&&Ae(c,"$selectedValue",o)===a());function u(){y(d)&&l&&qe(s,l.getPrimaryText())}L(u),v(u),w(Ee(e,P({get use(){return n()},get"data-value"(){return a()},get value(){return a()},get selected(){return y(d)}},()=>r,{children:(e,o)=>{var i=$(),n=q(i);O(n,()=>{var e;return null!=(e=t.children)?e:k}),T(e,i)},$$slots:{default:!0}})),e=>l=e,()=>l);var g=I({getElement:function(){return l.getElement()}});return i(),g}var ka=f('<div class="col-12 px-3 mt-0"><!></div>'),Ma=f('<div class="container-fluid p-0"><div class="row gy-3"><div class="col-12"><!></div> <div class="col-12"><!></div> <!> <div class="col-12"><!></div> <div class="col-12"><!></div> <div class="col-12"><!></div> <div class="col-12"><!></div></div></div>'),Fa=f("<b>Interactive CYOA Creator Plus</b>"),Ra=f('<div class="container-fluid p-0"><div class="row gy-3"><div class="col-12 text-right"> <br/></div></div></div>'),Da=f("<!> <!>",1),ja=f("<!> <!>",1),Pa=f("<!> <!> <!>",1);function $a(e,t){h(t,!0);let o=A(t,"open",7);const i=[{text:"2 Per Row",value:"col-6"},{text:"3 Per Row",value:"col-4"},{text:"4 Per Row",value:"col-3"}];let n=S("General");function l(){Kt&&Kt.abort(),eo()}function a(){const e=Et.allowDeselect;for(let t=0;t<app.backpack.length;t++){const o=app.backpack[t];o.isResultRow&&(o.isInfoRow=!e)}}de(e,{surface$style:"width: 600px; max-width: calc(100vw - 32px);",get onSMUIDialogClosed(){return t.onclose},get open(){return o()},set open(e){o(e)},children:(e,t)=>{var o=Pa(),r=q(o);ue(r,{class:"text-left dialog-title",tabindex:0,autofocus:!0,children:(e,t)=>{var o=ae("Settings");T(e,o)},$$slots:{default:!0}});var s=K(r,2);ge(s,{children:(e,t)=>{var o=ja(),r=q(o);{const e=(e,t=k)=>{Pe(e,{get tab(){return t()},children:(e,o)=>{pe(e,{children:(e,o)=>{var i=ae();F(()=>re(i,t())),T(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})};Re(r,{tabs:["General","About"],get active(){return y(n)},set active(e){x(n,e,!0)},tab:e,$$slots:{tab:!0}})}var s=K(r,2),c=e=>{De(e,{role:"tabpanel",variant:"unelevated",children:(e,t)=>{je(e,{children:(e,t)=>{var o=Ma(),n=B(o),r=B(n);{const e=e=>{var t=ae("Maximum number of choices per row for screens between 720px and 1280px.");T(e,t)};Aa(B(r),{label:"Choices Per Row",variant:"standard",alwaysFloat:!0,get value(){return app.objectsPerRow},set value(e){app.objectsPerRow=e},helperText:e,children:(e,t)=>{var o=$(),n=q(o);we(n,17,()=>i,e=>e.text,(e,t)=>{Oa(e,{get value(){return y(t).value},children:(e,o)=>{var i=ae();F(()=>re(i,y(t).text)),T(e,i)},$$slots:{default:!0}})}),T(e,o)},$$slots:{helperText:!0,default:!0}})}var s=K(r,2),c=B(s);ve(c,{label:e=>{var t=ae("Enable Auto Save");T(e,t)},children:(e,t)=>{fe(e,{get checked(){return app.buildAutoSaveIsOn||!1},set checked(e){var t;t=e,app.buildAutoSaveIsOn=t},onSMUISwitchChange:()=>{app.buildAutoSaveIsOn&&l()},color:"secondary",class:"switch-scale"})},$$slots:{label:!0,default:!0}});var u=K(s,2),g=e=>{var t=ka(),o=B(t);Wi(o,{get value(){return app.buildAutoSaveInterval||10},set value(e){var t;t=e,app.buildAutoSaveInterval=t},label:"Auto Save Interval",type:"number",suffix:"min",variant:"standard",style:"max-width: 200px",input$class:"text-right",input$min:"1",onchange:()=>{app.buildAutoSaveInterval<1&&(app.buildAutoSaveInterval=1),l()}}),T(e,t)};X(u,e=>{app.buildAutoSaveIsOn&&e(g)});var m=K(u,2),h=B(m);ve(h,{label:e=>{var t=ae("Preload Images in Backpack");T(e,t)},children:(e,t)=>{fe(e,{get checked(){return app.preloadImages||!1},set checked(e){var t;t=e,app.preloadImages=t},color:"secondary",class:"switch-scale"})},$$slots:{label:!0,default:!0}});var p=K(m,2),v=B(p);ve(v,{label:e=>{var t=ae("Allow Deselecting Choices in Backpack");T(e,t)},children:(e,t)=>{fe(e,{onSMUISwitchChange:a,color:"secondary",class:"switch-scale",get checked(){return Et.allowDeselect},set checked(e){Et.allowDeselect=e}})},$$slots:{label:!0,default:!0}});var f=K(p,2),b=B(f);ki(b,{text:"Enabling this option may cause image downloads to fail or reduce the image resolution.",children:(e,t)=>{ve(e,{label:e=>{var t=ae("Download Images as Single File");T(e,t)},children:(e,t)=>{fe(e,{color:"secondary",class:"switch-scale",get checked(){return Et.isSingleFile},set checked(e){Et.isSingleFile=e}})},$$slots:{label:!0,default:!0}})},$$slots:{default:!0}});var w=K(f,2),I=B(w);ve(I,{label:e=>{var t=ae("Show Background Music Player");T(e,t)},children:(e,t)=>{fe(e,{get checked(){return app.showMusicPlayer||!1},set checked(e){var t;t=e,app.showMusicPlayer=t},color:"secondary",class:"switch-scale",onchange:()=>{if(app.showMusicPlayer){const e=d(Vt);if(e){let t=0,o=0;0!==Lt.bgmTitleInterval&&(clearInterval(Lt.bgmTitleInterval),Lt.bgmTitleInterval=0),Lt.bgmTitleInterval=window.setInterval(()=>{if(void 0!==e.playerInfo.videoData&&""!==Lt.bgmObjectId){const t=At.get(Lt.bgmObjectId);if(void 0!==t){const o=t.choice;e.playerInfo.videoData.video_id===o.bgmId&&void 0!==e.playerInfo.videoData.title&&""!==e.playerInfo.videoData.title&&(Lt.bgmTitle=e.playerInfo.videoData.title,Lt.curBgmLength=e.getDuration(),clearInterval(Lt.bgmTitleInterval),Lt.bgmTitleInterval=0)}}},1e3),0!==Lt.bgmPlayInterval&&(clearInterval(Lt.bgmPlayInterval),Lt.bgmPlayInterval=0),Lt.bgmPlayInterval=window.setInterval(()=>{if(void 0!==e.playerInfo.videoData&&!Lt.isSeeking&&1===e.getPlayerState()){const i=Math.floor(e.getCurrentTime());i!==Lt.curBgmTime?t!==i?Lt.curBgmTime=i:(o++,o>Lt.curBgmLength&&(o=1),Lt.curBgmTime=o):(t=i,o=i+1,Lt.curBgmTime=o)}},1e3)}}else Lt.bgmIsPlaying&&(0!==Lt.bgmTitleInterval&&(clearInterval(Lt.bgmTitleInterval),Lt.bgmTitleInterval=0),0!==Lt.bgmPlayInterval&&(clearInterval(Lt.bgmPlayInterval),Lt.bgmPlayInterval=0))}})},$$slots:{label:!0,default:!0}});T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},u=(e,t)=>{var o=e=>{De(e,{role:"tabpanel",variant:"unelevated",children:(e,t)=>{var o=Da(),i=q(o);Ue(i,{class:"text-center",children:(e,t)=>{var o=Fa();T(e,o)},$$slots:{default:!0}});var n=K(i,2);je(n,{children:(e,t)=>{var o=Ra(),i=B(o),n=B(i),l=B(n);F(()=>re(l,"v".concat(ct))),T(e,o)},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}})};X(e,e=>{"About"===y(n)&&e(o)},t)};X(s,e=>{"General"===y(n)?e(c):e(u,!1)}),T(e,o)},$$slots:{default:!0}});var c=K(s,2);me(c,{children:(e,t)=>{he(e,{action:"close",children:(e,t)=>{pe(e,{class:"dialog-actions--btn",children:(e,t)=>{var o=ae("Close");T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}}),I()}var qa=f("<!> <!>",1),Va=f("<!> <!>",1),La=f("<!> <!>",1),Na=f("<!> <!>",1),Wa=f("<!> <!>",1),Ea=f("<!> <!>",1),Ua=f("<!> <!> <!> <!> <!> <!> <!>",1),za=f("<i></i>"),Ga=f('<i class="mdi mdi-stop"></i>'),Ha=f("<i></i>"),_a=f('<!> <!> <!> <div class="px-1" style="max-width: 104px; width: 100%"><!></div> <div class="ps-1" style="max-width:150px; overflow: hidden;"><span class="scrolling-text"> </span></div> <div class="px-1 col"><!></div> <div class="text-center" style="width: 180px"> </div>',1),Ya=f('<i class="mdi mdi-format-list-checks"></i>'),Za=f('<div class="py-0 justify-center"><!></div>'),Ja=f('<i class="mdi mdi-checkbox-marked-circle-outline"></i>'),Xa=f("<!> <!> <!>",1),Ka=f("<div><!></div>"),Qa=f('<div class="ab-0"><div class="fadeOverlay"></div> <!> <!> <div class="s-main"><!> <!> <div class="container-fluid p-0"><div class="row gx-0"></div></div></div></div> <!> <!> <!>',1);function er(e,t){h(t,!0);let o=S(!1),i=S(!1),n=S("none"),l=te(()=>y(i)?app.showMusicPlayer?"top: 32px;":"top: 0;":"bottom: 0;"),a=te(()=>"opacity: ".concat(app.fadeTransitionIsOn?1:0,"; transition: opacity ").concat(app.fadeTransitionTime,"s ease-out; background-color: ").concat(Si(app.fadeTransitionColor),"; pointer-events: ").concat(app.fadeTransitionIsOn?"auto":"none","; cursor: ").concat(app.fadeTransitionIsOn?"none":"auto",";")),r=S(0),s=S(void 0),c=te(()=>app.pointTypes.length>0||app.backpack.length>0||app.importedChoicesIsOpen),u=te(()=>"background-color: ".concat(Si(app.styling.barBackgroundColor),"; margin:").concat(app.styling.barMargin,"px; padding:").concat(app.styling.barPadding,"px; ").concat(y(l))),g=te(()=>"color: ".concat(Si(app.styling.barTextColor),"; margin: ").concat(app.styling.barTextMargin,"px; padding: ").concat(app.styling.barTextPadding,"px;font-family: '").concat(app.styling.barTextFont,"'; font-size: ").concat(app.styling.barTextSize,"px;")),m=te(()=>"color: ".concat(Si(app.styling.barIconColor),";")),f=te(()=>{let e=[];return app.styling.backgroundImage&&e.push("background-image: url('".concat(app.styling.backgroundImage,"');")),e.push("background-color: ".concat(Si(app.styling.backgroundColor),";")),app.styling.isBackgroundRepeat?e.push("background-repeat: repeat;"):app.styling.isBackgroundFitIn?e.push("background-size: 100% 100%;"):e.push("background-size: cover;"),y(c)&&e.push("padding-bottom: 56px;"),app.useVW&&e.push("font-size: 0.835vw;"),e.join(" ")}),A=te(()=>{let e=[];return app.showMusicPlayer&&e.push("padding-top: 32px;"),e.join(" ")}),O=te(()=>"".concat(P(Lt.curBgmTime)," | ").concat(P(Lt.curBgmLength))),k=S(0),M=S(100),j=S(!1);function P(e){const t=Math.floor(e/3600),o=Math.floor(e%3600/60),i=Math.floor(e%60),n=String(o).padStart(2,"0"),l=String(i).padStart(2,"0");return t>0?"".concat(t,":").concat(n,":").concat(l):"".concat(n,":").concat(l)}function V(){const e=localStorage.getItem("theme");$t.value="dark"===e?"light":"dark";let t=document.head.querySelector("#theme-dark"),o=document.head.querySelector("#theme-light");"dark"===$t.value?(t&&(t.media="screen and (prefers-color-scheme: light)"),o&&(o.media="screen and (prefers-color-scheme: dark)")):(t&&(t.media="screen and (prefers-color-scheme: dark)"),o&&(o.media="screen and (prefers-color-scheme: light)")),localStorage.setItem("theme",$t.value)}function L(){if(Vt&&0!==Lt.curBgmLength){const e=d(Vt);if(e)if(Lt.bgmIsPlaying)e.pauseVideo(),Lt.bgmIsPlaying=!1,0!==Lt.bgmPlayInterval&&(clearInterval(Lt.bgmPlayInterval),Lt.bgmPlayInterval=0);else{let t=0,o=0;0!==Lt.bgmPlayInterval&&(clearInterval(Lt.bgmPlayInterval),Lt.bgmPlayInterval=0),e.playVideo(),Lt.bgmIsPlaying=!0,Lt.bgmPlayInterval=window.setInterval(()=>{if(void 0!==e.playerInfo.videoData&&!Lt.isSeeking&&1===e.getPlayerState()){const i=Math.floor(e.getCurrentTime());i!==Lt.curBgmTime?t!==i?Lt.curBgmTime=i:(o++,o>Lt.curBgmLength&&(o=1),Lt.curBgmTime=o):(t=i,o=i+1,Lt.curBgmTime=o)}},1e3)}}}function N(){if(Vt&&Lt.bgmIsPlaying&&0!==Lt.curBgmLength){const e=d(Vt);e&&(e.stopVideo(),Lt.bgmIsPlaying=!1,Lt.curBgmTime=0,0!==Lt.bgmPlayInterval&&(clearInterval(Lt.bgmPlayInterval),Lt.bgmPlayInterval=0))}}function W(){if(app.isMute=!app.isMute,Vt){const e=d(Vt);e&&(app.isMute?e.mute():e.unMute())}}function E(){Vt&&Lt.bgmIsPlaying&&(Lt.isSeeking=!0)}function U(){var e;if(Vt&&Lt.bgmIsPlaying){const e=d(Vt);e&&(e.seekTo(y(k),!0),Lt.curBgmTime=y(k)),Lt.isSeeking=!1}null==(e=document.activeElement)||e.blur()}function z(){x(j,!0)}function G(){var e;if(app.curVolume=y(M),Vt){const e=d(Vt);e&&e.setVolume(y(M))}x(j,!1),null==(e=document.activeElement)||e.blur()}p(()=>{Lt.isSeeking||x(k,Lt.curBgmTime,!0)}),p(()=>{y(j)||x(M,app.curVolume,!0)});var H=Qa(),_=q(H),Y=B(_),Z=K(Y,2);ze(Z,{style:"top: 0;",variant:"modal",get open(){return y(o)},set open(e){x(o,e,!0)},children:(e,t)=>{He(e,{class:"navigation-drawer",children:(e,t)=>{Ne(e,{children:(e,t)=>{var l=Ua(),a=q(l);Ee(a,{onSMUIAction:()=>x(o,!1),class:"my-0",children:(e,t)=>{var o=qa(),i=q(o);_e(i,{class:"mdi mdi-chevron-left"});var n=K(i,2);Ye(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=ae("Close Menu");T(e,o)},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}});var r=K(a,2);Ze(r,{class:"my-3"});var s=K(r,2);Ee(s,{onSMUIAction:V,class:"my-0",children:(e,t)=>{var o=Va(),i=q(o);_e(i,{class:"mdi mdi-theme-light-dark"});var n=K(i,2);Ye(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=ae("Toogle Dark/Light Theme");T(e,o)},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}});var c=K(s,2);Ee(c,{onSMUIAction:()=>x(i,!y(i)),class:"my-0",children:(e,t)=>{var o=La(),i=q(o);_e(i,{class:"mdi mdi-swap-vertical"});var n=K(i,2);Ye(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=ae("Top/Bottom Point Bar");T(e,o)},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}});var d=K(c,2);Ee(d,{get onSMUIAction(){return jo},class:"my-0",children:(e,t)=>{var o=Na(),i=q(o);_e(i,{class:"mdi mdi-select-off"});var n=K(i,2);Ye(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=ae("Clean Selected Choices");T(e,o)},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}});var u=K(d,2),g=e=>{Ee(e,{onSMUIAction:()=>{x(n,"appSaveLoad"),x(o,!1)},class:"my-0",children:(e,t)=>{var o=Wa(),i=q(o);_e(i,{class:"mdi mdi-content-save"});var n=K(i,2);Ye(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=ae("Save/Load Build");T(e,o)},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}})};X(u,e=>{app.importedChoicesIsOpen&&e(g)});var m=K(u,2);Ee(m,{onSMUIAction:()=>{x(n,"appGlobalSettings"),x(o,!1)},class:"my-0",children:(e,t)=>{var o=Ea(),i=q(o);_e(i,{class:"mdi mdi-cog"});var n=K(i,2);Ye(n,{class:"w-100 list-text text-center",children:(e,t)=>{var o=ae("Settings");T(e,o)},$$slots:{default:!0}}),T(e,o)},$$slots:{default:!0}}),T(e,l)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}});var J=K(Z,2);Ge(J,{});var Q=K(J,2),ee=B(Q),oe=e=>{Je(e,{class:"music-player",variant:"fixed",children:(e,t)=>{Xe(e,{class:"music-player--row",children:(e,t)=>{Ke(e,{class:"px-2 justify-left",children:(e,t)=>{var o=_a(),i=q(o);be(i,{class:"music-player--button",onclickcapture:L,size:"button","aria-label":"Play",children:(e,t)=>{var o=za();F(()=>R(o,1,D(Lt.bgmIsPlaying?"mdi mdi-pause":"mdi mdi-play"))),T(e,o)},$$slots:{default:!0}});var n=K(i,2);be(n,{class:"music-player--button",onclickcapture:N,size:"button","aria-label":"Stop",children:(e,t)=>{var o=Ga();T(e,o)},$$slots:{default:!0}});var l=K(n,2);be(l,{class:"music-player--button",onclickcapture:W,size:"button","aria-label":"Mute",children:(e,t)=>{var o=Ha();F(()=>R(o,1,D(app.isMute?"mdi mdi-volume-off":"mdi mdi-volume-high"))),T(e,o)},$$slots:{default:!0}});var a=K(l,2),r=B(a);Ce(r,{min:0,max:100,step:1,class:"mx-2",onpointerdown:z,onpointerup:G,get disabled(){return app.isMute},get value(){return y(M)},set value(e){x(M,e,!0)}});var s=K(a,2),c=B(s),d=B(c),u=K(s,2),g=B(u);const m=te(()=>Lt.curBgmLength||1);Ce(g,{min:0,get max(){return y(m)},step:1,class:"mx-2",onpointerdown:E,onpointerup:U,get value(){return y(k)},set value(e){x(k,e,!0)}});var h=K(u,2),p=B(h);F(()=>{re(d,Lt.bgmTitle),re(p,y(O))}),T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}})},$$slots:{default:!0}})};X(ee,e=>{app.showMusicPlayer&&e(oe)});var ie=K(ee,2),ne=e=>{Je(e,{class:"pointBar",get style(){return y(u)},variant:"fixed",color:"secondary",children:(e,t)=>{Xe(e,{class:"justify-space-around",children:(e,t)=>{var i=Xa(),l=q(i);Ke(l,{class:"py-0 justify-center",children:(e,t)=>{be(e,{class:"pointbar-icons",onclickcapture:()=>x(o,!0),"aria-label":"Open Import Window",get style(){return y(m)},children:(e,t)=>{var o=Ya();T(e,o)},$$slots:{default:!0}})},$$slots:{default:!0}});var a=K(l,2);Ke(a,{class:"pointbar-center--viewer",children:(e,t)=>{var o=$(),i=q(o);we(i,17,()=>app.pointTypes,Te,(e,t)=>{var o=$(),i=q(o),n=e=>{var o=Za();!function(e,t){h(t,!0);let o=te(()=>"color: ".concat(Si(app.styling.barTextColor),"; margin: ").concat(app.styling.barTextMargin,"px; padding: ").concat(app.styling.barTextPadding,"px; font-family: '").concat(app.styling.barTextFont,"';font-size: ").concat(app.styling.barTextSize,"px")),i=te(()=>{if(t.point.startingSum>=0){if(void 0!==app.styling.barPointPos)return"color: ".concat(Si(app.styling.barPointPos),";")}else if(void 0!==app.styling.barPointNeg)return"color: ".concat(Si(app.styling.barPointNeg),";");return""});function n(e,t){const o=t?e.negativeImage:e.image,i=t?e.negativeIconWidth:e.iconWidth,n=t?e.negativeIconHeight:e.iconHeight;return o?'<img src="'.concat(o,'" style="width: ').concat(i,"px; height:").concat(n,'px;" alt="">'):""}var l=_l(),a=B(l),r=B(a),s=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o);b(i,()=>n(t.point,!0)),T(e,o)};X(i,e=>{t.point.negativeImageOnSide||t.point.negativeImageSidePlacement||e(l)}),T(e,o)},a=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o);b(i,()=>n(t.point,!1)),T(e,o)};X(i,e=>{t.point.imageOnSide||t.point.imageSidePlacement||e(l)}),T(e,o)};X(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(l):e(a,!1)}),T(e,o)};X(r,e=>{t.point.iconIsOn&&e(s)});var c=K(r),d=K(c),u=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o);b(i,()=>n(t.point,!0)),T(e,o)};X(i,e=>{t.point.negativeImageOnSide&&!t.point.negativeImageSidePlacement&&e(l)}),T(e,o)},a=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o);b(i,()=>n(t.point,!1)),T(e,o)};X(i,e=>{t.point.imageOnSide&&!t.point.imageSidePlacement&&e(l)}),T(e,o)};X(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(l):e(a,!1)}),T(e,o)};X(d,e=>{t.point.iconIsOn&&e(u)});var g=K(d,2),m=B(g),p=K(g,2),v=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o);b(i,()=>n(t.point,!0)),T(e,o)};X(i,e=>{!t.point.negativeImageOnSide&&t.point.negativeImageSidePlacement&&e(l)}),T(e,o)},a=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o);b(i,()=>n(t.point,!1)),T(e,o)};X(i,e=>{!t.point.imageOnSide&&t.point.imageSidePlacement&&e(l)}),T(e,o)};X(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(l):e(a,!1)}),T(e,o)};X(p,e=>{t.point.iconIsOn&&e(v)});var f=K(p),w=K(f),S=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o);b(i,()=>n(t.point,!0)),T(e,o)};X(i,e=>{t.point.negativeImageOnSide&&t.point.negativeImageSidePlacement&&e(l)}),T(e,o)},a=e=>{var o=$(),i=q(o),l=e=>{var o=$(),i=q(o);b(i,()=>n(t.point,!1)),T(e,o)};X(i,e=>{t.point.imageOnSide&&t.point.imageSidePlacement&&e(l)}),T(e,o)};X(i,e=>{t.point.negativeIconIsOn&&t.point.startingSum<0?e(l):e(a,!1)}),T(e,o)};X(w,e=>{t.point.iconIsOn&&e(S)}),F((e,n)=>{var r,s;ye(l,y(o)),ye(a,e),re(c," ".concat(null!=(r=t.point.beforeText)?r:""," ")),ye(g,y(i)),re(m,n),re(f," ".concat(null!=(s=t.point.afterText)?s:""," "))},[()=>t.point.pointPrivateColorIsOn?"color: ".concat(t.point.startingSum>=0?Si(t.point.privateColor):Si(t.point.privateNegativeColor)):"",()=>t.point.startingSum%1==0?t.point.startingSum:parseFloat(t.point.startingSum.toFixed(void 0!==t.point.decimalPlaces?t.point.decimalPlaces:2))]),T(e,l),I()}(B(o),{get point(){return y(t)}}),F(()=>ye(o,y(g))),T(e,o)};X(i,e=>{(function(e){if(e.isNotShownPointBar){if(void 0!==e.activatedId&&""!==e.activatedId){let t=kt.get(e.activatedId),o=Ft.get(e.activatedId);return void 0!==t?yo(t.requireds):void 0!==o?o.isTrue:To(e.activatedId)}return!1}return!0})(y(t))&&e(n)}),T(e,o)}),T(e,o)},$$slots:{default:!0}});var r=K(a,2);Ke(r,{class:"py-0 justify-center",children:(e,t)=>{var o=$(),i=q(o),l=e=>{be(e,{class:"pointbar-icons",onclickcapture:()=>x(n,"dlgBackpack"),"aria-label":"Open Backpack Window",get style(){return y(m)},children:(e,t)=>{var o=Ja();T(e,o)},$$slots:{default:!0}})};X(i,e=>{app.backpack.length>0&&(void 0===app.hideBackpackBtn||0===app.hideBackpackBtn||app.hideBackpackBtn>0&&app.hideBackpackBtn===app.btnBackpackIsOn)&&e(l)}),T(e,o)},$$slots:{default:!0}}),T(e,i)},$$slots:{default:!0}})},$$slots:{default:!0}})};X(ie,e=>{y(c)&&e(ne)});var le=K(ie,2),se=B(le);we(se,21,()=>app.rows,Te,(e,t)=>{var o=Ka();Hl(B(o),{get row(){return y(t)},get windowWidth(){return y(r)},get mainDiv(){return y(s)}}),F(()=>R(o,1,D(y(t).width?"col-6":"col-12"))),T(e,o)}),w(se,e=>x(s,e),()=>y(s));var ce=K(_,2),de=e=>{const t=te(()=>"appSaveLoad"===y(n));mn(e,{get open(){return y(t)},onclose:()=>x(n,"none")})},ue=(e,t)=>{var o=e=>{const t=te(()=>"dlgBackpack"===y(n));Ql(e,{get open(){return y(t)},onclose:()=>x(n,"none")})},i=(e,t)=>{var o=e=>{const t=te(()=>"appGlobalSettings"===y(n));$a(e,{get open(){return y(t)},onclose:()=>x(n,"none")})};X(e,e=>{"appGlobalSettings"===y(n)&&e(o)},t)};X(e,e=>{"dlgBackpack"===y(n)?e(o):e(i,!1)},t)};X(ce,e=>{"appSaveLoad"===y(n)?e(de):e(ue,!1)});var ge=K(ce,2),me=e=>{const t=te(()=>"appImageUpload"===Nt.currentDialog);Ta(e,{get open(){return y(t)},onclose:()=>Nt.currentDialog="none",get imgObject(){return Nt.data},get imgProp(){return Nt.imgProp}})},he=(e,t)=>{var o=e=>{const t=te(()=>"dlgCommon"===Nt.currentDialog);Hi(e,{get open(){return y(t)},onclose:()=>Nt.currentDialog="none",get closeHandler(){return Nt.cFunc},get title(){return Nt.title},get context(){return Nt.context},get isWord(){return Nt.isWord}})};X(e,e=>{"dlgCommon"===Nt.currentDialog&&void 0!==Nt.cFunc&&void 0!==Nt.title&&void 0!==Nt.context&&e(o)},t)};X(ge,e=>{"appImageUpload"===Nt.currentDialog&&void 0!==Nt.data&&void 0!==Nt.imgProp?e(me):e(he,!1)}),function(e,t){h(t,!0);let o=S(void 0),i=null;p(()=>{y(o)&&""!==Ci.text&&(Ci.isVisible&&Ci.anchor?(null==i||i.destroy(),i=C(Ci.anchor,y(o),{placement:"top",modifiers:[{name:"offset",options:{offset:[0,6]}},{name:"preventOverflow",options:{boundary:"viewport"}},{name:"flip",options:{fallbackPlacements:["top","bottom"]}}]}),y(o).classList.add("mdc-tooltip--shown")):i&&(i.destroy(),i=null,y(o).classList.remove("mdc-tooltip--shown")))}),v(()=>{null==i||i.destroy()});var n=Ai(),l=B(n),a=B(l);b(a,()=>Ci.text),w(n,e=>x(o,e),()=>y(o)),T(e,n),I()}(K(ge,2),{}),F(()=>{ye(_,y(f)),ye(Y,y(a)),ye(Q,y(A))}),Oe(_,"clientWidth",e=>x(r,e)),T(e,H),I()}var tr=f('<div id="bgm-player" style="display:none"></div> <!> <!>',1);void 0===window.ResizeObserver&&(window.ResizeObserver=et),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach(function(e){t.appendChild(e instanceof Node?e:document.createTextNode(String(e)))}),this.appendChild(t)}})}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("before")||Object.defineProperty(e,"before",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),t=document.createDocumentFragment();e.forEach(function(e){t.appendChild(e instanceof Node?e:document.createTextNode(String(e)))}),this.parentNode.insertBefore(t,this)}})}),"function"!=typeof queueMicrotask&&(window.queueMicrotask=function(e){Promise.resolve().then(e).catch(e=>setTimeout(()=>{throw e},0))});const or=e=>{e.preventDefault(),e.returnValue=""};window.addEventListener?window.addEventListener("beforeunload",or):window.onbeforeunload=or,tt(function(e,t){let o,i,n;h(t,!0);let l,a="<div>Loading</div>";function r(){let e=localStorage.getItem("theme"),t=document.head.querySelector("#theme-dark"),o=document.head.querySelector("#theme-light"),i=function(){if(!window.matchMedia)return!1;try{return"not all"!==window.matchMedia("(prefers-color-scheme: dark)").media}catch(e){return!1}}();"dark"===e?i?(t&&(t.media="screen and (prefers-color-scheme: light)"),o&&(o.media="screen and (prefers-color-scheme: dark)"),$t.value="dark"):(t&&(t.media="all"),o&&(o.media="not all")):i||(o&&(o.media="all"),t&&(t.media="not all"))}async function s(e){const t=Array.from(e);for(let n=0;n<t.length;n++){const e=t[n];try{await new Promise((t,o)=>{const i=new Image;i.onload=t,i.onerror=o,i.src=e})}catch(o){console.error(o)}finally{i&&(i.innerHTML="<div>Images</div><div>".concat(n," / ").concat(t.length,"</div>"))}}}async function c(){if(_t.value){const t="Your browser does not support the .avif format.\n Avif images may not be displayed.";try{await new Promise((e,t)=>{const o=new Image;o.onload=e,o.onerror=t,o.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="})}catch(e){console.error(e),Wt.labelText=t,Wt.isOpen=!0}}}p(()=>{Wt.isOpen&&(l.close(),l.open(),Wt.isOpen=!1)}),L(()=>{window.debugApp=app,r(),async function(){const e=(await Xt()).transaction("buildStore","readonly").objectStore("buildStore"),t=location.pathname.replace(/\/index\.html$/,"/");await new Promise((o,i)=>{const n=e.openCursor();n.onsuccess=e=>{const i=e.target.result;if(!i)return void o();const n=i.key,l=i.value;if("string"==typeof n&&n.startsWith(t)){const e=n.slice(t.length);if("autoSave"===e)Ut.stored=!0,Ut.time=l.time,Ut.app=l.app;else{const t=e.match(/^slot-(\d+)$/),o=Number(null==t?void 0:t[1]);zt[o].stored=!0,zt[o].name=void 0!==l.name?l.name:"Slot ".concat(o+1),zt[o].time=l.time,zt[o].app=l.app}}i.continue()},n.onerror=i})}(),async function(){o=document.getElementById("lm"),n=document.getElementById("projectSize"),i=document.getElementById("indicator");const e=n?parseInt(n.innerHTML):0,t=i?i.className:"";if(i&&(a=i.innerHTML),o&&(o.style.pointerEvents="none"),"function"==typeof window.fetch)try{const l=await fetch("project.json");if(l&&l.body){const r=l.body.getReader(),d=new TextDecoder;let u=0,g="";for(;;){const{done:o,value:n}=await r.read();if(o)break;u+=n.length,g+=d.decode(n,{stream:!0}),i&&(i.innerHTML="ind2"===t&&e>0?"".concat(a,"<div>").concat((u/e*100).toFixed(1)," %</div>"):"ind3"===t&&e>0?"".concat(a,"<div>").concat((u/1e6).toFixed(1),"/").concat((e/1e6).toFixed(1)," MB</div>"):"".concat(a,"<div>").concat((u/1e6).toFixed(1)," MB</div>"))}o&&(o.style.height="0");const m=di(JSON.parse(g)),h=si.safeParse(m);h.success?(mi(h.data),app.preloadExternalImages&&Ht.size>0&&await s(Ht),setTimeout(()=>{const e=document.createElement("style");document.head.appendChild(e),setTimeout(()=>{o&&(o.style.height="",o.style.opacity="1",o.style.pointerEvents=""),i&&i.remove(),n&&n.remove(),e.sheet&&e.sheet.insertRule("body::before{opacity:0;transition:opacity 2s}",0)},1e3)},1e3),await c()):(Wt.labelText="Failed to load data.",Wt.isOpen=!0,console.error(h.error))}}catch(l){console.error(l),o&&(o.style.height="0"),mi(JSON.parse(JSON.stringify(app))),app.preloadExternalImages&&Ht.size>0&&await s(Ht),setTimeout(()=>{const e=document.createElement("style");document.head.appendChild(e),setTimeout(()=>{o&&(o.style.height="",o.style.opacity="1",o.style.pointerEvents=""),i&&i.remove(),n&&n.remove(),e.sheet&&e.sheet.insertRule("body::before{opacity:0;transition:opacity 2s}",0)},1e3)},1e3),await c()}else{const l=new XMLHttpRequest;l.open("GET","project.json",!0),l.onprogress=o=>{i&&(i.innerHTML="ind2"===t&&e>0?"".concat(a,"<div>").concat((o.loaded/e*100).toFixed(1)," %</div>"):"ind3"===t&&e>0?"".concat(a,"<div>").concat((o.loaded/1e6).toFixed(1),"/").concat((e/1e6).toFixed(1)," MB</div>"):"".concat(a,"<div>").concat((o.loaded/1e6).toFixed(1)," MB</div>"))},l.onload=async()=>{o&&(o.style.height="0"),200===l.status?(mi(JSON.parse(l.responseText)),app.preloadExternalImages&&app.externalImages.size>0&&await s(app.externalImages)):mi(JSON.parse(JSON.stringify(app))),setTimeout(()=>{const e=document.createElement("style");document.head.appendChild(e),setTimeout(()=>{o&&(o.style.height="",o.style.opacity="1",o.style.pointerEvents=""),i&&i.remove(),n&&n.remove(),e.sheet&&e.sheet.insertRule("body::before{opacity:0;transition:opacity 2s}",0)},1e3)},1e3),await c()},l.send()}}(),v(()=>{Vt.update(e=>(null==e||e.destroy(),null))})});var d=tr(),u=K(q(d),2);er(u,{});var g=K(u,2);w(Qe(g,{get labelText(){return Wt.labelText},get timeoutMs(){return Wt.timeoutMs},children:(e,t)=>{pe(e,{class:"text-center"})},$$slots:{default:!0}}),e=>l=e,()=>l),T(e,d),I()},{target:document.getElementById("app")});export{o as __vite_legacy_guard};
